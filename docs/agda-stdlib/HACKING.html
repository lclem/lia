<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Contributing to the library | Logic in Agda</title><!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Contributing to the library" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Propositional and fist-order logic developed with the proof assistant Agda." />
<meta property="og:description" content="Propositional and fist-order logic developed with the proof assistant Agda." />
<link rel="canonical" href="/lia/agda-stdlib/HACKING.html" />
<meta property="og:url" content="/lia/agda-stdlib/HACKING.html" />
<meta property="og:site_name" content="Logic in Agda" />
<script type="application/ld+json">
{"url":"/lia/agda-stdlib/HACKING.html","headline":"Contributing to the library","description":"Propositional and fist-order logic developed with the proof assistant Agda.","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/lia/assets/main.css">
  <!-- <link rel="stylesheet" href="/lia/assets/custom.css"> --><!-- Mathjax Support -->
  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <!-- Load KaTeX -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.js"></script>
</head>
<body><header class="site-header" role="banner">

    <div class="wrapper">

        <a class="site-title" href="/lia/">Logic in Agda</a>

        <nav class="site-nav">
            <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span>

            <div class="trigger">
                <a class="page-link" href="/lia/part0/index/">Part 0</a>
                <a class="page-link" href="/lia/part1/index/">Part 1</a>
                <a class="page-link" href="/lia/part2/index/">Part 2</a>
                <a class="page-link" href="/lia/part3/index/">Part 3</a>
                <a class="page-link" href="/lia/part4/index/">Part 4</a>
            </div>
        </nav>

    </div>

</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

    <header class="post-header">
        <h1 class="post-title">Contributing to the library</h1>
    </header>
  
    <p style="text-align:center;">
    
    
    
    
    
    
</p>

  
    <div class="post-content">
        <h2>Contents</h2>    
        <h1 id="contributing-to-the-library">Contributing to the library</h1>

<p>Thank you for your interest in contributing to the Agda standard library.
Hopefully this guide should make it easy to do so! Feel free to ask any
questions on the Agda mailing list. Before you start please read the
<a href="https://github.com/agda/agda-stdlib/blob/master/notes/style-guide.md">style-guide</a>.</p>

<h2 id="how-to-make-changes">How to make changes</h2>

<h3 id="fork-and-download-the-repository">Fork and download the repository</h3>

<ol>
  <li>
    <p>Create a fork by clicking <code class="language-plaintext highlighter-rouge">Fork</code> button at the top right of the
<a href="https://github.com/agda/agda-stdlib">repository</a>.</p>
  </li>
  <li>If you are on a Mac, make sure that your git options has <code class="language-plaintext highlighter-rouge">autocrlf</code>
set  to <code class="language-plaintext highlighter-rouge">input</code>.  This can be done by executing
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git config --global core.autocrlf input
</code></pre></div>    </div>
    <p>If you are on Windows, make sure that your editor can deal with Unix
format files.</p>
  </li>
  <li>On the command line, and in a suitable folder, download your fork by
running the command
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/USER_NAME/agda-stdlib agda-stdlib-fork
</code></pre></div>    </div>

    <p>where <code class="language-plaintext highlighter-rouge">USER_NAME</code> is your Git username. The folder <code class="language-plaintext highlighter-rouge">agda-stdlib-fork</code>
should now contain a copy of the standard library.</p>
  </li>
  <li>Enter the folder <code class="language-plaintext highlighter-rouge">agda-stdlib-fork</code> and choose the correct branch of
the library to make your changes on by running the command
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git checkout X
</code></pre></div>    </div>
    <p>where <code class="language-plaintext highlighter-rouge">X</code> should be <code class="language-plaintext highlighter-rouge">master</code> if your changes are compatible with the
current released version of Agda, and <code class="language-plaintext highlighter-rouge">experimental</code> if your changes
require the development version of Agda.</p>
  </li>
</ol>

<h3 id="make-your-changes">Make your changes</h3>

<ol>
  <li>
    <p>Make your proposed changes. Please try to obey existing conventions
in the library. See <code class="language-plaintext highlighter-rouge">agda-stdlib-fork/notes/style-guide.md</code> for a
selection of the most important ones.</p>
  </li>
  <li>
    <p>Document your changes in <code class="language-plaintext highlighter-rouge">agda-stdlib-fork/CHANGELOG.md</code>.</p>
  </li>
  <li>
    <p>Ensure your changes are compatible with the rest of the library by
running the commands</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make clean
make test
</code></pre></div>    </div>
    <p>inside the <code class="language-plaintext highlighter-rouge">agda-stdlib-fork</code> folder. Continue to correct any bugs
thrown up until the tests are passed.</p>

    <p>Your proposed changes MUST pass these tests. Note that the tests
require the use of a tool called <code class="language-plaintext highlighter-rouge">fix-whitespace</code>. See the
instructions at the end of this file for how to install this.</p>

    <p>If you are creating new modules, please make sure you are having a
proper header, and a brief description of what the module is for, e.g.</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>------------------------------------------------------------------------
-- The Agda standard library
--
-- {PLACE YOUR BRIEF DESCRIPTION HERE}
------------------------------------------------------------------------
</code></pre></div>    </div>

    <p>If possible, each module should use the options <code class="language-plaintext highlighter-rouge">--safe</code> and <code class="language-plaintext highlighter-rouge">--without-K</code>. You
can achieve this by placing the following pragma under the header and before
any other line of code (including the module name):</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{-# OPTIONS --without-K --safe #-}
</code></pre></div>    </div>

    <p>If a module cannot be made safe or needs the <code class="language-plaintext highlighter-rouge">--with-K</code> option then it should be
split into a module which is compatible with these options and an auxiliary
one which will:</p>
    <ul>
      <li>Either be called <code class="language-plaintext highlighter-rouge">SOME/PATH/Unsafe.agda</code> or <code class="language-plaintext highlighter-rouge">SOME/PATH/WithK.agda</code></li>
      <li>Or explicitly declared as either unsafe or needing K in <code class="language-plaintext highlighter-rouge">GenerateEverything.hs</code></li>
    </ul>
  </li>
</ol>

<h3 id="upload-your-changes">Upload your changes</h3>

<ol>
  <li>
    <p>Use the <code class="language-plaintext highlighter-rouge">git add X</code> command to add changes to file <code class="language-plaintext highlighter-rouge">X</code> to the commit,
or <code class="language-plaintext highlighter-rouge">git add .</code> to add all the changed files.</p>
  </li>
  <li>Run the command:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git commit
</code></pre></div>    </div>
    <p>and enter a meaningful description for your changes.</p>
  </li>
  <li>Upload your changes to your fork by running the command:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   git push
</code></pre></div>    </div>
  </li>
  <li>
    <p>Go to your fork on Github at <code class="language-plaintext highlighter-rouge">https://github.com/USER_NAME/agda-stdlib</code>
    and follow the <a href="https://help.github.com/en/articles/creating-a-pull-request-from-a-fork">official Git instructions</a>
    to open a pull request to the main standard library repository.</p>
  </li>
  <li>The library maintainers will then be made aware of your requested
    changes and should be in touch soon.</li>
</ol>

<h2 id="how-to-enforce-whitespace-policies">How to enforce whitespace policies</h2>

<h3 id="installing-fix-whitespace">Installing fix-whitespace</h3>

<p>This tool is kept in the main agda organization. It can be installed by
following these instructions:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   git clone https://github.com/agda/fix-whitespace --depth 1
   cd fix-whitespace/
   cabal install
</code></pre></div></div>

<h3 id="adding-fix-whitespace-as-a-pre-commit-hook">Adding fix-whitespace as a pre-commit hook</h3>

<p>You can add the following code to the file <code class="language-plaintext highlighter-rouge">.git/hooks/pre-commit</code> to
get git to run fix-whitespace before each <code class="language-plaintext highlighter-rouge">git commit</code> and ensure
you are never committing anything with a whitespace violation:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   #!/bin/sh

   fix-whitespace --check
</code></pre></div></div>

<h2 id="type-checking-the-readme-directory">Type-checking the README directory</h2>

<ul>
  <li>
    <p>By default the README directory is not exported in the
<code class="language-plaintext highlighter-rouge">standard-library.agda-lib</code> file in order to avoid clashing with other people’s
README files. This means that by default type-checking a file in the README
directory fails.</p>
  </li>
  <li>If you wish to type-check a README file, then you will need to change the line:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>include: src
</code></pre></div>    </div>
    <p>to</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>include: src .
</code></pre></div>    </div>
    <p>in the <code class="language-plaintext highlighter-rouge">standard-library.agda-lib</code> file.</p>
  </li>
  <li>Please do not include this change in your pull request.</li>
</ul>

    </div>
  
    <p style="text-align:center;">
    
    
    
    
    
    
</p>

    <p class="p-name"> Last-modified:  </p>
  </article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/lia/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Logic in Agda</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Lorenzo Clemente</li>
          <li><a class="u-email" href="mailto:clementelorenzo@gmail.com">clementelorenzo@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/lclem"><svg class="svg-icon"><use xlink:href="/lia/assets/minima-social-icons.svg#github"></use></svg> <span class="username">lclem</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>

<!-- Parse the Latex divs with Katex
<script type="text/javascript">
  $("script[type='math/tex']").replaceWith(
    function(){
      var tex = $(this).text();
      return katex.renderToString(tex, {displayMode: false});
  });
  
  $("script[type='math/tex; mode=display']").replaceWith(
    function(){
      var tex = $(this).text();
      return katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: true});
  });
</script>
-->

<script type="text/javascript" src="/lia/assets/hidebox.js"></script>
</body>

</html>
