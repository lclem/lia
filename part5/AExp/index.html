<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Arithmetic expressions 🚧 | Logic in Agda</title><!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Arithmetic expressions 🚧" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Propositional and fist-order logic developed with the proof assistant Agda." />
<meta property="og:description" content="Propositional and fist-order logic developed with the proof assistant Agda." />
<link rel="canonical" href="/lia/part5/AExp/" />
<meta property="og:url" content="/lia/part5/AExp/" />
<meta property="og:site_name" content="Logic in Agda" />
<script type="application/ld+json">
{"url":"/lia/part5/AExp/","description":"Propositional and fist-order logic developed with the proof assistant Agda.","@type":"WebPage","headline":"Arithmetic expressions 🚧","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/lia/assets/main.css">

  <!-- <link rel="stylesheet" href="/lia/assets/custom.css"> --><!-- Mathjax Support -->
  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <!-- Load KaTeX -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.js"></script>

<script type="text/x-thebe-config">
  {
    bootstrap: true,
    requestKernel: true,
    runAllCells: false,
    selector: "[data-executable]",
    predefinedOutput: false,
    codeMirrorConfig: {
        //theme: "idea",
        language: "agda",
        readOnly: false,
        lineNumbers: true,
        keyMap: "default",
//        gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
    },
    kernelOptions: {
        name: "agda",
        kernelName: "agda",
        path: "src/",
        loadFromStore: true,
        persistent: false,
        // notebook server configuration; not needed with binder
        serverSettings: {
              baseUrl: "http://127.0.0.1:8888",
              token: "test-secret",
            },
    },
    binderOptions: {
      repo: "lclem/lia", // need to put here the actual github repo (if it is a fork)
      ref: "main",
      binderUrl: "https://mybinder.org",
      repoProvider: "github",
      savedSession: {
        enabled: true,
        maxAge: 86400, // the max age in seconds to consider re-using a session
        storagePrefix: "thebe-binder-lia-"
      },
    },
  }
</script>

<!-- <script type="text/javascript" src="https://unpkg.com/thebelab@latest"></script> -->

<!-- our own version of the thebe library: -->
<script type="text/javascript" src="/lia/thebe/lib/index.js"></script>

<!-- highlighting for Agda -->
<script src="/lia/codemirror-agda/lib/index.js"></script>

</head>
<body><header class="site-header" id="site-header">

    <div class="wrapper">

        <a class="site-title" href="/lia/">Logic in Agda</a>

        <nav class="site-nav">
            <!-- <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span> -->

            <div class="trigger">
                <a class="page-link" href="/lia/part0/index/">Part 0</a>
                <a class="page-link" href="/lia/part1/index/">Part 1</a>
                <a class="page-link" href="/lia/part2/index/">Part 2</a>
                <a class="page-link" href="/lia/part3/index/">Part 3</a>
                <a class="page-link" href="/lia/part4/index/">Part 4</a>
                <a class="page-link" href="/lia/part5/index/">Part 5</a>

                <span class="kernel-status">
                    <button class="kernel-status-button" onclick="kernel_status_clicked()" title="kernel status"></button>
                    <span id="kernel-messages" class="kernel-messages"></span>
                </span>

                <div id="connection_options" class="options sidebar" style="text-align: left; line-height: normal; max-width: 800px; padding: 10px; border-radius: 15px;">
                    <!-- display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: space-between; -->
                    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
                    <div>
                        <label for="username" style="color: white;">User:</label>
                        <input type="text" placeholder="github username" id="username" name="username">
                        <label for="password" style="color: white;">Password:</label>
                        <input type="password" placeholder="password" id="password" name="password">
                    </div>
                    <div>
                        <label for="loadFromStore" style="color: white;">Load code from browser store:</label>
                        <label class="switch" style="vertical-align: middle; margin: 10px;">
                            <input type="checkbox" id="loadFromStore" name="loadFromStore">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div>
                        <label for="baseUrl" style="color: white;">Base URL:</label>
                        <input type="text" placeholder="baseUrl" id="baseUrl" name="baseUrl" value="http://127.0.0.1:8888">
                        <label for="token" style="color: white;">Token:</label>
                        <input type="text" placeholder="token" id="token" name="token" value="test-secret">
                    </div>
                    <div>
                        <label for="useBinder" style="color: white;">Use binder:</label>
                        <label class="switch" style="vertical-align: middle; margin: 10px;">
                            <input type="checkbox" id="useBinder" name="useBinder">
                            <span class="slider round"></span>
                        </label>
                        <label for="savedSession" style="color: white;">Reuse session:</label>
                        <label class="switch" style="vertical-align: middle; margin: 10px;">
                            <input type="checkbox" id="savedSession" name="savedSession">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div>
                        <label for="repository" style="color: white;">Github repo:</label>
                        <input type="text" placeholder="repository" id="repository" name="repository" value="">

                        <label for="ref" style="color: white;">Branch:</label>
                        <input type="text" placeholder="ref" id="ref" name="ref" value="main">

                        <label for="binderUrl" style="color: white;">Binder URL:</label>                        
                        <input type="text" placeholder="binderUrl" id="binderUrl" name="binderUrl" value="https://mybinder.org">
                    </div>
                </div>

                <span class="control-container" id="control-container">
                    <svg class="progress-ring" id="progress-ring" width="30" height="30" title="exercise progress" onclick="kernel_status_clicked()">
                        <circle
                            id="progress-circle"
                            class="progress-ring__circle"
                            stroke="black"
                            stroke-width="2.5"
                            fill="transparent"
                            r="14"
                            cx="15"
                            cy="15"/>
                        <circle
                            stroke="lightgray"
                            stroke-width="0.5"
                            fill="transparent"
                            r="14"
                            cx="15"
                            cy="15"/>
                    </svg>
                    <div id="connection_options" class="options sidebar" style="text-align: left; line-height: normal; max-width: 800px; padding: 10px; border-radius: 15px;"></div>
                    <span class="progress-text" id="progress-text" onclick="kernel_status_clicked()"> 0/0 </span>

                    <span id="controls" class="controls">
                        <svg version="1.1" id="run-all" class="run-all" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                            width="15" height="15" viewBox="0 0 163.861 163.861" style="enable-background:new 0 0 163.861 163.861;"
                            xml:space="preserve">
                            <g>
                                <path d="M34.857,3.613C20.084-4.861,8.107,2.081,8.107,19.106v125.637c0,17.042,11.977,23.975,26.75,15.509L144.67,97.275
                                    c14.778-8.477,14.778-22.211,0-30.686L34.857,3.613z"/>
                            </g>
                        </svg>
                    </span>
                </span>
            </div>

            <style>
                .switch {
                    position: relative;
                    display: inline-block;
                    width: 40px;
                    height: 20px;
                }

                /* Hide default HTML checkbox */
                .switch input {
                    opacity: 0;
                    width: 0;
                    height: 0;
                }

                /* The slider */
                .slider {
                    position: absolute;
                    cursor: pointer;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background-color: #ccc;
                    -webkit-transition: .4s;
                    transition: .4s;
                }

                .slider:before {
                    position: absolute;
                    content: "";
                    height: 16px;
                    width: 16px;
                    left: 2px;
                    /* right: 4px; */
                    bottom: 2px;
                    top: 2px;
                    background-color: white;
                    -webkit-transition: .4s;
                    transition: .4s;
                }

                input:checked + .slider {
                    background-color: #2196F3;
                }

                input:focus + .slider {
                    box-shadow: 0 0 1px #2196F3;
                }

                input:checked + .slider:before {
                    -webkit-transform: translateX(18px);
                    -ms-transform: translateX(18px);
                    transform: translateX(18px);
                }

                /* Rounded sliders */
                .slider.round {
                    border-radius: 30px;
                }

                .slider.round:before {
                border-radius: 50%;
                }

                .sidebar input[type=text] {
                    padding: 6px;
                    margin-top: 8px;
                    /* font-size: 17px; */
                    border: none;
                    /* width: 150px; */
                }

                .sidebar {
                    /* height: 100%; */
                    width: 0;
                    position: fixed;
                    z-index: 1000;
                    top: 0;
                    right: 20px;
                    background-color: rgba(17, 17, 17, 0.637);
                    /* overflow-x: hidden; */
                    transition: 0.5s;
                    padding-top: 60px;
                    display: none;
                    margin-top: 60px;
                }

                .sidebar .closebtn {
                    position: absolute;
                    color: white;
                    top: 0;
                    right: 10px;
                    font-size: 24px;
                    margin-left: 20px;
                }

                .progress-ring, .run-all {
                    vertical-align: middle;
                }

                .control-container {
                    transition: all .2s ease-in-out;
                }

                .controls {
                    display: none;
                    opacity: 0;
                    margin-right: 10px;
                    transition: all .5s ease-in-out;
                }

                .run-all:hover {
                    filter: brightness(135%);
                }

                .progress-ring__circle {
                    transition: 0.35s stroke-dashoffset;
                    transform: rotate(-90deg);
                    transform-origin: 50% 50%;
                    visibility: hidden;
                }

                .progress-text {
                    position: relative;
                    top: 0;
                    left: -25px;
                    font-size: 8px;
                    vertical-align: middle;
                    align-self: center;
                }

                .progress-text:hover, .progress-ring:hover, .progress-ring__circle:hover, .run-all {
                    cursor: pointer;
                }
            </style>

            <script>

                //  var storedUsername = localStorage.getItem("username");
                //  localStorage.setItem("username", storedUsername.value);
            
                function doStore(input, key) {

                    if(input.type == "checkbox") {
                        var checked = localStorage.getItem(key);

                        if (checked == "yes") {
                            localStorage.setItem(key, "no");
                        }
                        else {
                            localStorage.setItem(key, "yes");
                        }

                        console.info("checked: ", localStorage.getItem(key));
                    }
                    else {
                        console.info("value: ", input.value);
                        localStorage.setItem(key, input.value);
                    }
                }

                function persistInput(input) {
                    var key = "input-" + input.id;
                    var storedValue = localStorage.getItem(key);
                
                    console.info("Persisting input: ", input);
                
                    // if there is a stored value, use it
                    if (storedValue) {

                        if(input.type != "password") {
                            console.info("restoring value ", storedValue, " for ", input);
                        }

                        if(input.type == "checkbox") {
                            if(storedValue=="yes") {
                                input.setAttribute("checked", "");
                            }
                            else {
                                input.removeAttribute("checked");
                            }
                        }
                        else {
                            input.value = storedValue;
                        }
                    }
                    // if there is no stored value, store the current value
                    else {
                        doStore(input, key);
                    }

                    input.addEventListener('input', function () {
                        console.info("input changed: key = ", key, "; value = ", input);
                        doStore(input, key);
                    });
                    }
                
                    persistInput(document.getElementById("username"));
                    persistInput(document.getElementById("password"));

                    persistInput(document.getElementById("loadFromStore"));

                    persistInput(document.getElementById("baseUrl"));
                    persistInput(document.getElementById("token"));

                    persistInput(document.getElementById("useBinder"));
                    persistInput(document.getElementById("savedSession"));
                    persistInput(document.getElementById("repository"));
                    persistInput(document.getElementById("ref"));
                    persistInput(document.getElementById("binderUrl"));

                    // init
                    document.getElementById("connection_options").style.display = "none";

                    function kernel_status_clicked() {
                
                        console.info("Clicked kernel status");

                        document.getElementById("kernel-messages").style.display = "none";

                        document.getElementById("connection_options").style.width = "750px";
                        document.getElementById("connection_options").style.display = "block";
                        //document.getElementById("header").style.marginLeft = "250px";

                    }

                    function closeNav() {

                        document.getElementById("kernel-messages").style.display = "inline";

                        document.getElementById("connection_options").style.width = "0";
                        document.getElementById("connection_options").style.display = "none";
                        //document.getElementById("header").style.marginLeft= "0";
                    }

                var prevScrollpos = window.pageYOffset;
                var header = document.getElementById("site-header");
                var boxShadow = header.style.boxShadow;

                window.onscroll = function() {
                    var currentScrollPos = window.pageYOffset;
                    // detect scroll down
                    if (prevScrollpos > currentScrollPos) {
                        header.style.top = "0";
                        header.style.boxShadow = boxShadow;
                        prevScrollpos = currentScrollPos;
                    } else if (prevScrollpos <= currentScrollPos) {
                        header.style.top = "-55px";
                        header.style.boxShadow = "none"
                        prevScrollpos = currentScrollPos;
                    }
                }

            let control_container = document.getElementById("control-container");
            let controls = document.getElementById("controls");

            control_container.addEventListener("mouseenter", function(event) {
                controls.style.display = "inline";
//                controls.style.visibility = "visible";
                controls.style.opacity = 1;
                console.info("mouseenter");
            }, false);

            control_container.addEventListener("mouseleave", function(event) {
                // controls.style.visibility = "hidden";
                // controls.style.display = "none";
                controls.style.opacity = 0;
                console.info("mouseleave");
            }, false);

            </script>
            
        </nav>

    </div>

</header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

    <header class="post-header">
        <h1 class="post-title">Arithmetic expressions 🚧</h1>
    </header>
  
    <header class="nav-header">
    <p style="text-align:center;">
        
        
        
        <a alt="Part" href="/lia/part5/index/">Part</a>
        &bullet;
        
        
        <a alt="Source code" href="https://github.com/lclem/lia/blob/main/src/part5/AExp.lagda.md">Source</a>
        
        
        
    </p>
</header>

  
    <div class="post-content">
        <h2>Contents</h2>    
        <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#arithmetic-expressions">Arithmetic expressions</a>
<ul>
<li class="toc-entry toc-h2"><a href="#variables">Variables</a></li>
<li class="toc-entry toc-h2"><a href="#syntax-of-expressions">Syntax of expressions</a></li>
<li class="toc-entry toc-h2"><a href="#environments">Environments</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#denotational-semantics">Denotational semantics</a></li>
<li class="toc-entry toc-h1"><a href="#small-steps-operational-semantics">Small-steps operational semantics</a>
<ul>
<li class="toc-entry toc-h2"><a href="#preservation">Preservation</a></li>
<li class="toc-entry toc-h2"><a href="#transitive-closure">Transitive closure</a></li>
<li class="toc-entry toc-h2"><a href="#deterministic-values">Deterministic values</a></li>
<li class="toc-entry toc-h2"><a href="#congruence">Congruence</a></li>
<li class="toc-entry toc-h2"><a href="#relational-reasoning">Relational reasoning</a></li>
<li class="toc-entry toc-h2"><a href="#exercise-termination-weak-normalisation">Exercise: Termination (Weak normalisation)</a></li>
<li class="toc-entry toc-h2"><a href="#exercise-strong-normalisation">Exercise: Strong normalisation</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#big-steps-operational-semantics">Big-steps operational semantics</a>
<ul>
<li class="toc-entry toc-h2"><a href="#evaluation-is-deterministic">Evaluation is deterministic</a></li>
<li class="toc-entry toc-h2"><a href="#agreement-of-the-semantics">Agreement of the semantics</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#references">References</a></li>
</ul><pre class="Agda"><a id="48" class="Symbol">{-#</a> <a id="52" class="Keyword">OPTIONS</a> <a id="60" class="Pragma">--allow-unsolved-metas</a> <a id="83" class="Symbol">#-}</a>
<a id="87" class="Keyword">module</a> <a id="94" href="/lia/part5/AExp/" class="Module">part5.AExp</a> <a id="105" class="Keyword">where</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="/lia/part0/index/" class="Module">part0.index</a> <a id="135" class="Keyword">hiding</a> <a id="142" class="Symbol">(</a><a id="143" href="/lia/part0/Naturals/#6887" class="Datatype">AExp</a><a id="147" class="Symbol">)</a> <a id="149" class="Keyword">renaming</a> <a id="158" class="Symbol">(</a><a id="159" href="/lia/part0/Naturals/#4948" class="Function Operator">_+_</a> <a id="163" class="Symbol">to</a> <a id="_+_"></a><a id="166" href="/lia/part5/AExp/#166" class="Function Operator">_+ℕ_</a><a id="170" class="Symbol">;</a> <a id="172" href="/lia/part0/Naturals/#5569" class="Function Operator">_*_</a> <a id="176" class="Symbol">to</a> <a id="_*_"></a><a id="179" href="/lia/part5/AExp/#179" class="Function Operator">_·ℕ_</a><a id="183" class="Symbol">)</a> <a id="185" class="Keyword">public</a></pre>

<h1 id="arithmetic-expressions">
<a class="anchor" href="#arithmetic-expressions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Arithmetic expressions</h1>

<p>We develop an eager denotational and operational semantics for a simple
language of arithmetic expressions, and we prove that they agree.</p>

<h2 id="variables">
<a class="anchor" href="#variables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Variables</h2>

<p>We represent <em>variable names</em> as natural Number. Any countable domain
with decidable equality (such as strings) would work here</p>

<pre class="Agda"><a id="VarName"></a><a id="509" href="/lia/part5/AExp/#509" class="Function">VarName</a> <a id="517" class="Symbol">=</a> <a id="519" href="/lia/part0/Naturals/#247" class="Function">ℕ</a>

<a id="522" class="Keyword">private</a> <a id="530" class="Keyword">variable</a> <a id="539" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="541" href="/lia/part5/AExp/#541" class="Generalizable">y</a> <a id="543" href="/lia/part5/AExp/#543" class="Generalizable">z</a> <a id="545" class="Symbol">:</a> <a id="547" href="/lia/part5/AExp/#509" class="Function">VarName</a></pre>

<h2 id="syntax-of-expressions">
<a class="anchor" href="#syntax-of-expressions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Syntax of expressions</h2>

<p>We define a minimalistic language of arithmetic expressions comprising
variables and a let assignment construct.</p>

<pre class="Agda"><a id="704" class="Keyword">data</a> <a id="AExp"></a><a id="709" href="/lia/part5/AExp/#709" class="Datatype">AExp</a> <a id="714" class="Symbol">:</a> <a id="716" class="PrimitiveType">Set</a> <a id="720" class="Keyword">where</a>
  <a id="AExp.Num"></a><a id="728" href="/lia/part5/AExp/#728" class="InductiveConstructor">Num</a> <a id="732" class="Symbol">:</a> <a id="734" class="Symbol">(</a><a id="735" href="/lia/part5/AExp/#735" class="Bound">n</a> <a id="737" class="Symbol">:</a> <a id="739" href="/lia/part0/Naturals/#247" class="Function">ℕ</a><a id="740" class="Symbol">)</a> <a id="742" class="Symbol">→</a> <a id="744" href="/lia/part5/AExp/#709" class="Datatype">AExp</a>
  <a id="AExp.Var"></a><a id="751" href="/lia/part5/AExp/#751" class="InductiveConstructor">Var</a> <a id="755" class="Symbol">:</a> <a id="757" class="Symbol">(</a><a id="758" href="/lia/part5/AExp/#758" class="Bound">x</a> <a id="760" class="Symbol">:</a> <a id="762" href="/lia/part5/AExp/#509" class="Function">VarName</a><a id="769" class="Symbol">)</a> <a id="771" class="Symbol">→</a> <a id="773" href="/lia/part5/AExp/#709" class="Datatype">AExp</a>
  <a id="AExp.Add"></a><a id="780" href="/lia/part5/AExp/#780" class="InductiveConstructor">Add</a> <a id="784" class="Symbol">:</a> <a id="786" class="Symbol">(</a><a id="787" href="/lia/part5/AExp/#787" class="Bound">e</a> <a id="789" href="/lia/part5/AExp/#789" class="Bound">f</a> <a id="791" class="Symbol">:</a> <a id="793" href="/lia/part5/AExp/#709" class="Datatype">AExp</a><a id="797" class="Symbol">)</a> <a id="799" class="Symbol">→</a> <a id="801" href="/lia/part5/AExp/#709" class="Datatype">AExp</a>
  <a id="AExp.Mul"></a><a id="808" href="/lia/part5/AExp/#808" class="InductiveConstructor">Mul</a> <a id="812" class="Symbol">:</a> <a id="814" class="Symbol">(</a><a id="815" href="/lia/part5/AExp/#815" class="Bound">e</a> <a id="817" href="/lia/part5/AExp/#817" class="Bound">f</a> <a id="819" class="Symbol">:</a> <a id="821" href="/lia/part5/AExp/#709" class="Datatype">AExp</a><a id="825" class="Symbol">)</a> <a id="827" class="Symbol">→</a> <a id="829" href="/lia/part5/AExp/#709" class="Datatype">AExp</a>
  <a id="AExp.Let"></a><a id="836" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="840" class="Symbol">:</a> <a id="842" class="Symbol">(</a><a id="843" href="/lia/part5/AExp/#843" class="Bound">x</a> <a id="845" class="Symbol">:</a> <a id="847" href="/lia/part5/AExp/#509" class="Function">VarName</a><a id="854" class="Symbol">)</a> <a id="856" class="Symbol">(</a><a id="857" href="/lia/part5/AExp/#857" class="Bound">e</a> <a id="859" href="/lia/part5/AExp/#859" class="Bound">f</a> <a id="861" class="Symbol">:</a> <a id="863" href="/lia/part5/AExp/#709" class="Datatype">AExp</a><a id="867" class="Symbol">)</a> <a id="869" class="Symbol">→</a> <a id="871" href="/lia/part5/AExp/#709" class="Datatype">AExp</a>

<a id="877" class="Keyword">private</a>
  <a id="887" class="Keyword">variable</a>
    <a id="900" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="902" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="905" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="907" href="/lia/part5/AExp/#907" class="Generalizable">f′</a> <a id="910" href="/lia/part5/AExp/#910" class="Generalizable">g</a> <a id="912" class="Symbol">:</a> <a id="914" href="/lia/part5/AExp/#709" class="Datatype">AExp</a>
    <a id="923" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="925" href="/lia/part5/AExp/#925" class="Generalizable">n</a> <a id="927" class="Symbol">:</a> <a id="929" href="/lia/part0/Naturals/#247" class="Function">ℕ</a></pre>

<p>For example, the following expression adds one to a variable (called
10). This is pure syntax so far, no calculation is being performed.</p>

<pre class="Agda"><a id="add-one"></a><a id="1078" href="/lia/part5/AExp/#1078" class="Function">add-one</a> <a id="1086" class="Symbol">:</a> <a id="1088" href="/lia/part5/AExp/#709" class="Datatype">AExp</a>
<a id="1093" href="/lia/part5/AExp/#1078" class="Function">add-one</a> <a id="1101" class="Symbol">=</a> <a id="1103" href="/lia/part5/AExp/#780" class="InductiveConstructor">Add</a> <a id="1107" class="Symbol">(</a><a id="1108" href="/lia/part5/AExp/#751" class="InductiveConstructor">Var</a> <a id="1112" class="Number">10</a><a id="1114" class="Symbol">)</a> <a id="1116" class="Symbol">(</a><a id="1117" href="/lia/part5/AExp/#728" class="InductiveConstructor">Num</a> <a id="1121" class="Number">1</a><a id="1122" class="Symbol">)</a></pre>
<pre class="Agda"><a id="1133" class="Keyword">pattern</a> <a id="$_"></a><a id="1141" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$_</a> <a id="1144" href="/lia/part5/AExp/#1152" class="Bound">n</a> <a id="1146" class="Symbol">=</a> <a id="1148" class="InductiveConstructor">Num</a> <a id="1152" href="/lia/part5/AExp/#1152" class="Bound">n</a>
<a id="1154" class="Keyword">pattern</a> <a id="`_"></a><a id="1162" href="/lia/part5/AExp/#1162" class="InductiveConstructor Operator">`_</a> <a id="1165" href="/lia/part5/AExp/#1173" class="Bound">x</a> <a id="1167" class="Symbol">=</a> <a id="1169" href="/lia/part5/AExp/#751" class="InductiveConstructor">Var</a> <a id="1173" href="/lia/part5/AExp/#1173" class="Bound">x</a>
<a id="1175" class="Keyword">pattern</a> <a id="_+_"></a><a id="1183" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">_+_</a> <a id="1187" href="/lia/part5/AExp/#1197" class="Bound">x</a> <a id="1189" href="/lia/part5/AExp/#1199" class="Bound">y</a> <a id="1191" class="Symbol">=</a> <a id="1193" href="/lia/part5/AExp/#780" class="InductiveConstructor">Add</a> <a id="1197" href="/lia/part5/AExp/#1197" class="Bound">x</a> <a id="1199" href="/lia/part5/AExp/#1199" class="Bound">y</a>
<a id="1201" class="Keyword">pattern</a> <a id="_·_"></a><a id="1209" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">_·_</a> <a id="1213" href="/lia/part5/AExp/#1223" class="Bound">x</a> <a id="1215" href="/lia/part5/AExp/#1225" class="Bound">y</a> <a id="1217" class="Symbol">=</a> <a id="1219" href="/lia/part5/AExp/#808" class="InductiveConstructor">Mul</a> <a id="1223" href="/lia/part5/AExp/#1223" class="Bound">x</a> <a id="1225" href="/lia/part5/AExp/#1225" class="Bound">y</a>

<a id="1228" class="Keyword">infix</a> <a id="1234" class="Number">50</a> <a id="1237" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$_</a> <a id="1240" href="/lia/part5/AExp/#1162" class="InductiveConstructor Operator">`_</a>
<a id="1243" class="Keyword">infixr</a> <a id="1250" class="Number">30</a> <a id="1253" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">_·_</a>
<a id="1257" class="Keyword">infixl</a> <a id="1264" class="Number">25</a> <a id="1267" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">_+_</a></pre>

<h2 id="environments">
<a class="anchor" href="#environments" aria-hidden="true"><span class="octicon octicon-link"></span></a>Environments</h2>

<p>In order to represent the value of free variables, we use environments.</p>

<pre class="Agda"><a id="Env"></a><a id="1370" href="/lia/part5/AExp/#1370" class="Function">Env</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="/lia/part5/AExp/#509" class="Function">VarName</a> <a id="1384" class="Symbol">→</a> <a id="1386" href="/lia/part0/Naturals/#247" class="Function">ℕ</a>

<a id="1389" class="Keyword">private</a> <a id="1397" class="Keyword">variable</a> <a id="1406" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="1408" class="Symbol">:</a> <a id="1410" href="/lia/part5/AExp/#1370" class="Function">Env</a></pre>

<p>The following environment assigns value <code class="language-plaintext highlighter-rouge">200</code> to the variable named
<code class="language-plaintext highlighter-rouge">10</code>, and value <code class="language-plaintext highlighter-rouge">40</code> to every other variable.</p>

<pre class="Agda"><a id="ρ0"></a><a id="1538" href="/lia/part5/AExp/#1538" class="Function">ρ0</a> <a id="1541" class="Symbol">:</a> <a id="1543" href="/lia/part5/AExp/#1370" class="Function">Env</a>
<a id="1547" href="/lia/part5/AExp/#1538" class="Function">ρ0</a> <a id="1550" class="Number">10</a> <a id="1553" class="Symbol">=</a> <a id="1555" class="Number">200</a>
<a id="1559" href="/lia/part5/AExp/#1538" class="CatchallClause Function">ρ0</a><a id="1561" class="CatchallClause"> </a><a id="1562" class="CatchallClause Symbol">_</a> <a id="1564" class="Symbol">=</a> <a id="1566" class="Number">40</a></pre>

<h1 id="denotational-semantics">
<a class="anchor" href="#denotational-semantics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Denotational semantics</h1>

<pre class="Agda"><a id="1604" class="Keyword">infix</a> <a id="1610" class="Number">15</a> <a id="1613" href="/lia/part5/AExp/#1618" class="Function Operator">⟦_⟧_</a>
<a id="⟦_⟧_"></a><a id="1618" href="/lia/part5/AExp/#1618" class="Function Operator">⟦_⟧_</a> <a id="1623" class="Symbol">:</a> <a id="1625" href="/lia/part5/AExp/#709" class="Datatype">AExp</a> <a id="1630" class="Symbol">→</a> <a id="1632" href="/lia/part5/AExp/#1370" class="Function">Env</a> <a id="1636" class="Symbol">→</a> <a id="1638" href="/lia/part0/Naturals/#247" class="Function">ℕ</a>
<a id="1640" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1642" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="1644" href="/lia/part5/AExp/#1644" class="Bound">n</a> <a id="1646" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1648" href="/lia/part5/AExp/#1648" class="Bound">ρ</a> <a id="1650" class="Symbol">=</a> <a id="1652" href="/lia/part5/AExp/#1644" class="Bound">n</a>
<a id="1654" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1656" href="/lia/part5/AExp/#1162" class="InductiveConstructor Operator">`</a> <a id="1658" href="/lia/part5/AExp/#1658" class="Bound">x</a> <a id="1660" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1662" href="/lia/part5/AExp/#1662" class="Bound">ρ</a> <a id="1664" class="Symbol">=</a> <a id="1666" href="/lia/part5/AExp/#1662" class="Bound">ρ</a> <a id="1668" href="/lia/part5/AExp/#1658" class="Bound">x</a>
<a id="1670" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1672" href="/lia/part5/AExp/#1672" class="Bound">e</a> <a id="1674" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="1676" href="/lia/part5/AExp/#1676" class="Bound">f</a> <a id="1678" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1680" href="/lia/part5/AExp/#1680" class="Bound">ρ</a> <a id="1682" class="Symbol">=</a> <a id="1684" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1686" href="/lia/part5/AExp/#1672" class="Bound">e</a> <a id="1688" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1690" href="/lia/part5/AExp/#1680" class="Bound">ρ</a> <a id="1692" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="1695" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1697" href="/lia/part5/AExp/#1676" class="Bound">f</a> <a id="1699" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1701" href="/lia/part5/AExp/#1680" class="Bound">ρ</a>
<a id="1703" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1705" href="/lia/part5/AExp/#1705" class="Bound">e</a> <a id="1707" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="1709" href="/lia/part5/AExp/#1709" class="Bound">f</a> <a id="1711" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1713" href="/lia/part5/AExp/#1713" class="Bound">ρ</a> <a id="1715" class="Symbol">=</a> <a id="1717" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1719" href="/lia/part5/AExp/#1705" class="Bound">e</a> <a id="1721" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1723" href="/lia/part5/AExp/#1713" class="Bound">ρ</a> <a id="1725" href="/lia/part5/AExp/#179" class="Function Operator">·ℕ</a> <a id="1728" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1730" href="/lia/part5/AExp/#1709" class="Bound">f</a> <a id="1732" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1734" href="/lia/part5/AExp/#1713" class="Bound">ρ</a>
<a id="1736" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1738" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="1742" href="/lia/part5/AExp/#1742" class="Bound">x</a> <a id="1744" href="/lia/part5/AExp/#1744" class="Bound">e</a> <a id="1746" href="/lia/part5/AExp/#1746" class="Bound">f</a> <a id="1748" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1750" href="/lia/part5/AExp/#1750" class="Bound">ρ</a> <a id="1752" class="Symbol">=</a> <a id="1754" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1756" href="/lia/part5/AExp/#1746" class="Bound">f</a> <a id="1758" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1760" href="/lia/part5/AExp/#1750" class="Bound">ρ</a> <a id="1762" href="/lia/part0/Functions/#568" class="Function Operator">[</a> <a id="1764" href="/lia/part5/AExp/#1742" class="Bound">x</a> <a id="1766" href="/lia/part0/Functions/#568" class="Function Operator">↦</a> <a id="1768" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1770" href="/lia/part5/AExp/#1744" class="Bound">e</a> <a id="1772" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1774" href="/lia/part5/AExp/#1750" class="Bound">ρ</a> <a id="1776" href="/lia/part0/Functions/#568" class="Function Operator">]</a></pre>

<p>With our denotational semantics for expressions we can check (by
computation) the value of concrete expressions.</p>

<pre class="Agda"><a id="1901" href="/lia/part5/AExp/#1901" class="Function">_</a> <a id="1903" class="Symbol">:</a> <a id="1905" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="1907" href="/lia/part5/AExp/#1078" class="Function">add-one</a> <a id="1915" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="1917" href="/lia/part5/AExp/#1538" class="Function">ρ0</a> <a id="1920" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1922" class="Number">201</a>
<a id="1926" class="Symbol">_</a> <a id="1928" class="Symbol">=</a> <a id="1930" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a></pre>

<h1 id="small-steps-operational-semantics">
<a class="anchor" href="#small-steps-operational-semantics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Small-steps operational semantics</h1>

<p>We use global environments and eager semantics.</p>

<pre class="Agda"><a id="2030" class="Keyword">infix</a> <a id="2036" class="Number">4</a> <a id="2038" href="/lia/part5/AExp/#2049" class="Datatype Operator">_⊢_↝_</a>
<a id="2044" class="Keyword">data</a> <a id="_⊢_↝_"></a><a id="2049" href="/lia/part5/AExp/#2049" class="Datatype Operator">_⊢_↝_</a> <a id="2055" class="Symbol">:</a> <a id="2057" href="/lia/part5/AExp/#1370" class="Function">Env</a> <a id="2061" class="Symbol">→</a> <a id="2063" href="/lia/part5/AExp/#709" class="Datatype">AExp</a> <a id="2068" class="Symbol">→</a> <a id="2070" href="/lia/part5/AExp/#709" class="Datatype">AExp</a> <a id="2075" class="Symbol">→</a> <a id="2077" class="PrimitiveType">Set</a> <a id="2081" class="Keyword">where</a>

  <a id="_⊢_↝_.↝-Var"></a><a id="2090" href="/lia/part5/AExp/#2090" class="InductiveConstructor">↝-Var</a> <a id="2096" class="Symbol">:</a> <a id="2098" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2100" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2102" href="/lia/part5/AExp/#1162" class="InductiveConstructor Operator">`</a> <a id="2104" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="2106" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2108" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2110" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2112" href="/lia/part5/AExp/#539" class="Generalizable">x</a>

  <a id="_⊢_↝_.↝-Add-stop"></a><a id="2117" href="/lia/part5/AExp/#2117" class="InductiveConstructor">↝-Add-stop</a> <a id="2128" class="Symbol">:</a>
    <a id="2134" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2136" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2138" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2140" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="2142" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="2144" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2146" href="/lia/part5/AExp/#925" class="Generalizable">n</a> <a id="2148" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2150" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2152" class="Symbol">(</a><a id="2153" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="2155" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="2158" href="/lia/part5/AExp/#925" class="Generalizable">n</a><a id="2159" class="Symbol">)</a>

  <a id="_⊢_↝_.↝-Add-left"></a><a id="2164" href="/lia/part5/AExp/#2164" class="InductiveConstructor">↝-Add-left</a> <a id="2175" class="Symbol">:</a>
    <a id="2181" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2183" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2185" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2187" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2189" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="2192" class="Symbol">→</a>
    <a id="2198" class="Comment">------------------</a>
    <a id="2221" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2223" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2225" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2227" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="2229" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2231" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2233" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="2236" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="2238" href="/lia/part5/AExp/#905" class="Generalizable">f</a>

  <a id="_⊢_↝_.↝-Add-right"></a><a id="2243" href="/lia/part5/AExp/#2243" class="InductiveConstructor">↝-Add-right</a> <a id="2255" class="Symbol">:</a>
    <a id="2261" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2263" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2265" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2267" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2269" href="/lia/part5/AExp/#907" class="Generalizable">f′</a> <a id="2272" class="Symbol">→</a>
    <a id="2278" class="Comment">------------------</a>
    <a id="2301" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2303" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2305" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2307" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="2309" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2311" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2313" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2315" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="2317" href="/lia/part5/AExp/#907" class="Generalizable">f′</a>

  <a id="_⊢_↝_.↝-Mul-stop"></a><a id="2323" href="/lia/part5/AExp/#2323" class="InductiveConstructor">↝-Mul-stop</a> <a id="2334" class="Symbol">:</a>
    <a id="2340" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2342" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2344" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2346" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="2348" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="2350" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2352" href="/lia/part5/AExp/#925" class="Generalizable">n</a> <a id="2354" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2356" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2358" class="Symbol">(</a><a id="2359" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="2361" href="/lia/part5/AExp/#179" class="Function Operator">·ℕ</a> <a id="2364" href="/lia/part5/AExp/#925" class="Generalizable">n</a><a id="2365" class="Symbol">)</a>

  <a id="_⊢_↝_.↝-Mul-left"></a><a id="2370" href="/lia/part5/AExp/#2370" class="InductiveConstructor">↝-Mul-left</a> <a id="2381" class="Symbol">:</a>
    <a id="2387" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2389" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2391" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2393" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2395" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="2398" class="Symbol">→</a>
    <a id="2404" class="Comment">------------------</a>
    <a id="2427" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2429" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2431" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2433" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="2435" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2437" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2439" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="2442" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="2444" href="/lia/part5/AExp/#905" class="Generalizable">f</a>

  <a id="_⊢_↝_.↝-Mul-right"></a><a id="2449" href="/lia/part5/AExp/#2449" class="InductiveConstructor">↝-Mul-right</a> <a id="2461" class="Symbol">:</a>
    <a id="2467" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2469" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2471" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2473" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2475" href="/lia/part5/AExp/#907" class="Generalizable">f′</a> <a id="2478" class="Symbol">→</a>
    <a id="2484" class="Comment">------------------</a>
    <a id="2507" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2509" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2511" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2513" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="2515" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2517" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2519" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2521" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="2523" href="/lia/part5/AExp/#907" class="Generalizable">f′</a>

  <a id="_⊢_↝_.↝-Let-stop"></a><a id="2529" href="/lia/part5/AExp/#2529" class="InductiveConstructor">↝-Let-stop</a> <a id="2540" class="Symbol">:</a>
    <a id="2546" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2548" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2550" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="2554" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="2556" class="Symbol">(</a><a id="2557" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2559" href="/lia/part5/AExp/#923" class="Generalizable">m</a><a id="2560" class="Symbol">)</a> <a id="2562" class="Symbol">(</a><a id="2563" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2565" href="/lia/part5/AExp/#925" class="Generalizable">n</a><a id="2566" class="Symbol">)</a> <a id="2568" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2570" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2572" href="/lia/part5/AExp/#925" class="Generalizable">n</a>

  <a id="_⊢_↝_.↝-Let-1"></a><a id="2577" href="/lia/part5/AExp/#2577" class="InductiveConstructor">↝-Let-1</a> <a id="2585" class="Symbol">:</a>
    <a id="2591" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2593" href="/lia/part0/Functions/#568" class="Function Operator">[</a> <a id="2595" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="2597" href="/lia/part0/Functions/#568" class="Function Operator">↦</a> <a id="2599" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="2601" href="/lia/part0/Functions/#568" class="Function Operator">]</a> <a id="2603" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2605" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2607" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2609" href="/lia/part5/AExp/#907" class="Generalizable">f′</a> <a id="2612" class="Symbol">→</a>
    <a id="2618" class="Comment">----------------------------------</a>
    <a id="2657" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2659" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2661" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="2665" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="2667" class="Symbol">(</a><a id="2668" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2670" href="/lia/part5/AExp/#923" class="Generalizable">m</a><a id="2671" class="Symbol">)</a> <a id="2673" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2675" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2677" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="2681" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="2683" class="Symbol">(</a><a id="2684" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="2686" href="/lia/part5/AExp/#923" class="Generalizable">m</a><a id="2687" class="Symbol">)</a> <a id="2689" href="/lia/part5/AExp/#907" class="Generalizable">f′</a>

  <a id="_⊢_↝_.↝-Let-2"></a><a id="2695" href="/lia/part5/AExp/#2695" class="InductiveConstructor">↝-Let-2</a> <a id="2703" class="Symbol">:</a>
    <a id="2709" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2711" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2713" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2715" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2717" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="2720" class="Symbol">→</a>
    <a id="2726" class="Comment">--------------------------</a>
    <a id="2757" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2759" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2761" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="2765" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="2767" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2769" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2771" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2773" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="2777" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="2779" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="2782" href="/lia/part5/AExp/#905" class="Generalizable">f</a></pre>

<h2 id="preservation">
<a class="anchor" href="#preservation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Preservation</h2>

<pre class="Agda"><a id="preservation"></a><a id="2810" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="2823" class="Symbol">:</a>
  <a id="2827" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2829" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="2831" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2833" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="2835" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2837" class="Symbol">→</a>
  <a id="2841" class="Comment">-----------------</a>
  <a id="2861" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="2863" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="2865" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="2867" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="2869" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2871" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="2873" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="2875" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="2877" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a>

<a id="2880" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="2893" href="/lia/part5/AExp/#2090" class="InductiveConstructor">↝-Var</a> <a id="2899" class="Symbol">=</a> <a id="2901" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="2907" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="2920" href="/lia/part5/AExp/#2117" class="InductiveConstructor">↝-Add-stop</a> <a id="2931" class="Symbol">=</a> <a id="2933" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="2938" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="2951" class="Symbol">(</a><a id="2952" href="/lia/part5/AExp/#2164" class="InductiveConstructor">↝-Add-left</a> <a id="2963" href="/lia/part5/AExp/#2963" class="Bound">step</a><a id="2967" class="Symbol">)</a> <a id="2969" class="Keyword">rewrite</a> <a id="2977" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="2990" href="/lia/part5/AExp/#2963" class="Bound">step</a> <a id="2995" class="Symbol">=</a> <a id="2997" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3002" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3015" class="Symbol">(</a><a id="3016" href="/lia/part5/AExp/#2243" class="InductiveConstructor">↝-Add-right</a> <a id="3028" href="/lia/part5/AExp/#3028" class="Bound">step</a><a id="3032" class="Symbol">)</a> <a id="3034" class="Keyword">rewrite</a> <a id="3042" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3055" href="/lia/part5/AExp/#3028" class="Bound">step</a> <a id="3060" class="Symbol">=</a> <a id="3062" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="3068" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3081" href="/lia/part5/AExp/#2323" class="InductiveConstructor">↝-Mul-stop</a> <a id="3092" class="Symbol">=</a> <a id="3094" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3099" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3112" class="Symbol">(</a><a id="3113" href="/lia/part5/AExp/#2370" class="InductiveConstructor">↝-Mul-left</a> <a id="3124" href="/lia/part5/AExp/#3124" class="Bound">step</a><a id="3128" class="Symbol">)</a> <a id="3130" class="Keyword">rewrite</a> <a id="3138" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3151" href="/lia/part5/AExp/#3124" class="Bound">step</a> <a id="3156" class="Symbol">=</a> <a id="3158" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3163" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3176" class="Symbol">(</a><a id="3177" href="/lia/part5/AExp/#2449" class="InductiveConstructor">↝-Mul-right</a> <a id="3189" href="/lia/part5/AExp/#3189" class="Bound">step</a><a id="3193" class="Symbol">)</a> <a id="3195" class="Keyword">rewrite</a> <a id="3203" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3216" href="/lia/part5/AExp/#3189" class="Bound">step</a> <a id="3221" class="Symbol">=</a> <a id="3223" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="3229" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3242" href="/lia/part5/AExp/#2529" class="InductiveConstructor">↝-Let-stop</a> <a id="3253" class="Symbol">=</a> <a id="3255" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3260" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3273" class="Symbol">(</a><a id="3274" href="/lia/part5/AExp/#2577" class="InductiveConstructor">↝-Let-1</a> <a id="3282" href="/lia/part5/AExp/#3282" class="Bound">step</a><a id="3286" class="Symbol">)</a> <a id="3288" class="Keyword">rewrite</a> <a id="3296" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3309" href="/lia/part5/AExp/#3282" class="Bound">step</a> <a id="3314" class="Symbol">=</a> <a id="3316" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3321" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3334" class="Symbol">(</a><a id="3335" href="/lia/part5/AExp/#2695" class="InductiveConstructor">↝-Let-2</a> <a id="3343" href="/lia/part5/AExp/#3343" class="Bound">step</a><a id="3347" class="Symbol">)</a> <a id="3349" class="Keyword">rewrite</a> <a id="3357" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="3370" href="/lia/part5/AExp/#3343" class="Bound">step</a> <a id="3375" class="Symbol">=</a> <a id="3377" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a></pre>

<h2 id="transitive-closure">
<a class="anchor" href="#transitive-closure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Transitive closure</h2>

<p>We define the transitive closure of the small-step operational
semantics.</p>

<pre class="Agda"><a id="3489" class="Keyword">data</a> <a id="_⊢_↝*_"></a><a id="3494" href="/lia/part5/AExp/#3494" class="Datatype Operator">_⊢_↝*_</a> <a id="3501" class="Symbol">:</a> <a id="3503" href="/lia/part5/AExp/#1370" class="Function">Env</a> <a id="3507" class="Symbol">→</a> <a id="3509" href="/lia/part5/AExp/#709" class="Datatype">AExp</a> <a id="3514" class="Symbol">→</a> <a id="3516" href="/lia/part5/AExp/#709" class="Datatype">AExp</a> <a id="3521" class="Symbol">→</a> <a id="3523" class="PrimitiveType">Set</a> <a id="3527" class="Keyword">where</a>

    <a id="_⊢_↝*_.stop"></a><a id="3538" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="3543" class="Symbol">:</a> <a id="3545" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="3547" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="3549" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="3551" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="3554" href="/lia/part5/AExp/#900" class="Generalizable">e</a>

    <a id="_⊢_↝*_.one"></a><a id="3561" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="3565" class="Symbol">:</a> <a id="3567" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="3569" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="3571" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="3573" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="3575" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="3577" class="Symbol">→</a>
          <a id="3589" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="3591" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="3593" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="3595" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="3598" href="/lia/part5/AExp/#910" class="Generalizable">g</a> <a id="3600" class="Symbol">→</a>
          <a id="3612" class="Comment">----------</a>
          <a id="3633" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="3635" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="3637" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="3639" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="3642" href="/lia/part5/AExp/#910" class="Generalizable">g</a></pre>

<p>We can indeed show that <code class="language-plaintext highlighter-rouge">_⊢_↝*_</code> is transitive with a standard
induction.</p>

<pre class="Agda"><a id="↝*-trans"></a><a id="3728" href="/lia/part5/AExp/#3728" class="Function">↝*-trans</a> <a id="3737" class="Symbol">:</a>
  <a id="3741" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="3743" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="3745" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="3747" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="3750" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="3752" class="Symbol">→</a>
  <a id="3756" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="3758" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="3760" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="3762" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="3765" href="/lia/part5/AExp/#910" class="Generalizable">g</a> <a id="3767" class="Symbol">→</a>
  <a id="3771" class="Comment">----------</a>
  <a id="3784" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="3786" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="3788" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="3790" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="3793" href="/lia/part5/AExp/#910" class="Generalizable">g</a>

<a id="3796" href="/lia/part5/AExp/#3728" class="Function">↝*-trans</a> <a id="3805" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="3810" href="/lia/part5/AExp/#3810" class="Bound">δ</a> <a id="3812" class="Symbol">=</a> <a id="3814" href="/lia/part5/AExp/#3810" class="Bound">δ</a>
<a id="3816" href="/lia/part5/AExp/#3728" class="Function">↝*-trans</a> <a id="3825" class="Symbol">(</a><a id="3826" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="3830" href="/lia/part5/AExp/#3830" class="Bound">step</a> <a id="3835" href="/lia/part5/AExp/#3835" class="Bound">δ₁</a><a id="3837" class="Symbol">)</a> <a id="3839" href="/lia/part5/AExp/#3839" class="Bound">δ₂</a> <a id="3842" class="Symbol">=</a> <a id="3844" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="3848" href="/lia/part5/AExp/#3830" class="Bound">step</a> <a id="3853" class="Symbol">(</a><a id="3854" href="/lia/part5/AExp/#3728" class="Function">↝*-trans</a> <a id="3863" href="/lia/part5/AExp/#3835" class="Bound">δ₁</a> <a id="3866" href="/lia/part5/AExp/#3839" class="Bound">δ₂</a><a id="3868" class="Symbol">)</a></pre>

<p>An easy induction based on <a href="#preservation"><code class="language-plaintext highlighter-rouge">preservation</code></a> shows that
the denotational semantics is preserved by the transitive closure of the
small-step operational semantics.</p>

<pre class="Agda"><a id="preservation*"></a><a id="4044" href="/lia/part5/AExp/#4044" class="Function">preservation*</a> <a id="4058" class="Symbol">:</a>
  <a id="4062" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="4064" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="4066" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="4068" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="4071" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="4073" class="Symbol">→</a>
  <a id="4077" class="Comment">-----------------</a>
  <a id="4097" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="4099" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="4101" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="4103" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="4105" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4107" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="4109" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="4111" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="4113" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a>

<a id="4116" href="/lia/part5/AExp/#4044" class="Function">preservation*</a> <a id="4130" class="Symbol">{</a><a id="4131" href="/lia/part5/AExp/#4131" class="Bound">ρ</a><a id="4132" class="Symbol">}</a> <a id="4134" class="Symbol">{</a><a id="4135" href="/lia/part5/AExp/#4135" class="Bound">e</a><a id="4136" class="Symbol">}</a> <a id="4138" class="Symbol">{</a><a id="4139" class="DottedPattern Symbol">.</a><a id="4140" href="/lia/part5/AExp/#4135" class="DottedPattern Bound">e</a><a id="4141" class="Symbol">}</a> <a id="4143" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="4148" class="Symbol">=</a> <a id="4150" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4155" href="/lia/part5/AExp/#4044" class="Function">preservation*</a> <a id="4169" class="Symbol">{</a><a id="4170" href="/lia/part5/AExp/#4170" class="Bound">ρ</a><a id="4171" class="Symbol">}</a> <a id="4173" class="Symbol">{</a><a id="4174" href="/lia/part5/AExp/#4174" class="Bound">e</a><a id="4175" class="Symbol">}</a> <a id="4177" class="Symbol">{</a><a id="4178" href="/lia/part5/AExp/#4178" class="Bound">g</a><a id="4179" class="Symbol">}</a> <a id="4181" class="Symbol">(</a><a id="4182" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="4186" class="Symbol">{</a><a id="4187" class="Argument">f</a> <a id="4189" class="Symbol">=</a> <a id="4191" href="/lia/part5/AExp/#4191" class="Bound">f</a><a id="4192" class="Symbol">}</a> <a id="4194" href="/lia/part5/AExp/#4194" class="Bound">step</a> <a id="4199" href="/lia/part5/AExp/#4199" class="Bound">der</a><a id="4202" class="Symbol">)</a> <a id="4204" class="Symbol">=</a>
    <a id="4210" href="/lia/part0/Equality/#1858" class="Function Operator">begin</a>
        <a id="4224" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="4226" href="/lia/part5/AExp/#4174" class="Bound">e</a> <a id="4228" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="4230" href="/lia/part5/AExp/#4170" class="Bound">ρ</a> <a id="4232" href="/lia/part0/Equality/#2003" class="Function Operator">≡⟨</a> <a id="4235" href="/lia/part5/AExp/#2810" class="Function">preservation</a> <a id="4248" class="Symbol">{</a><a id="4249" href="/lia/part5/AExp/#4170" class="Bound">ρ</a><a id="4250" class="Symbol">}</a> <a id="4252" class="Symbol">{</a><a id="4253" href="/lia/part5/AExp/#4174" class="Bound">e</a><a id="4254" class="Symbol">}</a> <a id="4256" class="Symbol">{</a><a id="4257" href="/lia/part5/AExp/#4191" class="Bound">f</a><a id="4258" class="Symbol">}</a> <a id="4260" href="/lia/part5/AExp/#4194" class="Bound">step</a> <a id="4265" href="/lia/part0/Equality/#2003" class="Function Operator">⟩</a>
        <a id="4275" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="4277" href="/lia/part5/AExp/#4191" class="Bound">f</a> <a id="4279" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="4281" href="/lia/part5/AExp/#4170" class="Bound">ρ</a> <a id="4283" href="/lia/part0/Equality/#2003" class="Function Operator">≡⟨</a> <a id="4286" href="/lia/part5/AExp/#4044" class="Function">preservation*</a> <a id="4300" class="Symbol">{</a><a id="4301" href="/lia/part5/AExp/#4170" class="Bound">ρ</a><a id="4302" class="Symbol">}</a> <a id="4304" class="Symbol">{</a><a id="4305" href="/lia/part5/AExp/#4191" class="Bound">f</a><a id="4306" class="Symbol">}</a> <a id="4308" class="Symbol">{</a><a id="4309" href="/lia/part5/AExp/#4178" class="Bound">g</a><a id="4310" class="Symbol">}</a> <a id="4312" href="/lia/part5/AExp/#4199" class="Bound">der</a> <a id="4316" href="/lia/part0/Equality/#2003" class="Function Operator">⟩</a>
        <a id="4326" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="4328" href="/lia/part5/AExp/#4178" class="Bound">g</a> <a id="4330" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="4332" href="/lia/part5/AExp/#4170" class="Bound">ρ</a>
    <a id="4338" href="/lia/part0/Equality/#2104" class="Function Operator">∎</a></pre>

<p>This immediately implies that whenever the small-step semantics
terminates producing a number <code class="language-plaintext highlighter-rouge">m</code>, then this is the right result.</p>

<pre class="Agda"><a id="↝*-agree-⟦⟧"></a><a id="4480" href="/lia/part5/AExp/#4480" class="Function">↝*-agree-⟦⟧</a> <a id="4492" class="Symbol">:</a>
  <a id="4496" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="4498" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="4500" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="4502" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="4505" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="4507" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="4509" class="Symbol">→</a>
  <a id="4513" class="Comment">--------------</a>
  <a id="4530" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="4532" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4534" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="4536" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="4538" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="4540" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a>

<a id="4543" href="/lia/part5/AExp/#4480" class="Function">↝*-agree-⟦⟧</a> <a id="4555" href="/lia/part5/AExp/#4555" class="Bound">der</a> <a id="4559" class="Symbol">=</a> <a id="4561" href="/lia/part0/Equality/#458" class="Function">sym</a> <a id="4565" class="Symbol">(</a><a id="4566" href="/lia/part5/AExp/#4044" class="Function">preservation*</a> <a id="4580" href="/lia/part5/AExp/#4555" class="Bound">der</a><a id="4583" class="Symbol">)</a></pre>

<h2 id="deterministic-values">
<a class="anchor" href="#deterministic-values" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deterministic values</h2>

<p>Notice that small-step semantics is a non-deterministic relation: In
general there may be several ways to reduce an expression (as witnessed
by the rules <code class="language-plaintext highlighter-rouge">↝-Add-left</code> and <code class="language-plaintext highlighter-rouge">↝-Add-right</code> for instance).</p>

<p>However, as an immediate consequence of preservation we have that if two
numerical values are eventually produced, then they necessarily are the
same number.</p>

<pre class="Agda"><a id="↝*-det"></a><a id="4979" href="/lia/part5/AExp/#4979" class="Function">↝*-det</a> <a id="4986" class="Symbol">:</a>
  <a id="4990" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="4992" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="4994" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="4996" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="4999" href="/lia/part5/AExp/#728" class="InductiveConstructor">Num</a> <a id="5003" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="5005" class="Symbol">→</a>
  <a id="5009" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5011" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5013" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5015" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5018" href="/lia/part5/AExp/#728" class="InductiveConstructor">Num</a> <a id="5022" href="/lia/part5/AExp/#925" class="Generalizable">n</a> <a id="5024" class="Symbol">→</a>
  <a id="5028" class="Comment">-----------------</a>
  <a id="5048" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="5050" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5052" href="/lia/part5/AExp/#925" class="Generalizable">n</a>

<a id="5055" href="/lia/part5/AExp/#4979" class="Function">↝*-det</a> <a id="5062" href="/lia/part5/AExp/#5062" class="Bound">der1</a> <a id="5067" href="/lia/part5/AExp/#5067" class="Bound">der2</a> <a id="5072" class="Keyword">rewrite</a> <a id="5080" href="/lia/part0/Equality/#458" class="Function">sym</a> <a id="5084" class="Symbol">(</a><a id="5085" href="/lia/part5/AExp/#4044" class="Function">preservation*</a> <a id="5099" href="/lia/part5/AExp/#5062" class="Bound">der1</a><a id="5103" class="Symbol">)</a> <a id="5105" class="Symbol">|</a> <a id="5107" href="/lia/part5/AExp/#4044" class="Function">preservation*</a> <a id="5121" href="/lia/part5/AExp/#5067" class="Bound">der2</a> <a id="5126" class="Symbol">=</a> <a id="5128" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a></pre>

<h2 id="congruence">
<a class="anchor" href="#congruence" aria-hidden="true"><span class="octicon octicon-link"></span></a>Congruence</h2>

<p>We show that the transitive closure <code class="language-plaintext highlighter-rouge">_⊢_↝*_</code> respects subexpressions.</p>

<pre class="Agda"><a id="add-cong-1"></a><a id="5228" href="/lia/part5/AExp/#5228" class="Function">add-cong-1</a> <a id="5239" class="Symbol">:</a>
  <a id="5243" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5245" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5247" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5249" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5252" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="5255" class="Symbol">→</a>
  <a id="5259" class="Comment">-------------------</a>
  <a id="5281" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5283" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5285" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5287" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="5289" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="5291" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5294" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="5297" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="5299" href="/lia/part5/AExp/#905" class="Generalizable">f</a>

<a id="5302" href="/lia/part5/AExp/#5228" class="Function">add-cong-1</a> <a id="5313" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="5318" class="Symbol">=</a> <a id="5320" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a>
<a id="5325" href="/lia/part5/AExp/#5228" class="Function">add-cong-1</a> <a id="5336" class="Symbol">(</a><a id="5337" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5341" href="/lia/part5/AExp/#5341" class="Bound">x</a> <a id="5343" href="/lia/part5/AExp/#5343" class="Bound">d</a><a id="5344" class="Symbol">)</a> <a id="5346" class="Symbol">=</a> <a id="5348" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5352" class="Symbol">(</a><a id="5353" href="/lia/part5/AExp/#2164" class="InductiveConstructor">↝-Add-left</a> <a id="5364" href="/lia/part5/AExp/#5341" class="Bound">x</a><a id="5365" class="Symbol">)</a> <a id="5367" class="Symbol">(</a><a id="5368" href="/lia/part5/AExp/#5228" class="Function">add-cong-1</a> <a id="5379" href="/lia/part5/AExp/#5343" class="Bound">d</a><a id="5380" class="Symbol">)</a>

<a id="add-cong-2"></a><a id="5383" href="/lia/part5/AExp/#5383" class="Function">add-cong-2</a> <a id="5394" class="Symbol">:</a>
  <a id="5398" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5400" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5402" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="5404" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5407" href="/lia/part5/AExp/#907" class="Generalizable">f′</a> <a id="5410" class="Symbol">→</a>
  <a id="5414" class="Comment">-------------------</a>
  <a id="5436" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5438" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5440" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5442" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="5444" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="5446" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5449" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5451" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="5453" href="/lia/part5/AExp/#907" class="Generalizable">f′</a>

<a id="5457" href="/lia/part5/AExp/#5383" class="Function">add-cong-2</a> <a id="5468" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="5473" class="Symbol">=</a> <a id="5475" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a>
<a id="5480" href="/lia/part5/AExp/#5383" class="Function">add-cong-2</a> <a id="5491" class="Symbol">(</a><a id="5492" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5496" href="/lia/part5/AExp/#5496" class="Bound">x</a> <a id="5498" href="/lia/part5/AExp/#5498" class="Bound">d</a><a id="5499" class="Symbol">)</a> <a id="5501" class="Symbol">=</a> <a id="5503" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5507" class="Symbol">(</a><a id="5508" href="/lia/part5/AExp/#2243" class="InductiveConstructor">↝-Add-right</a> <a id="5520" href="/lia/part5/AExp/#5496" class="Bound">x</a><a id="5521" class="Symbol">)</a> <a id="5523" class="Symbol">(</a><a id="5524" href="/lia/part5/AExp/#5383" class="Function">add-cong-2</a> <a id="5535" href="/lia/part5/AExp/#5498" class="Bound">d</a><a id="5536" class="Symbol">)</a>

<a id="mul-cong-1"></a><a id="5539" href="/lia/part5/AExp/#5539" class="Function">mul-cong-1</a> <a id="5550" class="Symbol">:</a>
  <a id="5554" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5556" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5558" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5560" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5563" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="5566" class="Symbol">→</a>
  <a id="5570" class="Comment">-------------------</a>
  <a id="5592" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5594" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5596" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5598" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="5600" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="5602" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5605" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="5608" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="5610" href="/lia/part5/AExp/#905" class="Generalizable">f</a>

<a id="5613" href="/lia/part5/AExp/#5539" class="Function">mul-cong-1</a> <a id="5624" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="5629" class="Symbol">=</a> <a id="5631" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a>
<a id="5636" href="/lia/part5/AExp/#5539" class="Function">mul-cong-1</a> <a id="5647" class="Symbol">(</a><a id="5648" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5652" href="/lia/part5/AExp/#5652" class="Bound">x</a> <a id="5654" href="/lia/part5/AExp/#5654" class="Bound">d</a><a id="5655" class="Symbol">)</a> <a id="5657" class="Symbol">=</a> <a id="5659" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5663" class="Symbol">(</a><a id="5664" href="/lia/part5/AExp/#2370" class="InductiveConstructor">↝-Mul-left</a> <a id="5675" href="/lia/part5/AExp/#5652" class="Bound">x</a><a id="5676" class="Symbol">)</a> <a id="5678" class="Symbol">(</a><a id="5679" href="/lia/part5/AExp/#5539" class="Function">mul-cong-1</a> <a id="5690" href="/lia/part5/AExp/#5654" class="Bound">d</a><a id="5691" class="Symbol">)</a>

<a id="mul-cong-2"></a><a id="5694" href="/lia/part5/AExp/#5694" class="Function">mul-cong-2</a> <a id="5705" class="Symbol">:</a>
  <a id="5709" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5711" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5713" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="5715" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5718" href="/lia/part5/AExp/#907" class="Generalizable">f′</a> <a id="5721" class="Symbol">→</a>
  <a id="5725" class="Comment">-------------------</a>
  <a id="5747" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5749" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5751" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5753" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="5755" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="5757" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5760" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5762" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="5764" href="/lia/part5/AExp/#907" class="Generalizable">f′</a>

<a id="5768" href="/lia/part5/AExp/#5694" class="Function">mul-cong-2</a> <a id="5779" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="5784" class="Symbol">=</a> <a id="5786" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a>
<a id="5791" href="/lia/part5/AExp/#5694" class="Function">mul-cong-2</a> <a id="5802" class="Symbol">(</a><a id="5803" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5807" href="/lia/part5/AExp/#5807" class="Bound">x</a> <a id="5809" href="/lia/part5/AExp/#5809" class="Bound">d</a><a id="5810" class="Symbol">)</a> <a id="5812" class="Symbol">=</a> <a id="5814" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5818" class="Symbol">(</a><a id="5819" href="/lia/part5/AExp/#2449" class="InductiveConstructor">↝-Mul-right</a> <a id="5831" href="/lia/part5/AExp/#5807" class="Bound">x</a><a id="5832" class="Symbol">)</a> <a id="5834" class="Symbol">(</a><a id="5835" href="/lia/part5/AExp/#5694" class="Function">mul-cong-2</a> <a id="5846" href="/lia/part5/AExp/#5809" class="Bound">d</a><a id="5847" class="Symbol">)</a>

<a id="let-cong-1"></a><a id="5850" href="/lia/part5/AExp/#5850" class="Function">let-cong-1</a> <a id="5861" class="Symbol">:</a>
  <a id="5865" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5867" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5869" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5871" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5874" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="5877" class="Symbol">→</a>
  <a id="5881" class="Comment">----------------------------</a>
  <a id="5912" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="5914" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="5916" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="5920" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="5922" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="5924" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="5926" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="5929" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="5933" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="5935" href="/lia/part5/AExp/#902" class="Generalizable">e′</a> <a id="5938" href="/lia/part5/AExp/#905" class="Generalizable">f</a>

<a id="5941" href="/lia/part5/AExp/#5850" class="Function">let-cong-1</a> <a id="5952" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="5957" class="Symbol">=</a> <a id="5959" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a>
<a id="5964" href="/lia/part5/AExp/#5850" class="Function">let-cong-1</a> <a id="5975" class="Symbol">(</a><a id="5976" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5980" href="/lia/part5/AExp/#5980" class="Bound">x</a> <a id="5982" href="/lia/part5/AExp/#5982" class="Bound">d</a><a id="5983" class="Symbol">)</a> <a id="5985" class="Symbol">=</a> <a id="5987" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="5991" class="Symbol">(</a><a id="5992" href="/lia/part5/AExp/#2695" class="InductiveConstructor">↝-Let-2</a> <a id="6000" href="/lia/part5/AExp/#5980" class="Bound">x</a><a id="6001" class="Symbol">)</a> <a id="6003" class="Symbol">(</a><a id="6004" href="/lia/part5/AExp/#5850" class="Function">let-cong-1</a> <a id="6015" href="/lia/part5/AExp/#5982" class="Bound">d</a><a id="6016" class="Symbol">)</a>

<a id="let-cong-2"></a><a id="6019" href="/lia/part5/AExp/#6019" class="Function">let-cong-2</a> <a id="6030" class="Symbol">:</a>
  <a id="6034" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="6036" href="/lia/part0/Functions/#568" class="Function Operator">[</a> <a id="6038" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="6040" href="/lia/part0/Functions/#568" class="Function Operator">↦</a> <a id="6042" href="/lia/part5/AExp/#923" class="Generalizable">m</a> <a id="6044" href="/lia/part0/Functions/#568" class="Function Operator">]</a> <a id="6046" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6048" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="6050" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6053" href="/lia/part5/AExp/#907" class="Generalizable">f′</a> <a id="6056" class="Symbol">→</a>
  <a id="6060" class="Comment">-----------------------------------</a>
  <a id="6098" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="6100" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6102" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="6106" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="6108" class="Symbol">(</a><a id="6109" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="6111" href="/lia/part5/AExp/#923" class="Generalizable">m</a><a id="6112" class="Symbol">)</a> <a id="6114" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="6116" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6119" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="6123" href="/lia/part5/AExp/#539" class="Generalizable">x</a> <a id="6125" class="Symbol">(</a><a id="6126" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="6128" href="/lia/part5/AExp/#923" class="Generalizable">m</a><a id="6129" class="Symbol">)</a> <a id="6131" href="/lia/part5/AExp/#907" class="Generalizable">f′</a>

<a id="6135" href="/lia/part5/AExp/#6019" class="Function">let-cong-2</a> <a id="6146" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="6151" class="Symbol">=</a> <a id="6153" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a>
<a id="6158" href="/lia/part5/AExp/#6019" class="Function">let-cong-2</a> <a id="6169" class="Symbol">(</a><a id="6170" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="6174" href="/lia/part5/AExp/#6174" class="Bound">x</a> <a id="6176" href="/lia/part5/AExp/#6176" class="Bound">d</a><a id="6177" class="Symbol">)</a> <a id="6179" class="Symbol">=</a> <a id="6181" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="6185" class="Symbol">(</a><a id="6186" href="/lia/part5/AExp/#2577" class="InductiveConstructor">↝-Let-1</a> <a id="6194" href="/lia/part5/AExp/#6174" class="Bound">x</a><a id="6195" class="Symbol">)</a> <a id="6197" class="Symbol">(</a><a id="6198" href="/lia/part5/AExp/#6019" class="Function">let-cong-2</a> <a id="6209" href="/lia/part5/AExp/#6176" class="Bound">d</a><a id="6210" class="Symbol">)</a></pre>

<h2 id="relational-reasoning">
<a class="anchor" href="#relational-reasoning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Relational reasoning</h2>

<p>We introduce some syntactic sugaring to conveniently write chains of
small steps.</p>

<pre class="Agda"><a id="6329" class="Keyword">infixr</a> <a id="6336" class="Number">2</a> <a id="6338" href="/lia/part5/AExp/#6376" class="Function Operator">_↝*⟨⟩_</a> <a id="6345" href="/lia/part5/AExp/#6443" class="Function Operator">_↝*⟨_⟩_</a> <a id="6353" href="/lia/part5/AExp/#6546" class="Function Operator">_↝⟨_⟩_</a> 
<a id="6361" class="Keyword">infix</a>  <a id="6368" class="Number">3</a> <a id="6370" href="/lia/part5/AExp/#6653" class="Function Operator">_↝*∎</a>

<a id="_↝*⟨⟩_"></a><a id="6376" href="/lia/part5/AExp/#6376" class="Function Operator">_↝*⟨⟩_</a> <a id="6383" class="Symbol">:</a> <a id="6385" class="Symbol">∀</a> <a id="6387" class="Symbol">{</a><a id="6388" href="/lia/part5/AExp/#6388" class="Bound">ρ</a><a id="6389" class="Symbol">}</a> <a id="6391" href="/lia/part5/AExp/#6391" class="Bound">e</a> <a id="6393" class="Symbol">{</a><a id="6394" href="/lia/part5/AExp/#6394" class="Bound">f</a><a id="6395" class="Symbol">}</a> <a id="6397" class="Symbol">→</a> <a id="6399" href="/lia/part5/AExp/#6388" class="Bound">ρ</a> <a id="6401" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6403" href="/lia/part5/AExp/#6391" class="Bound">e</a> <a id="6405" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6408" href="/lia/part5/AExp/#6394" class="Bound">f</a> <a id="6410" class="Symbol">→</a> <a id="6412" href="/lia/part5/AExp/#6388" class="Bound">ρ</a> <a id="6414" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6416" href="/lia/part5/AExp/#6391" class="Bound">e</a> <a id="6418" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6421" href="/lia/part5/AExp/#6394" class="Bound">f</a>
<a id="6423" href="/lia/part5/AExp/#6423" class="Bound">e</a> <a id="6425" href="/lia/part5/AExp/#6376" class="Function Operator">↝*⟨⟩</a> <a id="6430" href="/lia/part5/AExp/#6430" class="Bound">e↝*f</a> <a id="6435" class="Symbol">=</a> <a id="6437" href="/lia/part5/AExp/#6430" class="Bound">e↝*f</a>

<a id="_↝*⟨_⟩_"></a><a id="6443" href="/lia/part5/AExp/#6443" class="Function Operator">_↝*⟨_⟩_</a> <a id="6451" class="Symbol">:</a> <a id="6453" class="Symbol">∀</a> <a id="6455" class="Symbol">{</a><a id="6456" href="/lia/part5/AExp/#6456" class="Bound">ρ</a><a id="6457" class="Symbol">}</a> <a id="6459" href="/lia/part5/AExp/#6459" class="Bound">e</a> <a id="6461" class="Symbol">{</a><a id="6462" href="/lia/part5/AExp/#6462" class="Bound">f</a> <a id="6464" href="/lia/part5/AExp/#6464" class="Bound">g</a><a id="6465" class="Symbol">}</a> <a id="6467" class="Symbol">→</a> <a id="6469" href="/lia/part5/AExp/#6456" class="Bound">ρ</a> <a id="6471" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6473" href="/lia/part5/AExp/#6459" class="Bound">e</a> <a id="6475" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6478" href="/lia/part5/AExp/#6462" class="Bound">f</a> <a id="6480" class="Symbol">→</a> <a id="6482" href="/lia/part5/AExp/#6456" class="Bound">ρ</a> <a id="6484" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6486" href="/lia/part5/AExp/#6462" class="Bound">f</a> <a id="6488" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6491" href="/lia/part5/AExp/#6464" class="Bound">g</a> <a id="6493" class="Symbol">→</a> <a id="6495" href="/lia/part5/AExp/#6456" class="Bound">ρ</a> <a id="6497" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6499" href="/lia/part5/AExp/#6459" class="Bound">e</a> <a id="6501" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6504" href="/lia/part5/AExp/#6464" class="Bound">g</a>
<a id="6506" href="/lia/part5/AExp/#6506" class="Bound">e</a> <a id="6508" href="/lia/part5/AExp/#6443" class="Function Operator">↝*⟨</a> <a id="6512" href="/lia/part5/AExp/#6512" class="Bound">e↝*f</a> <a id="6517" href="/lia/part5/AExp/#6443" class="Function Operator">⟩</a> <a id="6519" href="/lia/part5/AExp/#6519" class="Bound">f↝*g</a> <a id="6524" class="Symbol">=</a> <a id="6526" href="/lia/part5/AExp/#3728" class="Function">↝*-trans</a> <a id="6535" href="/lia/part5/AExp/#6512" class="Bound">e↝*f</a> <a id="6540" href="/lia/part5/AExp/#6519" class="Bound">f↝*g</a>

<a id="_↝⟨_⟩_"></a><a id="6546" href="/lia/part5/AExp/#6546" class="Function Operator">_↝⟨_⟩_</a> <a id="6553" class="Symbol">:</a> <a id="6555" class="Symbol">∀</a> <a id="6557" class="Symbol">{</a><a id="6558" href="/lia/part5/AExp/#6558" class="Bound">ρ</a><a id="6559" class="Symbol">}</a> <a id="6561" href="/lia/part5/AExp/#6561" class="Bound">e</a> <a id="6563" class="Symbol">{</a><a id="6564" href="/lia/part5/AExp/#6564" class="Bound">f</a> <a id="6566" href="/lia/part5/AExp/#6566" class="Bound">g</a><a id="6567" class="Symbol">}</a> <a id="6569" class="Symbol">→</a> <a id="6571" href="/lia/part5/AExp/#6558" class="Bound">ρ</a> <a id="6573" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="6575" href="/lia/part5/AExp/#6561" class="Bound">e</a> <a id="6577" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="6579" href="/lia/part5/AExp/#6564" class="Bound">f</a> <a id="6581" class="Symbol">→</a> <a id="6583" href="/lia/part5/AExp/#6558" class="Bound">ρ</a> <a id="6585" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6587" href="/lia/part5/AExp/#6564" class="Bound">f</a> <a id="6589" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6592" href="/lia/part5/AExp/#6566" class="Bound">g</a> <a id="6594" class="Symbol">→</a> <a id="6596" href="/lia/part5/AExp/#6558" class="Bound">ρ</a> <a id="6598" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6600" href="/lia/part5/AExp/#6561" class="Bound">e</a> <a id="6602" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6605" href="/lia/part5/AExp/#6566" class="Bound">g</a>
<a id="6607" href="/lia/part5/AExp/#6607" class="Bound">e</a> <a id="6609" href="/lia/part5/AExp/#6546" class="Function Operator">↝⟨</a> <a id="6612" href="/lia/part5/AExp/#6612" class="Bound">e↝f</a> <a id="6616" href="/lia/part5/AExp/#6546" class="Function Operator">⟩</a> <a id="6618" href="/lia/part5/AExp/#6618" class="Bound">f↝*g</a> <a id="6623" class="Symbol">=</a> <a id="6625" href="/lia/part5/AExp/#6607" class="Bound">e</a> <a id="6627" href="/lia/part5/AExp/#6443" class="Function Operator">↝*⟨</a> <a id="6631" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="6635" href="/lia/part5/AExp/#6612" class="Bound">e↝f</a> <a id="6639" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a> <a id="6644" href="/lia/part5/AExp/#6443" class="Function Operator">⟩</a> <a id="6646" href="/lia/part5/AExp/#6618" class="Bound">f↝*g</a> 

<a id="_↝*∎"></a><a id="6653" href="/lia/part5/AExp/#6653" class="Function Operator">_↝*∎</a> <a id="6658" class="Symbol">:</a> <a id="6660" class="Symbol">∀</a> <a id="6662" href="/lia/part5/AExp/#6662" class="Bound">e</a> <a id="6664" class="Symbol">→</a> <a id="6666" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="6668" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="6670" href="/lia/part5/AExp/#6662" class="Bound">e</a> <a id="6672" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="6675" href="/lia/part5/AExp/#6662" class="Bound">e</a>
<a id="6677" href="/lia/part5/AExp/#6677" class="Bound">e</a> <a id="6679" href="/lia/part5/AExp/#6653" class="Function Operator">↝*∎</a> <a id="6683" class="Symbol">=</a> <a id="6685" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a></pre>

<h2 id="exercise-termination-weak-normalisation">
<a class="anchor" href="#exercise-termination-weak-normalisation" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Exercise</strong>: Termination (Weak normalisation)</h2>

<p>So far we have shown that the small-step semantics produces the right
result, <em>if it produces any result at all</em>. In fact, an operational
semantics that never reaches a Numerical value trivially satisfies this
condition.</p>

<p>We prove that the small step operational semantics can always reache
some numerical value after a finite number of steps. In other word, we
prove below that the rewrite is <em>weakly normalising</em>.</p>

<pre class="Agda"><a id="weak-normalisation"></a><a id="7167" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7186" class="Symbol">:</a> <a id="7188" class="Symbol">∀</a> <a id="7190" href="/lia/part5/AExp/#7190" class="Bound">e</a> <a id="7192" class="Symbol">→</a> <a id="7194" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="7196" href="/lia/part5/AExp/#3494" class="Datatype Operator">⊢</a> <a id="7198" href="/lia/part5/AExp/#7190" class="Bound">e</a> <a id="7200" href="/lia/part5/AExp/#3494" class="Datatype Operator">↝*</a> <a id="7203" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7205" class="Symbol">(</a><a id="7206" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7208" href="/lia/part5/AExp/#7190" class="Bound">e</a> <a id="7210" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7212" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a><a id="7213" class="Symbol">)</a>

<a id="7216" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7235" class="Symbol">(</a><a id="7236" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7238" href="/lia/part5/AExp/#7238" class="Bound">n</a><a id="7239" class="Symbol">)</a> <a id="7241" class="Symbol">=</a> <a id="7243" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a>

<a id="7249" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7268" class="Symbol">(</a><a id="7269" href="/lia/part5/AExp/#1162" class="InductiveConstructor Operator">`</a> <a id="7271" href="/lia/part5/AExp/#7271" class="Bound">x</a><a id="7272" class="Symbol">)</a> <a id="7274" class="Symbol">=</a> <a id="7276" href="/lia/part5/AExp/#3561" class="InductiveConstructor">one</a> <a id="7280" href="/lia/part5/AExp/#2090" class="InductiveConstructor">↝-Var</a> <a id="7286" href="/lia/part5/AExp/#3538" class="InductiveConstructor">stop</a>

<a id="7292" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7311" class="Symbol">{</a><a id="7312" href="/lia/part5/AExp/#7312" class="Bound">ρ</a><a id="7313" class="Symbol">}</a> <a id="7315" class="Symbol">(</a><a id="7316" href="/lia/part5/AExp/#7316" class="Bound">e</a> <a id="7318" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="7320" href="/lia/part5/AExp/#7320" class="Bound">f</a><a id="7321" class="Symbol">)</a>
  <a id="7325" class="Keyword">with</a> <a id="7330" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7349" href="/lia/part5/AExp/#7316" class="Bound">e</a> <a id="7351" class="Symbol">|</a> <a id="7353" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7372" href="/lia/part5/AExp/#7320" class="Bound">f</a>
<a id="7374" class="Symbol">...</a> <a id="7378" class="Symbol">|</a> <a id="7380" href="/lia/part5/AExp/#7380" class="Bound">de</a> <a id="7383" class="Symbol">|</a> <a id="7385" href="/lia/part5/AExp/#7385" class="Bound">df</a> <a id="7388" class="Symbol">=</a> 
  <a id="7393" class="Bound">e</a> <a id="7395" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="7397" class="Bound">f</a> <a id="7399" href="/lia/part5/AExp/#6443" class="Function Operator">↝*⟨</a> <a id="7403" href="/lia/part5/AExp/#5228" class="Function">add-cong-1</a> <a id="7414" href="/lia/part5/AExp/#7380" class="Bound">de</a> <a id="7417" href="/lia/part5/AExp/#6443" class="Function Operator">⟩</a>
  <a id="7421" class="Symbol">(</a><a id="7422" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7424" class="Symbol">(</a><a id="7425" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7427" class="Bound">e</a> <a id="7429" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7431" class="Bound">ρ</a><a id="7432" class="Symbol">))</a> <a id="7435" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="7437" class="Bound">f</a> <a id="7439" href="/lia/part5/AExp/#6443" class="Function Operator">↝*⟨</a> <a id="7443" href="/lia/part5/AExp/#5383" class="Function">add-cong-2</a> <a id="7454" href="/lia/part5/AExp/#7385" class="Bound">df</a> <a id="7457" href="/lia/part5/AExp/#6443" class="Function Operator">⟩</a>
  <a id="7461" class="Symbol">(</a><a id="7462" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7464" class="Symbol">(</a><a id="7465" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7467" class="Bound">e</a> <a id="7469" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7471" class="Bound">ρ</a><a id="7472" class="Symbol">))</a> <a id="7475" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="7477" class="Symbol">(</a><a id="7478" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7480" class="Symbol">(</a><a id="7481" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7483" class="Bound">f</a> <a id="7485" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7487" class="Bound">ρ</a><a id="7488" class="Symbol">))</a> <a id="7491" href="/lia/part5/AExp/#6546" class="Function Operator">↝⟨</a> <a id="7494" href="/lia/part5/AExp/#2117" class="InductiveConstructor">↝-Add-stop</a> <a id="7505" href="/lia/part5/AExp/#6546" class="Function Operator">⟩</a>
  <a id="7509" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7511" class="Symbol">(</a><a id="7512" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7514" class="Bound">e</a> <a id="7516" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7518" class="Bound">ρ</a> <a id="7520" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="7523" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7525" class="Bound">f</a> <a id="7527" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7529" class="Bound">ρ</a><a id="7530" class="Symbol">)</a>
  <a id="7534" href="/lia/part5/AExp/#6653" class="Function Operator">↝*∎</a>

<a id="7539" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7558" class="Symbol">{</a><a id="7559" href="/lia/part5/AExp/#7559" class="Bound">ρ</a><a id="7560" class="Symbol">}</a> <a id="7562" class="Symbol">(</a><a id="7563" href="/lia/part5/AExp/#7563" class="Bound">e</a> <a id="7565" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="7567" href="/lia/part5/AExp/#7567" class="Bound">f</a><a id="7568" class="Symbol">)</a>
  <a id="7572" class="Keyword">with</a> <a id="7577" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7596" href="/lia/part5/AExp/#7563" class="Bound">e</a> <a id="7598" class="Symbol">|</a> <a id="7600" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7619" href="/lia/part5/AExp/#7567" class="Bound">f</a>
<a id="7621" class="Symbol">...</a> <a id="7625" class="Symbol">|</a> <a id="7627" href="/lia/part5/AExp/#7627" class="Bound">de</a> <a id="7630" class="Symbol">|</a> <a id="7632" href="/lia/part5/AExp/#7632" class="Bound">df</a> <a id="7635" class="Symbol">=</a> 
  <a id="7640" class="Bound">e</a> <a id="7642" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="7644" class="Bound">f</a> <a id="7646" href="/lia/part5/AExp/#6443" class="Function Operator">↝*⟨</a> <a id="7650" href="/lia/part5/AExp/#5539" class="Function">mul-cong-1</a> <a id="7661" href="/lia/part5/AExp/#7627" class="Bound">de</a> <a id="7664" href="/lia/part5/AExp/#6443" class="Function Operator">⟩</a>
  <a id="7668" class="Symbol">(</a><a id="7669" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7671" class="Symbol">(</a><a id="7672" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7674" class="Bound">e</a> <a id="7676" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7678" class="Bound">ρ</a><a id="7679" class="Symbol">))</a> <a id="7682" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="7684" class="Bound">f</a> <a id="7686" href="/lia/part5/AExp/#6443" class="Function Operator">↝*⟨</a> <a id="7690" href="/lia/part5/AExp/#5694" class="Function">mul-cong-2</a> <a id="7701" href="/lia/part5/AExp/#7632" class="Bound">df</a> <a id="7704" href="/lia/part5/AExp/#6443" class="Function Operator">⟩</a>
  <a id="7708" class="Symbol">(</a><a id="7709" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7711" class="Symbol">(</a><a id="7712" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7714" class="Bound">e</a> <a id="7716" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7718" class="Bound">ρ</a><a id="7719" class="Symbol">))</a> <a id="7722" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="7724" class="Symbol">(</a><a id="7725" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7727" class="Symbol">(</a><a id="7728" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7730" class="Bound">f</a> <a id="7732" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7734" class="Bound">ρ</a><a id="7735" class="Symbol">))</a> <a id="7738" href="/lia/part5/AExp/#6546" class="Function Operator">↝⟨</a> <a id="7741" href="/lia/part5/AExp/#2323" class="InductiveConstructor">↝-Mul-stop</a> <a id="7752" href="/lia/part5/AExp/#6546" class="Function Operator">⟩</a>
  <a id="7756" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7758" class="Symbol">(</a><a id="7759" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7761" class="Bound">e</a> <a id="7763" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7765" class="Bound">ρ</a> <a id="7767" href="/lia/part5/AExp/#179" class="Function Operator">·ℕ</a> <a id="7770" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7772" class="Bound">f</a> <a id="7774" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7776" class="Bound">ρ</a><a id="7777" class="Symbol">)</a>
  <a id="7781" href="/lia/part5/AExp/#6653" class="Function Operator">↝*∎</a>

<a id="7786" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7805" class="Symbol">{</a><a id="7806" href="/lia/part5/AExp/#7806" class="Bound">ρ</a><a id="7807" class="Symbol">}</a> <a id="7809" class="Symbol">(</a><a id="7810" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="7814" href="/lia/part5/AExp/#7814" class="Bound">x</a> <a id="7816" href="/lia/part5/AExp/#7816" class="Bound">e</a> <a id="7818" href="/lia/part5/AExp/#7818" class="Bound">f</a><a id="7819" class="Symbol">)</a>
  <a id="7823" class="Keyword">with</a> <a id="7828" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7847" href="/lia/part5/AExp/#7816" class="Bound">e</a> <a id="7849" class="Symbol">|</a> <a id="7851" href="/lia/part5/AExp/#7167" class="Function">weak-normalisation</a> <a id="7870" href="/lia/part5/AExp/#7818" class="Bound">f</a>
<a id="7872" class="Symbol">...</a> <a id="7876" class="Symbol">|</a> <a id="7878" href="/lia/part5/AExp/#7878" class="Bound">de</a> <a id="7881" class="Symbol">|</a> <a id="7883" href="/lia/part5/AExp/#7883" class="Bound">df</a> <a id="7886" class="Symbol">=</a>
    <a id="7892" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="7896" class="Bound">x</a> <a id="7898" class="Bound">e</a> <a id="7900" class="Bound">f</a> <a id="7902" href="/lia/part5/AExp/#6443" class="Function Operator">↝*⟨</a> <a id="7906" href="/lia/part5/AExp/#5850" class="Function">let-cong-1</a> <a id="7917" href="/lia/part5/AExp/#7878" class="Bound">de</a> <a id="7920" href="/lia/part5/AExp/#6443" class="Function Operator">⟩</a>
    <a id="7926" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="7930" class="Bound">x</a> <a id="7932" class="Symbol">(</a><a id="7933" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7935" class="Symbol">(</a><a id="7936" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7938" class="Bound">e</a> <a id="7940" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7942" class="Bound">ρ</a><a id="7943" class="Symbol">))</a> <a id="7946" class="Bound">f</a> <a id="7948" href="/lia/part5/AExp/#6443" class="Function Operator">↝*⟨</a> <a id="7952" href="/lia/part5/AExp/#6019" class="Function">let-cong-2</a> <a id="7963" href="/lia/part5/AExp/#7883" class="Bound">df</a> <a id="7966" href="/lia/part5/AExp/#6443" class="Function Operator">⟩</a>
    <a id="7972" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="7976" class="Bound">x</a> <a id="7978" class="Symbol">(</a><a id="7979" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7981" class="Symbol">(</a><a id="7982" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7984" class="Bound">e</a> <a id="7986" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="7988" class="Bound">ρ</a><a id="7989" class="Symbol">))</a> <a id="7992" class="Symbol">(</a><a id="7993" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="7995" class="Symbol">(</a><a id="7996" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="7998" class="Bound">f</a> <a id="8000" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="8002" class="Symbol">(</a><a id="8003" class="Bound">ρ</a> <a id="8005" href="/lia/part0/Functions/#568" class="Function Operator">[</a> <a id="8007" class="Bound">x</a> <a id="8009" href="/lia/part0/Functions/#568" class="Function Operator">↦</a> <a id="8011" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="8013" class="Bound">e</a> <a id="8015" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="8017" class="Bound">ρ</a> <a id="8019" href="/lia/part0/Functions/#568" class="Function Operator">]</a><a id="8020" class="Symbol">)))</a>
        <a id="8032" href="/lia/part5/AExp/#6546" class="Function Operator">↝⟨</a> <a id="8035" href="/lia/part5/AExp/#2529" class="InductiveConstructor">↝-Let-stop</a> <a id="8046" href="/lia/part5/AExp/#6546" class="Function Operator">⟩</a>
    <a id="8052" href="/lia/part5/AExp/#1141" class="InductiveConstructor Operator">$</a> <a id="8054" class="Symbol">(</a><a id="8055" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="8057" class="Bound">f</a> <a id="8059" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="8061" class="Symbol">(</a><a id="8062" class="Bound">ρ</a> <a id="8064" href="/lia/part0/Functions/#568" class="Function Operator">[</a> <a id="8066" class="Bound">x</a> <a id="8068" href="/lia/part0/Functions/#568" class="Function Operator">↦</a> <a id="8070" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="8072" class="Bound">e</a> <a id="8074" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="8076" class="Bound">ρ</a> <a id="8078" href="/lia/part0/Functions/#568" class="Function Operator">]</a><a id="8079" class="Symbol">))</a>
    <a id="8086" href="/lia/part5/AExp/#6653" class="Function Operator">↝*∎</a></pre>

<h2 id="exercise-strong-normalisation">
<a class="anchor" href="#exercise-strong-normalisation" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Exercise</strong>: Strong normalisation</h2>

<p>The termination property above is also called <em>weak normalisation</em>,
which means that there exists a finite reduction sequence <code class="language-plaintext highlighter-rouge">e ↝* f</code>
reaching a normal form (i.e. a value) <code class="language-plaintext highlighter-rouge">f ≡ Num m</code>. We show below even
<em>strong normalisation</em>, namely, <em>every</em> reduction sequence starting from
<code class="language-plaintext highlighter-rouge">e</code> is finite.</p>

<p>To this end, we introduce a notion of <em>size</em> of arithmetic expressions.</p>

<pre class="Agda"><a id="size"></a><a id="8505" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8510" class="Symbol">:</a> <a id="8512" href="/lia/part5/AExp/#709" class="Datatype">AExp</a> <a id="8517" class="Symbol">→</a> <a id="8519" href="/lia/part0/Naturals/#247" class="Function">ℕ</a>
<a id="8521" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8526" class="Symbol">(</a><a id="8527" href="/lia/part5/AExp/#728" class="InductiveConstructor">Num</a> <a id="8531" href="/lia/part5/AExp/#8531" class="Bound">x</a><a id="8532" class="Symbol">)</a> <a id="8534" class="Symbol">=</a> <a id="8536" class="Number">0</a>
<a id="8538" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8543" class="Symbol">(</a><a id="8544" href="/lia/part5/AExp/#751" class="InductiveConstructor">Var</a> <a id="8548" href="/lia/part5/AExp/#8548" class="Bound">x</a><a id="8549" class="Symbol">)</a> <a id="8551" class="Symbol">=</a> <a id="8553" class="Number">1</a>
<a id="8555" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8560" class="Symbol">(</a><a id="8561" href="/lia/part5/AExp/#780" class="InductiveConstructor">Add</a> <a id="8565" href="/lia/part5/AExp/#8565" class="Bound">e</a> <a id="8567" href="/lia/part5/AExp/#8567" class="Bound">f</a><a id="8568" class="Symbol">)</a> <a id="8570" class="Symbol">=</a> <a id="8572" class="Number">1</a> <a id="8574" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="8577" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8582" href="/lia/part5/AExp/#8565" class="Bound">e</a> <a id="8584" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="8587" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8592" href="/lia/part5/AExp/#8567" class="Bound">f</a>
<a id="8594" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8599" class="Symbol">(</a><a id="8600" href="/lia/part5/AExp/#808" class="InductiveConstructor">Mul</a> <a id="8604" href="/lia/part5/AExp/#8604" class="Bound">e</a> <a id="8606" href="/lia/part5/AExp/#8606" class="Bound">f</a><a id="8607" class="Symbol">)</a> <a id="8609" class="Symbol">=</a> <a id="8611" class="Number">1</a> <a id="8613" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="8616" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8621" href="/lia/part5/AExp/#8604" class="Bound">e</a> <a id="8623" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="8626" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8631" href="/lia/part5/AExp/#8606" class="Bound">f</a>
<a id="8633" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8638" class="Symbol">(</a><a id="8639" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="8643" href="/lia/part5/AExp/#8643" class="Bound">x</a> <a id="8645" href="/lia/part5/AExp/#8645" class="Bound">e</a> <a id="8647" href="/lia/part5/AExp/#8647" class="Bound">f</a><a id="8648" class="Symbol">)</a> <a id="8650" class="Symbol">=</a> <a id="8652" class="Number">1</a> <a id="8654" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="8657" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8662" href="/lia/part5/AExp/#8645" class="Bound">e</a> <a id="8664" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="8667" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8672" href="/lia/part5/AExp/#8647" class="Bound">f</a></pre>

<p>In the lemma below we show that the size of an expression strictly
decreases at each step, which implies strong normalisation.</p>

<pre class="Agda"><a id="size-down"></a><a id="8811" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="8821" class="Symbol">:</a>
  <a id="8825" href="/lia/part5/AExp/#1406" class="Generalizable">ρ</a> <a id="8827" href="/lia/part5/AExp/#2049" class="Datatype Operator">⊢</a> <a id="8829" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="8831" href="/lia/part5/AExp/#2049" class="Datatype Operator">↝</a> <a id="8833" href="/lia/part5/AExp/#905" class="Generalizable">f</a> <a id="8835" class="Symbol">→</a>
  <a id="8839" class="Comment">---------------</a>
  <a id="8857" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8862" href="/lia/part5/AExp/#900" class="Generalizable">e</a> <a id="8864" href="/lia/part0/Naturals/#1265" class="Function Operator">&gt;</a> <a id="8866" href="/lia/part5/AExp/#8505" class="Function">size</a> <a id="8871" href="/lia/part5/AExp/#905" class="Generalizable">f</a>
  
<a id="8876" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="8886" href="/lia/part5/AExp/#2090" class="InductiveConstructor">↝-Var</a> <a id="8892" class="Symbol">=</a> <a id="8894" href="/lia/part0/Naturals/#801" class="InductiveConstructor">s≤s</a> <a id="8898" href="/lia/part0/Naturals/#772" class="InductiveConstructor">0≤n</a>

<a id="8903" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="8913" href="/lia/part5/AExp/#2117" class="InductiveConstructor">↝-Add-stop</a> <a id="8924" class="Symbol">=</a> <a id="8926" href="/lia/part0/Naturals/#801" class="InductiveConstructor">s≤s</a> <a id="8930" href="/lia/part0/Naturals/#772" class="InductiveConstructor">0≤n</a>
<a id="8934" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="8944" class="Symbol">(</a><a id="8945" href="/lia/part5/AExp/#2164" class="InductiveConstructor">↝-Add-left</a> <a id="8956" href="/lia/part5/AExp/#8956" class="Bound">de</a><a id="8958" class="Symbol">)</a> <a id="8960" class="Symbol">=</a> <a id="8962" class="Symbol">{!   !}</a> <a id="8970" class="Comment">-- s≤s (≤-+-cong-1 (size-down de))</a>
<a id="9005" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9015" class="Symbol">{</a><a id="9016" href="/lia/part5/AExp/#9016" class="Bound">ρ</a><a id="9017" class="Symbol">}</a> <a id="9019" class="Symbol">{</a><a id="9020" href="/lia/part5/AExp/#9020" class="Bound">e</a> <a id="9022" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="9024" href="/lia/part5/AExp/#9024" class="Bound">f</a><a id="9025" class="Symbol">}</a> <a id="9027" class="Symbol">{</a><a id="9028" href="/lia/part5/AExp/#9020" class="Bound">e</a> <a id="9030" href="/lia/part5/AExp/#1183" class="InductiveConstructor Operator">+</a> <a id="9032" href="/lia/part5/AExp/#9032" class="Bound">f′</a><a id="9034" class="Symbol">}</a> <a id="9036" class="Symbol">(</a><a id="9037" href="/lia/part5/AExp/#2243" class="InductiveConstructor">↝-Add-right</a> <a id="9049" href="/lia/part5/AExp/#9049" class="Bound">de</a><a id="9051" class="Symbol">)</a>
  <a id="9055" class="Keyword">with</a> <a id="9060" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9070" href="/lia/part5/AExp/#9049" class="Bound">de</a> <a id="9073" class="Comment">-- | suc-lemma (size e) (size f′)</a>
<a id="9107" class="Symbol">...</a> <a id="9111" class="Symbol">|</a> <a id="9113" href="/lia/part5/AExp/#9113" class="Bound">e&gt;f</a> <a id="9117" class="Symbol">=</a> <a id="9119" class="Symbol">{!   !}</a> <a id="9127" class="Comment">-- s≤s (subst (_≤ size e + size f) (sym p) {! ≤-+-cong-2 e&gt;f !})</a>

<a id="9193" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9203" href="/lia/part5/AExp/#2323" class="InductiveConstructor">↝-Mul-stop</a> <a id="9214" class="Symbol">=</a> <a id="9216" href="/lia/part0/Naturals/#801" class="InductiveConstructor">s≤s</a> <a id="9220" href="/lia/part0/Naturals/#772" class="InductiveConstructor">0≤n</a>
<a id="9224" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9234" class="Symbol">(</a><a id="9235" href="/lia/part5/AExp/#2370" class="InductiveConstructor">↝-Mul-left</a> <a id="9246" href="/lia/part5/AExp/#9246" class="Bound">δ</a><a id="9247" class="Symbol">)</a> <a id="9249" class="Symbol">=</a> <a id="9251" class="Symbol">{!   !}</a> <a id="9259" class="Comment">-- s≤s (≤-+-cong-1 (size-down de))</a>
<a id="9294" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9304" class="Symbol">{</a><a id="9305" href="/lia/part5/AExp/#9305" class="Bound">ρ</a><a id="9306" class="Symbol">}</a> <a id="9308" class="Symbol">{</a><a id="9309" href="/lia/part5/AExp/#9309" class="Bound">e</a> <a id="9311" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="9313" href="/lia/part5/AExp/#9313" class="Bound">f</a><a id="9314" class="Symbol">}</a> <a id="9316" class="Symbol">{</a><a id="9317" href="/lia/part5/AExp/#9309" class="Bound">e</a> <a id="9319" href="/lia/part5/AExp/#1209" class="InductiveConstructor Operator">·</a> <a id="9321" href="/lia/part5/AExp/#9321" class="Bound">f′</a><a id="9323" class="Symbol">}</a> <a id="9325" class="Symbol">(</a><a id="9326" href="/lia/part5/AExp/#2449" class="InductiveConstructor">↝-Mul-right</a> <a id="9338" href="/lia/part5/AExp/#9338" class="Bound">δ</a><a id="9339" class="Symbol">)</a>
  <a id="9343" class="Keyword">with</a> <a id="9348" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9358" href="/lia/part5/AExp/#9338" class="Bound">δ</a> 
<a id="9361" class="Symbol">...</a> <a id="9365" class="Symbol">|</a> <a id="9367" href="/lia/part5/AExp/#9367" class="Bound">e&gt;f</a> <a id="9371" class="Symbol">=</a> <a id="9373" class="Symbol">{!   !}</a>

<a id="9382" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9392" href="/lia/part5/AExp/#2529" class="InductiveConstructor">↝-Let-stop</a> <a id="9403" class="Symbol">=</a> <a id="9405" href="/lia/part0/Naturals/#801" class="InductiveConstructor">s≤s</a> <a id="9409" href="/lia/part0/Naturals/#772" class="InductiveConstructor">0≤n</a>
<a id="9413" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9423" class="Symbol">(</a><a id="9424" href="/lia/part5/AExp/#2577" class="InductiveConstructor">↝-Let-1</a> <a id="9432" href="/lia/part5/AExp/#9432" class="Bound">de</a><a id="9434" class="Symbol">)</a> <a id="9436" class="Symbol">=</a> <a id="9438" href="/lia/part0/Naturals/#801" class="InductiveConstructor">s≤s</a> <a id="9442" class="Symbol">(</a><a id="9443" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9453" href="/lia/part5/AExp/#9432" class="Bound">de</a><a id="9455" class="Symbol">)</a>
<a id="9457" href="/lia/part5/AExp/#8811" class="Function">size-down</a> <a id="9467" class="Symbol">(</a><a id="9468" href="/lia/part5/AExp/#2695" class="InductiveConstructor">↝-Let-2</a> <a id="9476" href="/lia/part5/AExp/#9476" class="Bound">de</a><a id="9478" class="Symbol">)</a> <a id="9480" class="Symbol">=</a> <a id="9482" href="/lia/part0/Naturals/#801" class="InductiveConstructor">s≤s</a> <a id="9486" class="Symbol">{!   !}</a> <a id="9494" class="Comment">-- (≤-+-cong-1 (size-down de))</a></pre>

<h1 id="big-steps-operational-semantics">
<a class="anchor" href="#big-steps-operational-semantics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Big-steps operational semantics</h1>

<pre class="Agda"><a id="9569" class="Keyword">infix</a> <a id="9575" class="Number">4</a> <a id="9577" href="/lia/part5/AExp/#9588" class="Datatype Operator">_,_⇒_</a>
<a id="9583" class="Keyword">data</a> <a id="_,_⇒_"></a><a id="9588" href="/lia/part5/AExp/#9588" class="Datatype Operator">_,_⇒_</a> <a id="9594" class="Symbol">:</a> <a id="9596" href="/lia/part5/AExp/#709" class="Datatype">AExp</a> <a id="9601" class="Symbol">→</a> <a id="9603" href="/lia/part5/AExp/#1370" class="Function">Env</a> <a id="9607" class="Symbol">→</a> <a id="9609" href="/lia/part0/Naturals/#247" class="Function">ℕ</a> <a id="9611" class="Symbol">→</a> <a id="9613" class="PrimitiveType">Set</a> <a id="9617" class="Keyword">where</a>
  <a id="_,_⇒_.⇒-Num"></a><a id="9625" href="/lia/part5/AExp/#9625" class="InductiveConstructor">⇒-Num</a> <a id="9631" class="Symbol">:</a> <a id="9633" class="Symbol">∀</a> <a id="9635" class="Symbol">{</a><a id="9636" href="/lia/part5/AExp/#9636" class="Bound">n</a> <a id="9638" href="/lia/part5/AExp/#9638" class="Bound">ρ</a><a id="9639" class="Symbol">}</a> <a id="9641" class="Symbol">→</a> <a id="9643" href="/lia/part5/AExp/#728" class="InductiveConstructor">Num</a> <a id="9647" href="/lia/part5/AExp/#9636" class="Bound">n</a> <a id="9649" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9651" href="/lia/part5/AExp/#9638" class="Bound">ρ</a> <a id="9653" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9655" href="/lia/part5/AExp/#9636" class="Bound">n</a>
  <a id="_,_⇒_.⇒-Var"></a><a id="9659" href="/lia/part5/AExp/#9659" class="InductiveConstructor">⇒-Var</a> <a id="9665" class="Symbol">:</a> <a id="9667" class="Symbol">∀</a> <a id="9669" class="Symbol">{</a><a id="9670" href="/lia/part5/AExp/#9670" class="Bound">x</a> <a id="9672" href="/lia/part5/AExp/#9672" class="Bound">ρ</a><a id="9673" class="Symbol">}</a> <a id="9675" class="Symbol">→</a> <a id="9677" href="/lia/part5/AExp/#751" class="InductiveConstructor">Var</a> <a id="9681" href="/lia/part5/AExp/#9670" class="Bound">x</a> <a id="9683" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9685" href="/lia/part5/AExp/#9672" class="Bound">ρ</a> <a id="9687" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9689" href="/lia/part5/AExp/#9672" class="Bound">ρ</a> <a id="9691" href="/lia/part5/AExp/#9670" class="Bound">x</a>
  <a id="_,_⇒_.⇒-Add"></a><a id="9695" href="/lia/part5/AExp/#9695" class="InductiveConstructor">⇒-Add</a> <a id="9701" class="Symbol">:</a> <a id="9703" class="Symbol">∀</a> <a id="9705" class="Symbol">{</a><a id="9706" href="/lia/part5/AExp/#9706" class="Bound">e</a> <a id="9708" href="/lia/part5/AExp/#9708" class="Bound">f</a> <a id="9710" href="/lia/part5/AExp/#9710" class="Bound">m</a> <a id="9712" href="/lia/part5/AExp/#9712" class="Bound">n</a> <a id="9714" href="/lia/part5/AExp/#9714" class="Bound">ρ</a><a id="9715" class="Symbol">}</a> <a id="9717" class="Symbol">→</a> <a id="9719" href="/lia/part5/AExp/#9706" class="Bound">e</a> <a id="9721" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9723" href="/lia/part5/AExp/#9714" class="Bound">ρ</a> <a id="9725" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9727" href="/lia/part5/AExp/#9710" class="Bound">m</a> <a id="9729" class="Symbol">→</a> <a id="9731" href="/lia/part5/AExp/#9708" class="Bound">f</a> <a id="9733" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9735" href="/lia/part5/AExp/#9714" class="Bound">ρ</a> <a id="9737" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9739" href="/lia/part5/AExp/#9712" class="Bound">n</a> <a id="9741" class="Symbol">→</a> <a id="9743" href="/lia/part5/AExp/#780" class="InductiveConstructor">Add</a> <a id="9747" href="/lia/part5/AExp/#9706" class="Bound">e</a> <a id="9749" href="/lia/part5/AExp/#9708" class="Bound">f</a> <a id="9751" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9753" href="/lia/part5/AExp/#9714" class="Bound">ρ</a> <a id="9755" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9757" href="/lia/part5/AExp/#9710" class="Bound">m</a> <a id="9759" href="/lia/part5/AExp/#166" class="Function Operator">+ℕ</a> <a id="9762" href="/lia/part5/AExp/#9712" class="Bound">n</a>
  <a id="_,_⇒_.⇒-let"></a><a id="9766" href="/lia/part5/AExp/#9766" class="InductiveConstructor">⇒-let</a> <a id="9772" class="Symbol">:</a> <a id="9774" class="Symbol">∀</a> <a id="9776" class="Symbol">{</a><a id="9777" href="/lia/part5/AExp/#9777" class="Bound">x</a> <a id="9779" href="/lia/part5/AExp/#9779" class="Bound">e</a> <a id="9781" href="/lia/part5/AExp/#9781" class="Bound">f</a> <a id="9783" href="/lia/part5/AExp/#9783" class="Bound">m</a> <a id="9785" href="/lia/part5/AExp/#9785" class="Bound">n</a> <a id="9787" href="/lia/part5/AExp/#9787" class="Bound">ρ</a><a id="9788" class="Symbol">}</a> <a id="9790" class="Symbol">→</a> <a id="9792" href="/lia/part5/AExp/#9779" class="Bound">e</a> <a id="9794" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9796" href="/lia/part5/AExp/#9787" class="Bound">ρ</a> <a id="9798" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9800" href="/lia/part5/AExp/#9783" class="Bound">m</a> <a id="9802" class="Symbol">→</a> <a id="9804" href="/lia/part5/AExp/#9781" class="Bound">f</a> <a id="9806" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9808" href="/lia/part5/AExp/#9787" class="Bound">ρ</a> <a id="9810" href="/lia/part0/Functions/#568" class="Function Operator">[</a> <a id="9812" href="/lia/part5/AExp/#9777" class="Bound">x</a> <a id="9814" href="/lia/part0/Functions/#568" class="Function Operator">↦</a> <a id="9816" href="/lia/part5/AExp/#9783" class="Bound">m</a> <a id="9818" href="/lia/part0/Functions/#568" class="Function Operator">]</a> <a id="9820" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9822" href="/lia/part5/AExp/#9785" class="Bound">n</a>
         <a id="9833" class="Symbol">→</a> <a id="9835" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="9839" href="/lia/part5/AExp/#9777" class="Bound">x</a> <a id="9841" href="/lia/part5/AExp/#9779" class="Bound">e</a> <a id="9843" href="/lia/part5/AExp/#9781" class="Bound">f</a> <a id="9845" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9847" href="/lia/part5/AExp/#9787" class="Bound">ρ</a> <a id="9849" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9851" href="/lia/part5/AExp/#9785" class="Bound">n</a></pre>

<h2 id="evaluation-is-deterministic">
<a class="anchor" href="#evaluation-is-deterministic" aria-hidden="true"><span class="octicon octicon-link"></span></a>Evaluation is deterministic</h2>

<pre class="Agda"><a id="⇒-det"></a><a id="9894" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="9900" class="Symbol">:</a> <a id="9902" class="Symbol">∀</a> <a id="9904" class="Symbol">{</a><a id="9905" href="/lia/part5/AExp/#9905" class="Bound">e</a> <a id="9907" href="/lia/part5/AExp/#9907" class="Bound">ρ</a> <a id="9909" href="/lia/part5/AExp/#9909" class="Bound">m</a> <a id="9911" href="/lia/part5/AExp/#9911" class="Bound">n</a><a id="9912" class="Symbol">}</a> <a id="9914" class="Symbol">→</a> <a id="9916" href="/lia/part5/AExp/#9905" class="Bound">e</a> <a id="9918" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9920" href="/lia/part5/AExp/#9907" class="Bound">ρ</a> <a id="9922" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9924" href="/lia/part5/AExp/#9909" class="Bound">m</a> <a id="9926" class="Symbol">→</a> <a id="9928" href="/lia/part5/AExp/#9905" class="Bound">e</a> <a id="9930" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="9932" href="/lia/part5/AExp/#9907" class="Bound">ρ</a> <a id="9934" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="9936" href="/lia/part5/AExp/#9911" class="Bound">n</a> <a id="9938" class="Symbol">→</a> <a id="9940" href="/lia/part5/AExp/#9909" class="Bound">m</a> <a id="9942" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="9944" href="/lia/part5/AExp/#9911" class="Bound">n</a>
<a id="9946" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="9952" href="/lia/part5/AExp/#9625" class="InductiveConstructor">⇒-Num</a> <a id="9958" href="/lia/part5/AExp/#9625" class="InductiveConstructor">⇒-Num</a> <a id="9964" class="Symbol">=</a> <a id="9966" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="9971" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="9977" href="/lia/part5/AExp/#9659" class="InductiveConstructor">⇒-Var</a> <a id="9983" href="/lia/part5/AExp/#9659" class="InductiveConstructor">⇒-Var</a> <a id="9989" class="Symbol">=</a> <a id="9991" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="9996" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="10002" class="Symbol">(</a><a id="10003" href="/lia/part5/AExp/#9695" class="InductiveConstructor">⇒-Add</a> <a id="10009" href="/lia/part5/AExp/#10009" class="Bound">x</a> <a id="10011" href="/lia/part5/AExp/#10011" class="Bound">x₁</a><a id="10013" class="Symbol">)</a> <a id="10015" class="Symbol">(</a><a id="10016" href="/lia/part5/AExp/#9695" class="InductiveConstructor">⇒-Add</a> <a id="10022" href="/lia/part5/AExp/#10022" class="Bound">y</a> <a id="10024" href="/lia/part5/AExp/#10024" class="Bound">y₁</a><a id="10026" class="Symbol">)</a>
    <a id="10032" class="Keyword">with</a> <a id="10037" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="10043" href="/lia/part5/AExp/#10009" class="Bound">x</a> <a id="10045" href="/lia/part5/AExp/#10022" class="Bound">y</a> <a id="10047" class="Symbol">|</a> <a id="10049" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="10055" href="/lia/part5/AExp/#10011" class="Bound">x₁</a> <a id="10058" href="/lia/part5/AExp/#10024" class="Bound">y₁</a>
<a id="10061" class="Symbol">...</a> <a id="10065" class="Symbol">|</a> <a id="10067" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10072" class="Symbol">|</a> <a id="10074" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10079" class="Symbol">=</a> <a id="10081" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="10086" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="10092" class="Symbol">(</a><a id="10093" href="/lia/part5/AExp/#9766" class="InductiveConstructor">⇒-let</a> <a id="10099" href="/lia/part5/AExp/#10099" class="Bound">⇒₁-e</a> <a id="10104" href="/lia/part5/AExp/#10104" class="Bound">⇒₁-f</a><a id="10108" class="Symbol">)</a> <a id="10110" class="Symbol">(</a><a id="10111" href="/lia/part5/AExp/#9766" class="InductiveConstructor">⇒-let</a> <a id="10117" href="/lia/part5/AExp/#10117" class="Bound">⇒₂-e</a> <a id="10122" href="/lia/part5/AExp/#10122" class="Bound">⇒₂-f</a><a id="10126" class="Symbol">)</a>
    <a id="10132" class="Keyword">with</a> <a id="10137" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="10143" href="/lia/part5/AExp/#10099" class="Bound">⇒₁-e</a> <a id="10148" href="/lia/part5/AExp/#10117" class="Bound">⇒₂-e</a>
<a id="10153" class="Symbol">...</a> <a id="10157" class="Symbol">|</a> <a id="10159" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="10168" class="Keyword">with</a> <a id="10173" href="/lia/part5/AExp/#9894" class="Function">⇒-det</a> <a id="10179" class="Bound">⇒₁-f</a> <a id="10184" class="Bound">⇒₂-f</a>
<a id="10189" class="Symbol">...</a> <a id="10193" class="Symbol">|</a> <a id="10195" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="10200" class="Symbol">=</a> <a id="10202" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a></pre>

<p>Note that in the <code class="language-plaintext highlighter-rouge">⇒-let</code> case we cannot perform the two
with-abstractions in parallel because in order to apply the second one
<code class="language-plaintext highlighter-rouge">⇒-det ⇒₁-f ⇒₂-f</code> we need the result of the first one.</p>

<h2 id="agreement-of-the-semantics">
<a class="anchor" href="#agreement-of-the-semantics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Agreement of the semantics</h2>

<p>The following lemma shows that the big-steps operational semantics
agrees with the denotational semantics.</p>

<pre class="Agda"><a id="⇒-agree-⟦⟧"></a><a id="10538" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> <a id="10549" class="Symbol">:</a> <a id="10551" class="Symbol">∀</a> <a id="10553" class="Symbol">{</a><a id="10554" href="/lia/part5/AExp/#10554" class="Bound">e</a> <a id="10556" href="/lia/part5/AExp/#10556" class="Bound">ρ</a><a id="10557" class="Symbol">}</a> <a id="10559" class="Symbol">→</a> <a id="10561" href="/lia/part5/AExp/#10554" class="Bound">e</a> <a id="10563" href="/lia/part5/AExp/#9588" class="Datatype Operator">,</a> <a id="10565" href="/lia/part5/AExp/#10556" class="Bound">ρ</a> <a id="10567" href="/lia/part5/AExp/#9588" class="Datatype Operator">⇒</a> <a id="10569" href="/lia/part5/AExp/#1618" class="Function Operator">⟦</a> <a id="10571" href="/lia/part5/AExp/#10554" class="Bound">e</a> <a id="10573" href="/lia/part5/AExp/#1618" class="Function Operator">⟧</a> <a id="10575" href="/lia/part5/AExp/#10556" class="Bound">ρ</a>
<a id="10577" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> <a id="10588" class="Symbol">{</a><a id="10589" href="/lia/part5/AExp/#728" class="InductiveConstructor">Num</a> <a id="10593" href="/lia/part5/AExp/#10593" class="Bound">x</a><a id="10594" class="Symbol">}</a> <a id="10596" class="Symbol">=</a> <a id="10598" href="/lia/part5/AExp/#9625" class="InductiveConstructor">⇒-Num</a>
<a id="10604" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> <a id="10615" class="Symbol">{</a><a id="10616" href="/lia/part5/AExp/#751" class="InductiveConstructor">Var</a> <a id="10620" href="/lia/part5/AExp/#10620" class="Bound">x</a><a id="10621" class="Symbol">}</a> <a id="10623" class="Symbol">=</a> <a id="10625" href="/lia/part5/AExp/#9659" class="InductiveConstructor">⇒-Var</a>
<a id="10631" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> <a id="10642" class="Symbol">{</a><a id="10643" href="/lia/part5/AExp/#780" class="InductiveConstructor">Add</a> <a id="10647" href="/lia/part5/AExp/#10647" class="Bound">e</a> <a id="10649" href="/lia/part5/AExp/#10649" class="Bound">e₁</a><a id="10651" class="Symbol">}</a> <a id="10653" class="Symbol">=</a> <a id="10655" href="/lia/part5/AExp/#9695" class="InductiveConstructor">⇒-Add</a> <a id="10661" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> <a id="10672" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> 
<a id="10684" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> <a id="10695" class="Symbol">{</a><a id="10696" href="/lia/part5/AExp/#808" class="InductiveConstructor">Mul</a> <a id="10700" href="/lia/part5/AExp/#10700" class="Bound">e</a> <a id="10702" href="/lia/part5/AExp/#10702" class="Bound">e₁</a><a id="10704" class="Symbol">}</a> <a id="10706" class="Symbol">=</a> <a id="10708" class="Symbol">{!   !}</a> <a id="10716" class="Comment">-- ⇒-Add ⇒-agree-⟦⟧ ⇒-agree-⟦⟧ </a>
<a id="10748" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> <a id="10759" class="Symbol">{</a><a id="10760" href="/lia/part5/AExp/#836" class="InductiveConstructor">Let</a> <a id="10764" href="/lia/part5/AExp/#10764" class="Bound">x</a> <a id="10766" href="/lia/part5/AExp/#10766" class="Bound">e</a> <a id="10768" href="/lia/part5/AExp/#10768" class="Bound">f</a><a id="10769" class="Symbol">}</a> <a id="10771" class="Symbol">=</a> <a id="10773" href="/lia/part5/AExp/#9766" class="InductiveConstructor">⇒-let</a> <a id="10779" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a> <a id="10790" href="/lia/part5/AExp/#10538" class="Function">⇒-agree-⟦⟧</a></pre>

<div id="refs">

  <h1 id="references">
<a class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>References</h1>

</div>

    </div>
  
    <header class="nav-header">
    <p style="text-align:center;">
        
        
        
        <a alt="Part" href="/lia/part5/index/">Part</a>
        &bullet;
        
        
        <a alt="Source code" href="https://github.com/lclem/lia/blob/main/src/part5/AExp.lagda.md">Source</a>
        
        
        
    </p>
</header>

    <p class="p-name"> Last-modified: Jan  4 10:36:16 2021 </p>
  </article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/lia/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Logic in Agda</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Lorenzo Clemente</li>
          <li><a class="u-email" href="mailto:clementelorenzo@gmail.com">clementelorenzo@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/lclem"><svg class="svg-icon"><use xlink:href="/lia/assets/minima-social-icons.svg#github"></use></svg> <span class="username">lclem</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>

<!-- Parse the Latex divs with Katex
<script type="text/javascript">
  $("script[type='math/tex']").replaceWith(
    function(){
      var tex = $(this).text();
      return katex.renderToString(tex, {displayMode: false});
  });
  
  $("script[type='math/tex; mode=display']").replaceWith(
    function(){
      var tex = $(this).text();
      return katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: true});
  });
</script>
-->

<script type="text/javascript" src="/lia/assets/hidebox.js"></script>
</body>

</html>
