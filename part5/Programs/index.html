<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Imperative programs 🚧 | Logic in Agda</title><!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Imperative programs 🚧" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Propositional and fist-order logic developed with the proof assistant Agda." />
<meta property="og:description" content="Propositional and fist-order logic developed with the proof assistant Agda." />
<link rel="canonical" href="/lia/part5/Programs/" />
<meta property="og:url" content="/lia/part5/Programs/" />
<meta property="og:site_name" content="Logic in Agda" />
<script type="application/ld+json">
{"url":"/lia/part5/Programs/","@type":"WebPage","description":"Propositional and fist-order logic developed with the proof assistant Agda.","headline":"Imperative programs 🚧","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/lia/assets/main.css">

  <!-- <link rel="stylesheet" href="/lia/assets/custom.css"> --><!-- Mathjax Support -->
  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <!-- Load KaTeX -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.1.1/katex.min.js"></script>

<script type="text/x-thebe-config">
  {
    bootstrap: true,
    requestKernel: true,
    runAllCells: false,
    selector: "[data-executable]",
    predefinedOutput: false,
    codeMirrorConfig: {
        //theme: "idea",
        language: "agda",
        readOnly: false,
        lineNumbers: true,
        keyMap: "default",
//        gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
    },
    kernelOptions: {
        name: "agda",
        kernelName: "agda",
        path: "src/",
        loadFromStore: true,
        persistent: false,
        // notebook server configuration; not needed with binder
        serverSettings: {
              baseUrl: "http://127.0.0.1:8888",
              token: "test-secret",
            },
    },
    binderOptions: {
      repo: "lclem/lia", // need to put here the actual github repo (if it is a fork)
      ref: "main",
      binderUrl: "https://mybinder.org",
      repoProvider: "github",
      savedSession: {
        enabled: true,
        maxAge: 86400, // the max age in seconds to consider re-using a session
        storagePrefix: "thebe-binder-lia-"
      },
    },
  }
</script>

<!-- <script type="text/javascript" src="https://unpkg.com/thebelab@latest"></script> -->

<!-- our own version of the thebe library: -->
<script type="text/javascript" src="/lia/thebe/lib/index.js"></script>

<!-- highlighting for Agda -->
<script src="/lia/codemirror-agda/lib/index.js"></script>

</head>
<body><header class="site-header" id="site-header">

    <div class="wrapper">

        <a class="site-title" href="/lia/">Logic in Agda</a>

        <nav class="site-nav">
            <!-- <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                    <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
                    <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
                    <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
                </svg>
            </span> -->

            <div class="trigger">
                <a class="page-link" href="/lia/part0/index/">Part 0</a>
                <a class="page-link" href="/lia/part1/index/">Part 1</a>
                <a class="page-link" href="/lia/part2/index/">Part 2</a>
                <a class="page-link" href="/lia/part3/index/">Part 3</a>
                <a class="page-link" href="/lia/part4/index/">Part 4</a>
                <a class="page-link" href="/lia/part5/index/">Part 5</a>

                <span class="kernel-status">
                    <button class="kernel-status-button" onclick="kernel_status_clicked()" title="kernel status"></button>
                    <span id="kernel-messages" class="kernel-messages"></span>
                </span>

                <div id="connection_options" class="options sidebar" style="text-align: left; line-height: normal; max-width: 800px; padding: 10px; border-radius: 15px;">
                    <!-- display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: space-between; -->
                    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
                    <div>
                        <label for="username" style="color: white;">User:</label>
                        <input type="text" placeholder="github username" id="username" name="username">
                        <label for="password" style="color: white;">Password:</label>
                        <input type="password" placeholder="password" id="password" name="password">
                    </div>
                    <div>
                        <label for="loadFromStore" style="color: white;">Load code from browser store:</label>
                        <label class="switch" style="vertical-align: middle; margin: 10px;">
                            <input type="checkbox" id="loadFromStore" name="loadFromStore">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div>
                        <label for="baseUrl" style="color: white;">Base URL:</label>
                        <input type="text" placeholder="baseUrl" id="baseUrl" name="baseUrl" value="http://127.0.0.1:8888">
                        <label for="token" style="color: white;">Token:</label>
                        <input type="text" placeholder="token" id="token" name="token" value="test-secret">
                    </div>
                    <div>
                        <label for="useBinder" style="color: white;">Use binder:</label>
                        <label class="switch" style="vertical-align: middle; margin: 10px;">
                            <input type="checkbox" id="useBinder" name="useBinder">
                            <span class="slider round"></span>
                        </label>
                        <label for="savedSession" style="color: white;">Reuse session:</label>
                        <label class="switch" style="vertical-align: middle; margin: 10px;">
                            <input type="checkbox" id="savedSession" name="savedSession">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div>
                        <label for="repository" style="color: white;">Github repo:</label>
                        <input type="text" placeholder="repository" id="repository" name="repository" value="">

                        <label for="ref" style="color: white;">Branch:</label>
                        <input type="text" placeholder="ref" id="ref" name="ref" value="main">

                        <label for="binderUrl" style="color: white;">Binder URL:</label>                        
                        <input type="text" placeholder="binderUrl" id="binderUrl" name="binderUrl" value="https://mybinder.org">
                    </div>
                </div>

                <span class="control-container" id="control-container">
                    <svg class="progress-ring" id="progress-ring" width="30" height="30" title="exercise progress" onclick="kernel_status_clicked()">
                        <circle
                            id="progress-circle"
                            class="progress-ring__circle"
                            stroke="black"
                            stroke-width="2.5"
                            fill="transparent"
                            r="14"
                            cx="15"
                            cy="15"/>
                        <circle
                            stroke="lightgray"
                            stroke-width="0.5"
                            fill="transparent"
                            r="14"
                            cx="15"
                            cy="15"/>
                    </svg>
                    <div id="connection_options" class="options sidebar" style="text-align: left; line-height: normal; max-width: 800px; padding: 10px; border-radius: 15px;"></div>
                    <span class="progress-text" id="progress-text" onclick="kernel_status_clicked()"> 0/0 </span>

                    <span id="controls" class="controls">
                        <svg version="1.1" id="run-all" class="run-all" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                            width="15" height="15" viewBox="0 0 163.861 163.861" style="enable-background:new 0 0 163.861 163.861;"
                            xml:space="preserve">
                            <g>
                                <path d="M34.857,3.613C20.084-4.861,8.107,2.081,8.107,19.106v125.637c0,17.042,11.977,23.975,26.75,15.509L144.67,97.275
                                    c14.778-8.477,14.778-22.211,0-30.686L34.857,3.613z"/>
                            </g>
                        </svg>
                    </span>
                </span>
            </div>

            <style>
                .switch {
                    position: relative;
                    display: inline-block;
                    width: 40px;
                    height: 20px;
                }

                /* Hide default HTML checkbox */
                .switch input {
                    opacity: 0;
                    width: 0;
                    height: 0;
                }

                /* The slider */
                .slider {
                    position: absolute;
                    cursor: pointer;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background-color: #ccc;
                    -webkit-transition: .4s;
                    transition: .4s;
                }

                .slider:before {
                    position: absolute;
                    content: "";
                    height: 16px;
                    width: 16px;
                    left: 2px;
                    /* right: 4px; */
                    bottom: 2px;
                    top: 2px;
                    background-color: white;
                    -webkit-transition: .4s;
                    transition: .4s;
                }

                input:checked + .slider {
                    background-color: #2196F3;
                }

                input:focus + .slider {
                    box-shadow: 0 0 1px #2196F3;
                }

                input:checked + .slider:before {
                    -webkit-transform: translateX(18px);
                    -ms-transform: translateX(18px);
                    transform: translateX(18px);
                }

                /* Rounded sliders */
                .slider.round {
                    border-radius: 30px;
                }

                .slider.round:before {
                border-radius: 50%;
                }

                .sidebar input[type=text] {
                    padding: 6px;
                    margin-top: 8px;
                    /* font-size: 17px; */
                    border: none;
                    /* width: 150px; */
                }

                .sidebar {
                    /* height: 100%; */
                    width: 0;
                    position: fixed;
                    z-index: 1000;
                    top: 0;
                    right: 20px;
                    background-color: rgba(17, 17, 17, 0.637);
                    /* overflow-x: hidden; */
                    transition: 0.5s;
                    padding-top: 60px;
                    display: none;
                    margin-top: 60px;
                }

                .sidebar .closebtn {
                    position: absolute;
                    color: white;
                    top: 0;
                    right: 10px;
                    font-size: 24px;
                    margin-left: 20px;
                }

                .progress-ring, .run-all {
                    vertical-align: middle;
                }

                .control-container {
                    transition: all .2s ease-in-out;
                }

                .controls {
                    display: none;
                    opacity: 0;
                    margin-right: 10px;
                    transition: all .5s ease-in-out;
                }

                .run-all:hover {
                    filter: brightness(135%);
                }

                .progress-ring__circle {
                    transition: 0.35s stroke-dashoffset;
                    transform: rotate(-90deg);
                    transform-origin: 50% 50%;
                    visibility: hidden;
                }

                .progress-text {
                    position: relative;
                    top: 0;
                    left: -25px;
                    font-size: 8px;
                    vertical-align: middle;
                    align-self: center;
                }

                .progress-text:hover, .progress-ring:hover, .progress-ring__circle:hover, .run-all {
                    cursor: pointer;
                }
            </style>

            <script>

                //  var storedUsername = localStorage.getItem("username");
                //  localStorage.setItem("username", storedUsername.value);
            
                function doStore(input, key) {

                    if(input.type == "checkbox") {
                        var checked = localStorage.getItem(key);

                        if (checked == "yes") {
                            localStorage.setItem(key, "no");
                        }
                        else {
                            localStorage.setItem(key, "yes");
                        }

                        console.info("checked: ", localStorage.getItem(key));
                    }
                    else {
                        console.info("value: ", input.value);
                        localStorage.setItem(key, input.value);
                    }
                }

                function persistInput(input) {
                    var key = "input-" + input.id;
                    var storedValue = localStorage.getItem(key);
                
                    console.info("Persisting input: ", input);
                
                    // if there is a stored value, use it
                    if (storedValue) {

                        if(input.type != "password") {
                            console.info("restoring value ", storedValue, " for ", input);
                        }

                        if(input.type == "checkbox") {
                            if(storedValue=="yes") {
                                input.setAttribute("checked", "");
                            }
                            else {
                                input.removeAttribute("checked");
                            }
                        }
                        else {
                            input.value = storedValue;
                        }
                    }
                    // if there is no stored value, store the current value
                    else {
                        doStore(input, key);
                    }

                    input.addEventListener('input', function () {
                        console.info("input changed: key = ", key, "; value = ", input);
                        doStore(input, key);
                    });
                    }
                
                    persistInput(document.getElementById("username"));
                    persistInput(document.getElementById("password"));

                    persistInput(document.getElementById("loadFromStore"));

                    persistInput(document.getElementById("baseUrl"));
                    persistInput(document.getElementById("token"));

                    persistInput(document.getElementById("useBinder"));
                    persistInput(document.getElementById("savedSession"));
                    persistInput(document.getElementById("repository"));
                    persistInput(document.getElementById("ref"));
                    persistInput(document.getElementById("binderUrl"));

                    // init
                    document.getElementById("connection_options").style.display = "none";

                    function kernel_status_clicked() {
                
                        console.info("Clicked kernel status");

                        document.getElementById("kernel-messages").style.display = "none";

                        document.getElementById("connection_options").style.width = "750px";
                        document.getElementById("connection_options").style.display = "block";
                        //document.getElementById("header").style.marginLeft = "250px";

                    }

                    function closeNav() {

                        document.getElementById("kernel-messages").style.display = "inline";

                        document.getElementById("connection_options").style.width = "0";
                        document.getElementById("connection_options").style.display = "none";
                        //document.getElementById("header").style.marginLeft= "0";
                    }

                var prevScrollpos = window.pageYOffset;
                var header = document.getElementById("site-header");
                var boxShadow = header.style.boxShadow;

                window.onscroll = function() {
                    var currentScrollPos = window.pageYOffset;
                    // detect scroll down
                    if (prevScrollpos > currentScrollPos) {
                        header.style.top = "0";
                        header.style.boxShadow = boxShadow;
                        prevScrollpos = currentScrollPos;
                    } else if (prevScrollpos <= currentScrollPos) {
                        header.style.top = "-55px";
                        header.style.boxShadow = "none"
                        prevScrollpos = currentScrollPos;
                    }
                }

            let control_container = document.getElementById("control-container");
            let controls = document.getElementById("controls");

            control_container.addEventListener("mouseenter", function(event) {
                controls.style.display = "inline";
//                controls.style.visibility = "visible";
                controls.style.opacity = 1;
                console.info("mouseenter");
            }, false);

            control_container.addEventListener("mouseleave", function(event) {
                // controls.style.visibility = "hidden";
                // controls.style.display = "none";
                controls.style.opacity = 0;
                console.info("mouseleave");
            }, false);

            </script>
            
        </nav>

    </div>

</header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

    <header class="post-header">
        <h1 class="post-title">Imperative programs 🚧</h1>
    </header>
  
    <header class="nav-header">
    <p style="text-align:center;">
        
        
        
        <a alt="Part" href="/lia/part5/index/">Part</a>
        &bullet;
        
        
        <a alt="Source code" href="https://github.com/lclem/lia/blob/main/src/part5/Programs.lagda.md">Source</a>
        
        
        
    </p>
</header>

  
    <div class="post-content">
        <h2>Contents</h2>    
        <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#syntax-of-programs">Syntax of programs</a></li>
<li class="toc-entry toc-h1"><a href="#denotational-semantics">Denotational semantics</a></li>
<li class="toc-entry toc-h1"><a href="#big-steps-operational-semantics-natural-semantics">Big-steps operational semantics (Natural semantics)</a>
<ul>
<li class="toc-entry toc-h2"><a href="#exercise-do-c-while-b">Exercise: do: c while b</a></li>
<li class="toc-entry toc-h2"><a href="#exercise-determinism">Exercise: Determinism</a></li>
<li class="toc-entry toc-h2"><a href="#exercise-loop">Exercise: loop</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#small-steps-operational-semantics">Small-steps operational semantics</a>
<ul>
<li class="toc-entry toc-h2"><a href="#transitive-closure">Transitive closure ↝*</a></li>
<li class="toc-entry toc-h2"><a href="#exercise-bigsmall">Exercise: big→small</a></li>
<li class="toc-entry toc-h2"><a href="#from-small-to-big-steps-first-attempt">From small to big steps: first attempt</a></li>
<li class="toc-entry toc-h2"><a href="#transitive-closure-with-gas">Transitive closure with gas</a></li>
<li class="toc-entry toc-h2"><a href="#exercise-smallbig">Exercise: small→big</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#contexual-equivalence">Contexual equivalence</a>
<ul>
<li class="toc-entry toc-h2"><a href="#full-abstraction">Full abstraction</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#axiomatic-semantics">Axiomatic semantics</a></li>
</ul><pre class="Agda"><a id="45" class="Symbol">{-#</a> <a id="49" class="Keyword">OPTIONS</a> <a id="57" class="Pragma">--allow-unsolved-metas</a> <a id="80" class="Symbol">#-}</a>
<a id="84" class="Keyword">module</a> <a id="91" href="/lia/part5/Programs/" class="Module">part5.Programs</a> <a id="106" class="Keyword">where</a>
<a id="112" class="Keyword">open</a> <a id="117" class="Keyword">import</a> <a id="124" href="/lia/part5/Exp/" class="Module">part5.Exp</a> <a id="134" class="Keyword">hiding</a> <a id="141" class="Symbol">(</a><a id="142" href="/lia/part5/Exp/#23586" class="Datatype Operator">_↝_</a><a id="145" class="Symbol">;</a> <a id="147" href="/lia/part5/Exp/#18353" class="Datatype Operator">_,_⇒_</a><a id="152" class="Symbol">;</a> <a id="154" href="/lia/part5/Exp/#19932" class="Function">⇒-det</a><a id="159" class="Symbol">;</a> <a id="161" href="/lia/part5/Exp/#11611" class="Function">↝*-trans</a><a id="169" class="Symbol">;</a> <a id="171" href="/lia/part5/Exp/#14262" class="Function Operator">_↝*⟨⟩_</a><a id="177" class="Symbol">;</a> <a id="179" href="/lia/part5/Exp/#14432" class="Function Operator">_↝⟨_⟩_</a><a id="185" class="Symbol">;</a> <a id="187" href="/lia/part5/Exp/#14329" class="Function Operator">_↝*⟨_⟩_</a><a id="194" class="Symbol">;</a> <a id="196" href="/lia/part5/Exp/#17564" class="Datatype Operator">_,_↝_,_</a><a id="203" class="Symbol">)</a></pre>
<pre class="Agda"><a id="214" class="Keyword">infixr</a> <a id="221" class="Number">20</a> <a id="224" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">_⨟_</a>
<a id="228" class="Keyword">infix</a> <a id="234" class="Number">25</a> <a id="237" href="/lia/part5/Programs/#414" class="InductiveConstructor Operator">_≔_</a></pre>

<h1 id="syntax-of-programs">
<a class="anchor" href="#syntax-of-programs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Syntax of programs</h1>

<p>We define a simple imperative language, leveraging on arithmetic and
boolean expressions defined above.</p>

<pre class="Agda"><a id="378" class="Keyword">data</a> <a id="Cmd"></a><a id="383" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="387" class="Symbol">:</a> <a id="389" class="PrimitiveType">Set</a> <a id="393" class="Keyword">where</a>
  <a id="Cmd.skip"></a><a id="401" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="406" class="Symbol">:</a> <a id="408" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a>
  <a id="Cmd._≔_"></a><a id="414" href="/lia/part5/Programs/#414" class="InductiveConstructor Operator">_≔_</a> <a id="418" class="Symbol">:</a> <a id="420" href="/lia/part5/Exp/#544" class="Function">VarName</a> <a id="428" class="Symbol">→</a> <a id="430" href="/lia/part5/Exp/#765" class="Datatype">AExp</a> <a id="435" class="Symbol">→</a> <a id="437" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a>
  <a id="Cmd._⨟_"></a><a id="443" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">_⨟_</a> <a id="447" class="Symbol">:</a> <a id="449" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="453" class="Symbol">→</a> <a id="455" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="459" class="Symbol">→</a> <a id="461" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a>
  <a id="Cmd.if_then_else_"></a><a id="467" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if_then_else_</a> <a id="481" class="Symbol">:</a> <a id="483" href="/lia/part5/Exp/#1938" class="Datatype">BExp</a> <a id="488" class="Symbol">→</a> <a id="490" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="494" class="Symbol">→</a> <a id="496" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="500" class="Symbol">→</a> <a id="502" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a>
  <a id="Cmd.while_do:_"></a><a id="508" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while_do:_</a> <a id="519" class="Symbol">:</a> <a id="521" href="/lia/part5/Exp/#1938" class="Datatype">BExp</a> <a id="526" class="Symbol">→</a> <a id="528" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="532" class="Symbol">→</a> <a id="534" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a></pre>

<p>For example, the following is a valid program (piece of syntax).</p>

<pre class="Agda"><a id="loop"></a><a id="613" href="/lia/part5/Programs/#613" class="Function">loop</a> <a id="618" class="Symbol">:</a> <a id="620" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a>
<a id="624" href="/lia/part5/Programs/#613" class="Function">loop</a> <a id="629" class="Symbol">=</a> <a id="631" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="637" href="/lia/part5/Exp/#1957" class="InductiveConstructor">tt</a> <a id="640" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="644" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a></pre>

<p>(We added a colon in the syntax of <code class="language-plaintext highlighter-rouge">while_do:_</code> because <code class="language-plaintext highlighter-rouge">do</code> is a
reserved keyword.)</p>

<h1 id="denotational-semantics">
<a class="anchor" href="#denotational-semantics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Denotational semantics</h1>

<p>It may come as a surprise, but it is not possible to define the
semantics of imperative programs as an Agda function, because Agda
allows only terminating (i.e., total) functions. On the other hand,
imperative programs, such as <code class="language-plaintext highlighter-rouge">loop</code> above, may not terminate.</p>

<p>Therefore, we resort to an operational semantics.</p>

<h1 id="big-steps-operational-semantics-natural-semantics">
<a class="anchor" href="#big-steps-operational-semantics-natural-semantics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Big-steps operational semantics (Natural semantics)</h1>

<p>We begin with the notion of state, which is the same as environments as
of now, but needs not be.</p>

<pre class="Agda"><a id="State"></a><a id="1237" href="/lia/part5/Programs/#1237" class="Function">State</a> <a id="1243" class="Symbol">=</a> <a id="1245" href="/lia/part5/Exp/#544" class="Function">VarName</a> <a id="1253" class="Symbol">→</a> <a id="1255" href="/lia/part0/Naturals/#301" class="Function">ℕ</a>

<a id="1258" class="Keyword">private</a>
  <a id="1268" class="Keyword">variable</a>
    <a id="1281" href="/lia/part5/Programs/#1281" class="Generalizable">m</a> <a id="1283" href="/lia/part5/Programs/#1283" class="Generalizable">n</a> <a id="1285" class="Symbol">:</a> <a id="1287" href="/lia/part0/Naturals/#301" class="Function">ℕ</a>
    <a id="1293" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="1295" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="1298" href="/lia/part5/Programs/#1298" class="Generalizable">s′′</a> <a id="1302" class="Symbol">:</a> <a id="1304" href="/lia/part5/Programs/#1237" class="Function">State</a>
    <a id="1314" href="/lia/part5/Programs/#1314" class="Generalizable">x</a> <a id="1316" class="Symbol">:</a> <a id="1318" href="/lia/part5/Exp/#544" class="Function">VarName</a>
    <a id="1330" href="/lia/part5/Programs/#1330" class="Generalizable">e</a> <a id="1332" class="Symbol">:</a> <a id="1334" href="/lia/part5/Exp/#765" class="Datatype">AExp</a>
    <a id="1343" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="1345" class="Symbol">:</a> <a id="1347" href="/lia/part5/Exp/#1938" class="Datatype">BExp</a>
    <a id="1356" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="1358" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="1360" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="1363" href="/lia/part5/Programs/#1363" class="Generalizable">d′</a> <a id="1366" class="Symbol">:</a> <a id="1368" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a></pre>

<p>The definition of the operational semantics of imperative programs
follows a case analysis.</p>

<pre class="Agda"><a id="1474" class="Keyword">infix</a> <a id="1480" class="Number">4</a> <a id="1482" href="/lia/part5/Programs/#1493" class="Datatype Operator">_,_⇒_</a>
<a id="1488" class="Keyword">data</a> <a id="_,_⇒_"></a><a id="1493" href="/lia/part5/Programs/#1493" class="Datatype Operator">_,_⇒_</a> <a id="1499" class="Symbol">:</a> <a id="1501" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="1505" class="Symbol">→</a> <a id="1507" href="/lia/part5/Programs/#1237" class="Function">State</a> <a id="1513" class="Symbol">→</a> <a id="1515" href="/lia/part5/Programs/#1237" class="Function">State</a> <a id="1521" class="Symbol">→</a> <a id="1523" class="PrimitiveType">Set</a> <a id="1527" class="Keyword">where</a></pre>

<h3 id="skip"><code class="language-plaintext highlighter-rouge">skip</code></h3>

<p>The <code class="language-plaintext highlighter-rouge">skip</code> command terminates immediately without changing the state.</p>

<pre class="Agda">  <a id="_,_⇒_.⇒-skip"></a><a id="1627" href="/lia/part5/Programs/#1627" class="InductiveConstructor">⇒-skip</a> <a id="1634" class="Symbol">:</a>
    <a id="1640" class="Comment">------------</a>
    <a id="1657" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="1662" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="1664" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="1666" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="1668" href="/lia/part5/Programs/#1293" class="Generalizable">s</a></pre>

<h3 id="x-e"><code class="language-plaintext highlighter-rouge">x ≔ e</code></h3>

<p>The assignment command modifies the state by updating the value of <code class="language-plaintext highlighter-rouge">x</code>
to the value of <code class="language-plaintext highlighter-rouge">e</code> in the current state.</p>

<pre class="Agda">  <a id="_,_⇒_.⇒-assign"></a><a id="1808" href="/lia/part5/Programs/#1808" class="InductiveConstructor">⇒-assign</a> <a id="1817" class="Symbol">:</a>
    <a id="1823" class="Comment">-----------------------------</a>
    <a id="1857" href="/lia/part5/Programs/#1314" class="Generalizable">x</a> <a id="1859" href="/lia/part5/Programs/#414" class="InductiveConstructor Operator">≔</a> <a id="1861" href="/lia/part5/Programs/#1330" class="Generalizable">e</a> <a id="1863" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="1865" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="1867" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="1869" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="1871" href="/lia/part0/Functions/#568" class="Function Operator">[</a> <a id="1873" href="/lia/part5/Programs/#1314" class="Generalizable">x</a> <a id="1875" href="/lia/part0/Functions/#568" class="Function Operator">↦</a> <a id="1877" href="/lia/part5/Exp/#2410" class="Function Operator">A⟦</a> <a id="1880" href="/lia/part5/Programs/#1330" class="Generalizable">e</a> <a id="1882" href="/lia/part5/Exp/#2410" class="Function Operator">⟧</a> <a id="1884" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="1886" href="/lia/part0/Functions/#568" class="Function Operator">]</a></pre>

<h3 id="c-d"><code class="language-plaintext highlighter-rouge">c ⨟ d</code></h3>

<p>Sequencing two commands amounts to thread the state change.</p>

<pre class="Agda">  <a id="_,_⇒_.⇒-seq"></a><a id="1973" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="1979" class="Symbol">:</a>
    <a id="1985" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="1987" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="1989" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="1991" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="1993" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="1996" class="Symbol">→</a>
    <a id="2002" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="2004" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2006" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="2009" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2011" href="/lia/part5/Programs/#1298" class="Generalizable">s′′</a> <a id="2015" class="Symbol">→</a>
    <a id="2021" class="Comment">---------------</a>
    <a id="2041" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="2043" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="2045" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="2047" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2049" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2051" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2053" href="/lia/part5/Programs/#1298" class="Generalizable">s′′</a></pre>

<h3 id="if-b-then-c-else-d"><code class="language-plaintext highlighter-rouge">if b then c else d</code></h3>

<p>For conditionals, there are two cases to consider, depending on whether
the condition evaluates to true or to false.</p>

<pre class="Agda">  <a id="_,_⇒_.⇒-if-tt"></a><a id="2212" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="2220" class="Symbol">:</a>
    <a id="2226" href="/lia/part5/Exp/#2717" class="Function Operator">B⟦</a> <a id="2229" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2231" href="/lia/part5/Exp/#2717" class="Function Operator">⟧</a> <a id="2233" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2235" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2237" href="/lia/part0/Booleans/#284" class="InductiveConstructor">tt</a> <a id="2240" class="Symbol">→</a>
    <a id="2246" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="2248" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2250" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2252" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2254" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="2257" class="Symbol">→</a>
    <a id="2263" class="Comment">---------------------------</a>
    <a id="2295" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="2298" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2300" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="2305" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="2307" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="2312" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="2314" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2316" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2318" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2320" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a>
    
  <a id="_,_⇒_.⇒-if-ff"></a><a id="2330" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="2338" class="Symbol">:</a>
    <a id="2344" href="/lia/part5/Exp/#2717" class="Function Operator">B⟦</a> <a id="2347" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2349" href="/lia/part5/Exp/#2717" class="Function Operator">⟧</a> <a id="2351" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2353" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2355" href="/lia/part0/Booleans/#275" class="InductiveConstructor">ff</a> <a id="2358" class="Symbol">→</a>
    <a id="2364" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="2366" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2368" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2370" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2372" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="2375" class="Symbol">→</a>
    <a id="2381" class="Comment">---------------------------</a>
    <a id="2413" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="2416" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2418" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="2423" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="2425" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="2430" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="2432" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2434" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2436" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2438" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a></pre>

<h3 id="while-b-do-c"><code class="language-plaintext highlighter-rouge">while b do: c</code></h3>

<p>Similarly, for while loops there are two cases to consider.</p>

<pre class="Agda">  <a id="_,_⇒_.⇒-while-tt"></a><a id="2534" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="2545" class="Symbol">:</a>
    <a id="2551" href="/lia/part5/Exp/#2717" class="Function Operator">B⟦</a> <a id="2554" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2556" href="/lia/part5/Exp/#2717" class="Function Operator">⟧</a> <a id="2558" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2560" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2562" href="/lia/part0/Booleans/#284" class="InductiveConstructor">tt</a> <a id="2565" class="Symbol">→</a>
    <a id="2571" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="2573" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2575" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2577" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2579" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="2582" class="Symbol">→</a>
    <a id="2588" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="2594" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2596" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="2600" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="2602" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2604" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="2607" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2609" href="/lia/part5/Programs/#1298" class="Generalizable">s′′</a> <a id="2613" class="Symbol">→</a>
    <a id="2619" class="Comment">--------------------------</a>
    <a id="2650" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="2656" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2658" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="2662" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="2664" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2666" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2668" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2670" href="/lia/part5/Programs/#1298" class="Generalizable">s′′</a>
  
  <a id="_,_⇒_.⇒-while-ff"></a><a id="2679" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="2690" class="Symbol">:</a>
    <a id="2696" href="/lia/part5/Exp/#2717" class="Function Operator">B⟦</a> <a id="2699" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2701" href="/lia/part5/Exp/#2717" class="Function Operator">⟧</a> <a id="2703" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2705" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2707" href="/lia/part0/Booleans/#275" class="InductiveConstructor">ff</a> <a id="2710" class="Symbol">→</a>
    <a id="2716" class="Comment">---------------------</a>
    <a id="2742" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="2748" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="2750" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="2754" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="2756" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="2758" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="2760" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="2762" href="/lia/part5/Programs/#1293" class="Generalizable">s</a></pre>

<p>This concludes the definition of the operational semantics <code class="language-plaintext highlighter-rouge">c , s ⇒ s′</code>.</p>

<h2 id="exercise-do-c-while-b">
<a class="anchor" href="#exercise-do-c-while-b" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Exercise</strong>: <code class="language-plaintext highlighter-rouge">do: c while b</code>
</h2>

<p>Extend the syntax and semantics of programs by adding a new construct</p>

<pre class="Agda"><a id="2952" class="Comment">-- do: c while b</a></pre>

<p>where <code class="language-plaintext highlighter-rouge">c</code> is a command and <code class="language-plaintext highlighter-rouge">b</code> a boolean expression. The informal
semantics of the do-while construct is to first execute <code class="language-plaintext highlighter-rouge">c</code>, and then
evaluate the guard <code class="language-plaintext highlighter-rouge">b</code>: If it evaluates to true, then we repeat the
process, otherwise we exit the loop.</p>

<h2 id="exercise-determinism">
<a class="anchor" href="#exercise-determinism" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Exercise</strong>: Determinism</h2>

<p>Since we cannot encode the semantics of imperative programs as a
function, we immediately lose some properties which are for free for
functions.</p>

<p>One example is deterministic evaluation. Consequently, we need to prove
separately that evaluation of programs is deterministic.</p>

<p>Show that evaluation of imperative programs is deterministic.</p>

<pre class="Agda"><a id="⇒-det"></a><a id="3589" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3595" class="Symbol">:</a> <a id="3597" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="3599" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="3601" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="3603" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="3605" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="3608" class="Symbol">→</a>
        <a id="3618" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="3620" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="3622" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="3624" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="3626" href="/lia/part5/Programs/#1298" class="Generalizable">s′′</a> <a id="3630" class="Symbol">→</a>
        <a id="3640" class="Comment">-------------</a>
        <a id="3662" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="3665" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3667" href="/lia/part5/Programs/#1298" class="Generalizable">s′′</a>

<a id="3672" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3678" href="/lia/part5/Programs/#1627" class="InductiveConstructor">⇒-skip</a> <a id="3685" href="/lia/part5/Programs/#1627" class="InductiveConstructor">⇒-skip</a> <a id="3692" class="Symbol">=</a> <a id="3694" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3699" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3705" href="/lia/part5/Programs/#1808" class="InductiveConstructor">⇒-assign</a> <a id="3714" href="/lia/part5/Programs/#1808" class="InductiveConstructor">⇒-assign</a> <a id="3723" class="Symbol">=</a> <a id="3725" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3730" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3736" class="Symbol">(</a><a id="3737" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="3743" href="/lia/part5/Programs/#3743" class="Bound">δ₁</a> <a id="3746" href="/lia/part5/Programs/#3746" class="Bound">δ₂</a><a id="3748" class="Symbol">)</a> <a id="3750" class="Symbol">(</a><a id="3751" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="3757" href="/lia/part5/Programs/#3757" class="Bound">δ₃</a> <a id="3760" href="/lia/part5/Programs/#3760" class="Bound">δ₄</a><a id="3762" class="Symbol">)</a> <a id="3764" class="Keyword">rewrite</a> <a id="3772" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3778" href="/lia/part5/Programs/#3743" class="Bound">δ₁</a> <a id="3781" href="/lia/part5/Programs/#3757" class="Bound">δ₃</a> <a id="3784" class="Symbol">|</a> <a id="3786" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3792" href="/lia/part5/Programs/#3746" class="Bound">δ₂</a> <a id="3795" href="/lia/part5/Programs/#3760" class="Bound">δ₄</a> <a id="3798" class="Symbol">=</a> <a id="3800" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3805" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3811" class="Symbol">(</a><a id="3812" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="3820" class="Symbol">_</a> <a id="3822" href="/lia/part5/Programs/#3822" class="Bound">δ1</a><a id="3824" class="Symbol">)</a> <a id="3826" class="Symbol">(</a><a id="3827" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="3835" class="Symbol">_</a> <a id="3837" href="/lia/part5/Programs/#3837" class="Bound">δ2</a><a id="3839" class="Symbol">)</a> <a id="3841" class="Keyword">rewrite</a> <a id="3849" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3855" href="/lia/part5/Programs/#3822" class="Bound">δ1</a> <a id="3858" href="/lia/part5/Programs/#3837" class="Bound">δ2</a> <a id="3861" class="Symbol">=</a> <a id="3863" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="3868" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3874" class="Symbol">(</a><a id="3875" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="3883" href="/lia/part5/Programs/#3883" class="Bound">⟦b⟧s≡tt</a> <a id="3891" class="Symbol">_)</a> <a id="3894" class="Symbol">(</a><a id="3895" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="3903" href="/lia/part5/Programs/#3903" class="Bound">⟦b⟧s≡ff</a> <a id="3911" class="Symbol">_)</a> <a id="3914" class="Symbol">=</a> <a id="3916" href="/lia/part0/Booleans/#586" class="Function">a≡ff→a≡tt-elim</a> <a id="3931" href="/lia/part5/Programs/#3903" class="Bound">⟦b⟧s≡ff</a> <a id="3939" href="/lia/part5/Programs/#3883" class="Bound">⟦b⟧s≡tt</a>
<a id="3947" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="3953" class="Symbol">(</a><a id="3954" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="3962" href="/lia/part5/Programs/#3962" class="Bound">⟦b⟧s≡ff</a> <a id="3970" class="Symbol">_)</a> <a id="3973" class="Symbol">(</a><a id="3974" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="3982" href="/lia/part5/Programs/#3982" class="Bound">⟦b⟧s≡tt</a> <a id="3990" class="Symbol">_)</a> <a id="3993" class="Symbol">=</a> <a id="3995" href="/lia/part0/Booleans/#586" class="Function">a≡ff→a≡tt-elim</a> <a id="4010" href="/lia/part5/Programs/#3962" class="Bound">⟦b⟧s≡ff</a> <a id="4018" href="/lia/part5/Programs/#3982" class="Bound">⟦b⟧s≡tt</a>
<a id="4026" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="4032" class="Symbol">(</a><a id="4033" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="4041" class="Symbol">_</a> <a id="4043" href="/lia/part5/Programs/#4043" class="Bound">δ₁</a><a id="4045" class="Symbol">)</a> <a id="4047" class="Symbol">(</a><a id="4048" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="4056" class="Symbol">_</a> <a id="4058" href="/lia/part5/Programs/#4058" class="Bound">δ₂</a><a id="4060" class="Symbol">)</a> <a id="4062" class="Keyword">rewrite</a> <a id="4070" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="4076" href="/lia/part5/Programs/#4043" class="Bound">δ₁</a> <a id="4079" href="/lia/part5/Programs/#4058" class="Bound">δ₂</a> <a id="4082" class="Symbol">=</a> <a id="4084" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4089" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="4095" class="Symbol">(</a><a id="4096" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="4107" class="Symbol">_</a> <a id="4109" href="/lia/part5/Programs/#4109" class="Bound">δ₁</a> <a id="4112" href="/lia/part5/Programs/#4112" class="Bound">δ₂</a><a id="4114" class="Symbol">)</a> <a id="4116" class="Symbol">(</a><a id="4117" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="4128" class="Symbol">_</a> <a id="4130" href="/lia/part5/Programs/#4130" class="Bound">δ₃</a> <a id="4133" href="/lia/part5/Programs/#4133" class="Bound">δ₄</a><a id="4135" class="Symbol">)</a> <a id="4137" class="Keyword">rewrite</a> <a id="4145" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="4151" href="/lia/part5/Programs/#4109" class="Bound">δ₁</a> <a id="4154" href="/lia/part5/Programs/#4130" class="Bound">δ₃</a> <a id="4157" class="Symbol">|</a> <a id="4159" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="4165" href="/lia/part5/Programs/#4112" class="Bound">δ₂</a> <a id="4168" href="/lia/part5/Programs/#4133" class="Bound">δ₄</a> <a id="4171" class="Symbol">=</a> <a id="4173" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="4178" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="4184" class="Symbol">(</a><a id="4185" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="4196" href="/lia/part5/Programs/#4196" class="Bound">⟦b⟧s≡tt</a> <a id="4204" class="Symbol">_</a> <a id="4206" class="Symbol">_)</a> <a id="4209" class="Symbol">(</a><a id="4210" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="4221" href="/lia/part5/Programs/#4221" class="Bound">⟦b⟧s≡ff</a><a id="4228" class="Symbol">)</a> <a id="4230" class="Symbol">=</a> <a id="4232" href="/lia/part0/Booleans/#586" class="Function">a≡ff→a≡tt-elim</a> <a id="4247" href="/lia/part5/Programs/#4221" class="Bound">⟦b⟧s≡ff</a> <a id="4255" href="/lia/part5/Programs/#4196" class="Bound">⟦b⟧s≡tt</a>
<a id="4263" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="4269" class="Symbol">(</a><a id="4270" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="4281" href="/lia/part5/Programs/#4281" class="Bound">⟦b⟧s≡ff</a><a id="4288" class="Symbol">)</a> <a id="4290" class="Symbol">(</a><a id="4291" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="4302" href="/lia/part5/Programs/#4302" class="Bound">⟦b⟧s≡tt</a> <a id="4310" class="Symbol">_</a> <a id="4312" class="Symbol">_)</a> <a id="4315" class="Symbol">=</a> <a id="4317" href="/lia/part0/Booleans/#586" class="Function">a≡ff→a≡tt-elim</a> <a id="4332" href="/lia/part5/Programs/#4281" class="Bound">⟦b⟧s≡ff</a> <a id="4340" href="/lia/part5/Programs/#4302" class="Bound">⟦b⟧s≡tt</a>
<a id="4348" href="/lia/part5/Programs/#3589" class="Function">⇒-det</a> <a id="4354" class="Symbol">(</a><a id="4355" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="4366" class="Symbol">_)</a> <a id="4369" class="Symbol">(</a><a id="4370" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="4381" class="Symbol">_)</a> <a id="4384" class="Symbol">=</a> <a id="4386" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a></pre>

<h2 id="exercise-loop">
<a class="anchor" href="#exercise-loop" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Exercise</strong>: <code class="language-plaintext highlighter-rouge">loop</code>
</h2>

<p>Show that the program <code class="language-plaintext highlighter-rouge">loop</code> introduced above never stops.</p>

<pre class="Agda"><a id="loop-⊥"></a><a id="4485" href="/lia/part5/Programs/#4485" class="Function">loop-⊥</a> <a id="4492" class="Symbol">:</a> <a id="4494" href="/lia/part0/Logic/#2336" class="Function Operator">~</a> <a id="4496" class="Symbol">(</a><a id="4497" href="/lia/part5/Programs/#613" class="Function">loop</a> <a id="4502" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="4504" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="4506" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="4508" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a><a id="4510" class="Symbol">)</a>
<a id="4512" href="/lia/part5/Programs/#4485" class="Function">loop-⊥</a> <a id="4519" class="Symbol">(</a><a id="4520" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="4531" class="Symbol">_</a> <a id="4533" href="/lia/part5/Programs/#1627" class="InductiveConstructor">⇒-skip</a> <a id="4540" href="/lia/part5/Programs/#4540" class="Bound">δ</a><a id="4541" class="Symbol">)</a> <a id="4543" class="Symbol">=</a> <a id="4545" href="/lia/part5/Programs/#4485" class="Function">loop-⊥</a> <a id="4552" href="/lia/part5/Programs/#4540" class="Bound">δ</a>
<a id="4554" href="/lia/part5/Programs/#4485" class="Function">loop-⊥</a> <a id="4561" class="Symbol">(</a><a id="4562" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="4573" href="/lia/part5/Programs/#4573" class="Bound">⟦tt⟧s≡ff</a><a id="4581" class="Symbol">)</a> <a id="4583" class="Symbol">=</a> <a id="4585" href="/lia/part0/Booleans/#513" class="Function">tt≡ff-elim</a> <a id="4596" href="/lia/part5/Programs/#4573" class="Bound">⟦tt⟧s≡ff</a></pre>

<h1 id="small-steps-operational-semantics">
<a class="anchor" href="#small-steps-operational-semantics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Small-steps operational semantics</h1>

<p>We provide an alternative small-steps semantics for imperative programs.</p>

<h3 id="configurations">Configurations</h3>

<pre class="Agda"><a id="Conf"></a><a id="4746" href="/lia/part5/Programs/#4746" class="Function">Conf</a> <a id="4751" class="Symbol">=</a> <a id="4753" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="4757" href="/lia/part0/Logic/#1770" class="Record Operator">×</a> <a id="4759" href="/lia/part5/Programs/#1237" class="Function">State</a> <a id="4765" class="Comment">-- Cartesian product</a></pre>

<p>We treat configurations of the form <code class="language-plaintext highlighter-rouge">skip , s</code> as final, hence there is
no rule for the <code class="language-plaintext highlighter-rouge">skip</code> command.</p>

<pre class="Agda"><a id="4900" class="Keyword">infix</a> <a id="4906" class="Number">3</a> <a id="4908" href="/lia/part5/Programs/#4917" class="Datatype Operator">_↝_</a>
<a id="4912" class="Keyword">data</a> <a id="_↝_"></a><a id="4917" href="/lia/part5/Programs/#4917" class="Datatype Operator">_↝_</a> <a id="4921" class="Symbol">:</a> <a id="4923" href="/lia/part5/Programs/#4746" class="Function">Conf</a> <a id="4928" class="Symbol">→</a> <a id="4930" href="/lia/part5/Programs/#4746" class="Function">Conf</a> <a id="4935" class="Symbol">→</a> <a id="4937" class="PrimitiveType">Set</a> <a id="4941" class="Keyword">where</a></pre>

<h3 id="x-e-1"><code class="language-plaintext highlighter-rouge">x ≔ e</code></h3>

<p>In the rule for assignment, we just evaluate the arithmetic expression
<code class="language-plaintext highlighter-rouge">e</code> and update the state accordingly.</p>

<p>(We could have used the operational semantics of arithmetic expressions
here, but we avoid it for simplicity. A similar remark applies to
boolean expressions below.)</p>

<pre class="Agda">  <a id="_↝_.↝-assign"></a><a id="5248" href="/lia/part5/Programs/#5248" class="InductiveConstructor">↝-assign</a> <a id="5257" class="Symbol">:</a> <a id="5259" class="Symbol">∀</a> <a id="5261" class="Symbol">{</a><a id="5262" href="/lia/part5/Programs/#5262" class="Bound">x</a> <a id="5264" href="/lia/part5/Programs/#5264" class="Bound">e</a> <a id="5266" href="/lia/part5/Programs/#5266" class="Bound">s</a><a id="5267" class="Symbol">}</a> <a id="5269" class="Symbol">→</a>
    <a id="5275" href="/lia/part5/Programs/#5262" class="Bound">x</a> <a id="5277" href="/lia/part5/Programs/#414" class="InductiveConstructor Operator">≔</a> <a id="5279" href="/lia/part5/Programs/#5264" class="Bound">e</a> <a id="5281" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5283" href="/lia/part5/Programs/#5266" class="Bound">s</a> <a id="5285" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="5287" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="5292" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5294" href="/lia/part5/Programs/#5266" class="Bound">s</a> <a id="5296" href="/lia/part0/Functions/#568" class="Function Operator">[</a> <a id="5298" href="/lia/part5/Programs/#5262" class="Bound">x</a> <a id="5300" href="/lia/part0/Functions/#568" class="Function Operator">↦</a> <a id="5302" href="/lia/part5/Exp/#2410" class="Function Operator">A⟦</a> <a id="5305" href="/lia/part5/Programs/#5264" class="Bound">e</a> <a id="5307" href="/lia/part5/Exp/#2410" class="Function Operator">⟧</a> <a id="5309" href="/lia/part5/Programs/#5266" class="Bound">s</a> <a id="5311" href="/lia/part0/Functions/#568" class="Function Operator">]</a></pre>

<h3 id="c-d-1"><code class="language-plaintext highlighter-rouge">c ⨟ d</code></h3>

<p>In the case of sequencing <code class="language-plaintext highlighter-rouge">c ⨟ d</code>, where are two cases.</p>

<p>In the case <code class="language-plaintext highlighter-rouge">↝-seq-left</code>, we evaluate one step of <code class="language-plaintext highlighter-rouge">c</code>. In the case
<code class="language-plaintext highlighter-rouge">↝-seq-right</code>, <code class="language-plaintext highlighter-rouge">c</code> has finished and we continue with <code class="language-plaintext highlighter-rouge">d</code>.</p>

<pre class="Agda">  <a id="_↝_.↝-seq-left"></a><a id="5520" href="/lia/part5/Programs/#5520" class="InductiveConstructor">↝-seq-left</a> <a id="5531" class="Symbol">:</a> <a id="5533" class="Symbol">∀</a> <a id="5535" class="Symbol">{</a><a id="5536" href="/lia/part5/Programs/#5536" class="Bound">c</a> <a id="5538" href="/lia/part5/Programs/#5538" class="Bound">s</a> <a id="5540" href="/lia/part5/Programs/#5540" class="Bound">c′</a> <a id="5543" href="/lia/part5/Programs/#5543" class="Bound">s′</a> <a id="5546" href="/lia/part5/Programs/#5546" class="Bound">d</a><a id="5547" class="Symbol">}</a> <a id="5549" class="Symbol">→</a>
    <a id="5555" href="/lia/part5/Programs/#5536" class="Bound">c</a> <a id="5557" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5559" href="/lia/part5/Programs/#5538" class="Bound">s</a> <a id="5561" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="5563" href="/lia/part5/Programs/#5540" class="Bound">c′</a> <a id="5566" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5568" href="/lia/part5/Programs/#5543" class="Bound">s′</a> <a id="5571" class="Symbol">→</a>
    <a id="5577" href="/lia/part5/Programs/#5536" class="Bound">c</a> <a id="5579" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="5581" href="/lia/part5/Programs/#5546" class="Bound">d</a> <a id="5583" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5585" href="/lia/part5/Programs/#5538" class="Bound">s</a> <a id="5587" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="5589" href="/lia/part5/Programs/#5540" class="Bound">c′</a> <a id="5592" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="5594" href="/lia/part5/Programs/#5546" class="Bound">d</a> <a id="5596" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5598" href="/lia/part5/Programs/#5543" class="Bound">s′</a>
    
  <a id="_↝_.↝-seq-right"></a><a id="5608" href="/lia/part5/Programs/#5608" class="InductiveConstructor">↝-seq-right</a> <a id="5620" class="Symbol">:</a> <a id="5622" class="Symbol">∀</a> <a id="5624" class="Symbol">{</a><a id="5625" href="/lia/part5/Programs/#5625" class="Bound">d</a> <a id="5627" href="/lia/part5/Programs/#5627" class="Bound">s</a><a id="5628" class="Symbol">}</a> <a id="5630" class="Symbol">→</a>
    <a id="5636" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="5641" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="5643" href="/lia/part5/Programs/#5625" class="Bound">d</a> <a id="5645" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5647" href="/lia/part5/Programs/#5627" class="Bound">s</a> <a id="5649" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="5651" href="/lia/part5/Programs/#5625" class="Bound">d</a> <a id="5653" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5655" href="/lia/part5/Programs/#5627" class="Bound">s</a></pre>

<h3 id="if-b-then-c-else-d-1"><code class="language-plaintext highlighter-rouge">if b then c else d</code></h3>

<p>The conditional has two symmetric cases, depending on whether the
condition evaluates to <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>.</p>

<pre class="Agda">  <a id="_↝_.↝-if-tt"></a><a id="5803" href="/lia/part5/Programs/#5803" class="InductiveConstructor">↝-if-tt</a> <a id="5811" class="Symbol">:</a> <a id="5813" class="Symbol">∀</a> <a id="5815" class="Symbol">{</a><a id="5816" href="/lia/part5/Programs/#5816" class="Bound">b</a> <a id="5818" href="/lia/part5/Programs/#5818" class="Bound">s</a> <a id="5820" href="/lia/part5/Programs/#5820" class="Bound">c</a> <a id="5822" href="/lia/part5/Programs/#5822" class="Bound">d</a><a id="5823" class="Symbol">}</a> <a id="5825" class="Symbol">→</a>
    <a id="5831" href="/lia/part5/Exp/#2717" class="Function Operator">B⟦</a> <a id="5834" href="/lia/part5/Programs/#5816" class="Bound">b</a> <a id="5836" href="/lia/part5/Exp/#2717" class="Function Operator">⟧</a> <a id="5838" href="/lia/part5/Programs/#5818" class="Bound">s</a> <a id="5840" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5842" href="/lia/part0/Booleans/#284" class="InductiveConstructor">tt</a> <a id="5845" class="Symbol">→</a>
    <a id="5851" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="5854" href="/lia/part5/Programs/#5816" class="Bound">b</a> <a id="5856" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="5861" href="/lia/part5/Programs/#5820" class="Bound">c</a> <a id="5863" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="5868" href="/lia/part5/Programs/#5822" class="Bound">d</a> <a id="5870" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5872" href="/lia/part5/Programs/#5818" class="Bound">s</a> <a id="5874" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="5876" href="/lia/part5/Programs/#5820" class="Bound">c</a> <a id="5878" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5880" href="/lia/part5/Programs/#5818" class="Bound">s</a>
    
  <a id="_↝_.↝-if-ff"></a><a id="5889" href="/lia/part5/Programs/#5889" class="InductiveConstructor">↝-if-ff</a> <a id="5897" class="Symbol">:</a> <a id="5899" class="Symbol">∀</a> <a id="5901" class="Symbol">{</a><a id="5902" href="/lia/part5/Programs/#5902" class="Bound">b</a> <a id="5904" href="/lia/part5/Programs/#5904" class="Bound">s</a> <a id="5906" href="/lia/part5/Programs/#5906" class="Bound">c</a> <a id="5908" href="/lia/part5/Programs/#5908" class="Bound">d</a><a id="5909" class="Symbol">}</a> <a id="5911" class="Symbol">→</a>
    <a id="5917" href="/lia/part5/Exp/#2717" class="Function Operator">B⟦</a> <a id="5920" href="/lia/part5/Programs/#5902" class="Bound">b</a> <a id="5922" href="/lia/part5/Exp/#2717" class="Function Operator">⟧</a> <a id="5924" href="/lia/part5/Programs/#5904" class="Bound">s</a> <a id="5926" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5928" href="/lia/part0/Booleans/#275" class="InductiveConstructor">ff</a> <a id="5931" class="Symbol">→</a>
    <a id="5937" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="5940" href="/lia/part5/Programs/#5902" class="Bound">b</a> <a id="5942" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="5947" href="/lia/part5/Programs/#5906" class="Bound">c</a> <a id="5949" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="5954" href="/lia/part5/Programs/#5908" class="Bound">d</a> <a id="5956" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5958" href="/lia/part5/Programs/#5904" class="Bound">s</a> <a id="5960" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="5962" href="/lia/part5/Programs/#5908" class="Bound">d</a> <a id="5964" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="5966" href="/lia/part5/Programs/#5904" class="Bound">s</a></pre>

<h3 id="while-b-do-c-1"><code class="language-plaintext highlighter-rouge">while b do: c</code></h3>

<p>The while looping construct also has two cases. If the condition <code class="language-plaintext highlighter-rouge">b</code>
evaluates to true, then the command rewrites to <code class="language-plaintext highlighter-rouge">c ⨟ while b do: c</code>.
Otherwise, it terminates rewriting to <code class="language-plaintext highlighter-rouge">skip</code>.</p>

<pre class="Agda">  <a id="_↝_.↝-while-tt"></a><a id="6185" href="/lia/part5/Programs/#6185" class="InductiveConstructor">↝-while-tt</a> <a id="6196" class="Symbol">:</a> <a id="6198" class="Symbol">∀</a> <a id="6200" class="Symbol">{</a><a id="6201" href="/lia/part5/Programs/#6201" class="Bound">b</a> <a id="6203" href="/lia/part5/Programs/#6203" class="Bound">c</a> <a id="6205" href="/lia/part5/Programs/#6205" class="Bound">s</a><a id="6206" class="Symbol">}</a> <a id="6208" class="Symbol">→</a>
    <a id="6214" href="/lia/part5/Exp/#2717" class="Function Operator">B⟦</a> <a id="6217" href="/lia/part5/Programs/#6201" class="Bound">b</a> <a id="6219" href="/lia/part5/Exp/#2717" class="Function Operator">⟧</a> <a id="6221" href="/lia/part5/Programs/#6205" class="Bound">s</a> <a id="6223" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6225" href="/lia/part0/Booleans/#284" class="InductiveConstructor">tt</a> <a id="6228" class="Symbol">→</a>
    <a id="6234" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="6240" href="/lia/part5/Programs/#6201" class="Bound">b</a> <a id="6242" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="6246" href="/lia/part5/Programs/#6203" class="Bound">c</a> <a id="6248" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="6250" href="/lia/part5/Programs/#6205" class="Bound">s</a> <a id="6252" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="6254" href="/lia/part5/Programs/#6203" class="Bound">c</a> <a id="6256" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="6258" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="6264" href="/lia/part5/Programs/#6201" class="Bound">b</a> <a id="6266" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="6270" href="/lia/part5/Programs/#6203" class="Bound">c</a> <a id="6272" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="6274" href="/lia/part5/Programs/#6205" class="Bound">s</a>
    
  <a id="_↝_.↝-while-ff"></a><a id="6283" href="/lia/part5/Programs/#6283" class="InductiveConstructor">↝-while-ff</a> <a id="6294" class="Symbol">:</a> <a id="6296" class="Symbol">∀</a> <a id="6298" class="Symbol">{</a><a id="6299" href="/lia/part5/Programs/#6299" class="Bound">b</a> <a id="6301" href="/lia/part5/Programs/#6301" class="Bound">c</a> <a id="6303" href="/lia/part5/Programs/#6303" class="Bound">s</a><a id="6304" class="Symbol">}</a> <a id="6306" class="Symbol">→</a>
    <a id="6312" href="/lia/part5/Exp/#2717" class="Function Operator">B⟦</a> <a id="6315" href="/lia/part5/Programs/#6299" class="Bound">b</a> <a id="6317" href="/lia/part5/Exp/#2717" class="Function Operator">⟧</a> <a id="6319" href="/lia/part5/Programs/#6303" class="Bound">s</a> <a id="6321" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6323" href="/lia/part0/Booleans/#275" class="InductiveConstructor">ff</a> <a id="6326" class="Symbol">→</a>
    <a id="6332" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="6338" href="/lia/part5/Programs/#6299" class="Bound">b</a> <a id="6340" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="6344" href="/lia/part5/Programs/#6301" class="Bound">c</a> <a id="6346" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="6348" href="/lia/part5/Programs/#6303" class="Bound">s</a> <a id="6350" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="6352" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="6357" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="6359" href="/lia/part5/Programs/#6303" class="Bound">s</a></pre>

<h2 id="transitive-closure">
<a class="anchor" href="#transitive-closure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Transitive closure <code class="language-plaintext highlighter-rouge">↝*</code>
</h2>

<p>In order to formalise this, we first need to be able to combine many
small steps together, i.e., we take the transitive closure of <code class="language-plaintext highlighter-rouge">_,_↝_,_</code>.</p>

<pre class="Agda"><a id="6541" class="Keyword">infix</a> <a id="6547" class="Number">3</a> <a id="6549" href="/lia/part5/Programs/#6559" class="Datatype Operator">_↝*_</a>
<a id="6554" class="Keyword">data</a> <a id="_↝*_"></a><a id="6559" href="/lia/part5/Programs/#6559" class="Datatype Operator">_↝*_</a> <a id="6564" class="Symbol">:</a> <a id="6566" href="/lia/part5/Programs/#4746" class="Function">Conf</a> <a id="6571" class="Symbol">→</a> <a id="6573" href="/lia/part5/Programs/#4746" class="Function">Conf</a> <a id="6578" class="Symbol">→</a> <a id="6580" class="PrimitiveType">Set</a> <a id="6584" class="Keyword">where</a>
  <a id="_↝*_.stop"></a><a id="6592" href="/lia/part5/Programs/#6592" class="InductiveConstructor">stop</a> <a id="6597" class="Symbol">:</a> <a id="6599" class="Symbol">∀</a> <a id="6601" class="Symbol">{</a><a id="6602" href="/lia/part5/Programs/#6602" class="Bound">x</a><a id="6603" class="Symbol">}</a> <a id="6605" class="Symbol">→</a> <a id="6607" href="/lia/part5/Programs/#6602" class="Bound">x</a> <a id="6609" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="6612" href="/lia/part5/Programs/#6602" class="Bound">x</a>
  <a id="_↝*_.one"></a><a id="6616" href="/lia/part5/Programs/#6616" class="InductiveConstructor">one</a> <a id="6620" class="Symbol">:</a> <a id="6622" class="Symbol">∀</a> <a id="6624" class="Symbol">{</a><a id="6625" href="/lia/part5/Programs/#6625" class="Bound">x</a> <a id="6627" href="/lia/part5/Programs/#6627" class="Bound">y</a> <a id="6629" href="/lia/part5/Programs/#6629" class="Bound">z</a><a id="6630" class="Symbol">}</a> <a id="6632" class="Symbol">→</a> <a id="6634" href="/lia/part5/Programs/#6625" class="Bound">x</a> <a id="6636" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="6638" href="/lia/part5/Programs/#6627" class="Bound">y</a> <a id="6640" class="Symbol">→</a> <a id="6642" href="/lia/part5/Programs/#6627" class="Bound">y</a> <a id="6644" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="6647" href="/lia/part5/Programs/#6629" class="Bound">z</a> <a id="6649" class="Symbol">→</a> <a id="6651" href="/lia/part5/Programs/#6625" class="Bound">x</a> <a id="6653" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="6656" href="/lia/part5/Programs/#6629" class="Bound">z</a></pre>

<h3 id="exercise-transitivity">
<strong>Exercise</strong>: Transitivity</h3>

<p>Show that the relation <code class="language-plaintext highlighter-rouge">↝*</code> on configurations is indeed transitive.
<em>Hint</em>: Do induction on <code class="language-plaintext highlighter-rouge">der1</code>.</p>

<pre class="Agda"><a id="↝*-trans"></a><a id="6800" href="/lia/part5/Programs/#6800" class="Function">↝*-trans</a> <a id="6809" class="Symbol">:</a> <a id="6811" class="Symbol">∀</a> <a id="6813" class="Symbol">{</a><a id="6814" href="/lia/part5/Programs/#6814" class="Bound">x</a> <a id="6816" href="/lia/part5/Programs/#6816" class="Bound">y</a> <a id="6818" href="/lia/part5/Programs/#6818" class="Bound">z</a><a id="6819" class="Symbol">}</a> <a id="6821" class="Symbol">→</a> <a id="6823" href="/lia/part5/Programs/#6814" class="Bound">x</a> <a id="6825" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="6828" href="/lia/part5/Programs/#6816" class="Bound">y</a> <a id="6830" class="Symbol">→</a> <a id="6832" href="/lia/part5/Programs/#6816" class="Bound">y</a> <a id="6834" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="6837" href="/lia/part5/Programs/#6818" class="Bound">z</a> <a id="6839" class="Symbol">→</a> <a id="6841" href="/lia/part5/Programs/#6814" class="Bound">x</a> <a id="6843" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="6846" href="/lia/part5/Programs/#6818" class="Bound">z</a>
<a id="6848" href="/lia/part5/Programs/#6800" class="Function">↝*-trans</a> <a id="6857" href="/lia/part5/Programs/#6592" class="InductiveConstructor">stop</a> <a id="6862" href="/lia/part5/Programs/#6862" class="Bound">δ₂</a> <a id="6865" class="Symbol">=</a> <a id="6867" href="/lia/part5/Programs/#6862" class="Bound">δ₂</a>
<a id="6870" href="/lia/part5/Programs/#6800" class="Function">↝*-trans</a> <a id="6879" class="Symbol">(</a><a id="6880" href="/lia/part5/Programs/#6616" class="InductiveConstructor">one</a> <a id="6884" href="/lia/part5/Programs/#6884" class="Bound">step</a> <a id="6889" href="/lia/part5/Programs/#6889" class="Bound">δ₁</a><a id="6891" class="Symbol">)</a> <a id="6893" href="/lia/part5/Programs/#6893" class="Bound">δ₂</a> <a id="6896" class="Symbol">=</a> <a id="6898" href="/lia/part5/Programs/#6616" class="InductiveConstructor">one</a> <a id="6902" href="/lia/part5/Programs/#6884" class="Bound">step</a> <a id="6907" class="Symbol">(</a><a id="6908" href="/lia/part5/Programs/#6800" class="Function">↝*-trans</a> <a id="6917" href="/lia/part5/Programs/#6889" class="Bound">δ₁</a> <a id="6920" href="/lia/part5/Programs/#6893" class="Bound">δ₂</a><a id="6922" class="Symbol">)</a></pre>

<h3 id="notation-for-transitive-closure">Notation for transitive closure</h3>

<p>The following suggestive notation will be useful for simplyfying
carrying out proofs involving <code class="language-plaintext highlighter-rouge">↝*</code>. They are entirely analogous to the
chain of equalities constructed with <code class="language-plaintext highlighter-rouge">≡⟨⟩</code>.</p>

<pre class="Agda"><a id="7152" class="Keyword">infix</a>  <a id="7159" class="Number">1</a> <a id="7161" href="/lia/part5/Programs/#7214" class="Function Operator">start_</a>
<a id="7168" class="Keyword">infixr</a> <a id="7175" class="Number">2</a> <a id="7177" href="/lia/part5/Programs/#7268" class="Function Operator">_↝*⟨⟩_</a> <a id="7184" href="/lia/part5/Programs/#7323" class="Function Operator">_↝⟨_⟩_</a> <a id="7191" href="/lia/part5/Programs/#7400" class="Function Operator">_↝*⟨_⟩_</a>
<a id="7199" class="Keyword">infix</a>  <a id="7206" class="Number">3</a> <a id="7208" href="/lia/part5/Programs/#7487" class="Function Operator">_end</a>

<a id="start_"></a><a id="7214" href="/lia/part5/Programs/#7214" class="Function Operator">start_</a> <a id="7221" class="Symbol">:</a> <a id="7223" class="Symbol">∀</a> <a id="7225" class="Symbol">{</a><a id="7226" href="/lia/part5/Programs/#7226" class="Bound">x</a> <a id="7228" href="/lia/part5/Programs/#7228" class="Bound">y</a><a id="7229" class="Symbol">}</a> <a id="7231" class="Symbol">→</a> <a id="7233" href="/lia/part5/Programs/#7226" class="Bound">x</a> <a id="7235" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7238" href="/lia/part5/Programs/#7228" class="Bound">y</a> <a id="7240" class="Symbol">→</a> <a id="7242" href="/lia/part5/Programs/#7226" class="Bound">x</a> <a id="7244" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7247" href="/lia/part5/Programs/#7228" class="Bound">y</a>
<a id="7249" href="/lia/part5/Programs/#7214" class="Function Operator">start</a> <a id="7255" href="/lia/part5/Programs/#7255" class="Bound">x↝*y</a> <a id="7260" class="Symbol">=</a> <a id="7262" href="/lia/part5/Programs/#7255" class="Bound">x↝*y</a>

<a id="_↝*⟨⟩_"></a><a id="7268" href="/lia/part5/Programs/#7268" class="Function Operator">_↝*⟨⟩_</a> <a id="7275" class="Symbol">:</a> <a id="7277" class="Symbol">∀</a> <a id="7279" href="/lia/part5/Programs/#7279" class="Bound">x</a> <a id="7281" class="Symbol">{</a><a id="7282" href="/lia/part5/Programs/#7282" class="Bound">y</a><a id="7283" class="Symbol">}</a> <a id="7285" class="Symbol">→</a> <a id="7287" href="/lia/part5/Programs/#7279" class="Bound">x</a> <a id="7289" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7292" href="/lia/part5/Programs/#7282" class="Bound">y</a> <a id="7294" class="Symbol">→</a> <a id="7296" href="/lia/part5/Programs/#7279" class="Bound">x</a> <a id="7298" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7301" href="/lia/part5/Programs/#7282" class="Bound">y</a>
<a id="7303" href="/lia/part5/Programs/#7303" class="Bound">x</a> <a id="7305" href="/lia/part5/Programs/#7268" class="Function Operator">↝*⟨⟩</a> <a id="7310" href="/lia/part5/Programs/#7310" class="Bound">x↝*y</a> <a id="7315" class="Symbol">=</a> <a id="7317" href="/lia/part5/Programs/#7310" class="Bound">x↝*y</a>

<a id="_↝⟨_⟩_"></a><a id="7323" href="/lia/part5/Programs/#7323" class="Function Operator">_↝⟨_⟩_</a> <a id="7330" class="Symbol">:</a> <a id="7332" class="Symbol">∀</a> <a id="7334" href="/lia/part5/Programs/#7334" class="Bound">x</a> <a id="7336" class="Symbol">{</a><a id="7337" href="/lia/part5/Programs/#7337" class="Bound">y</a> <a id="7339" href="/lia/part5/Programs/#7339" class="Bound">z</a><a id="7340" class="Symbol">}</a> <a id="7342" class="Symbol">→</a> <a id="7344" href="/lia/part5/Programs/#7334" class="Bound">x</a> <a id="7346" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="7348" href="/lia/part5/Programs/#7337" class="Bound">y</a> <a id="7350" class="Symbol">→</a> <a id="7352" href="/lia/part5/Programs/#7337" class="Bound">y</a> <a id="7354" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7357" href="/lia/part5/Programs/#7339" class="Bound">z</a> <a id="7359" class="Symbol">→</a> <a id="7361" href="/lia/part5/Programs/#7334" class="Bound">x</a> <a id="7363" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7366" href="/lia/part5/Programs/#7339" class="Bound">z</a>
<a id="7368" href="/lia/part5/Programs/#7368" class="Bound">x</a> <a id="7370" href="/lia/part5/Programs/#7323" class="Function Operator">↝⟨</a> <a id="7373" href="/lia/part5/Programs/#7373" class="Bound">x↝y</a> <a id="7377" href="/lia/part5/Programs/#7323" class="Function Operator">⟩</a> <a id="7379" href="/lia/part5/Programs/#7379" class="Bound">y↝*z</a> <a id="7384" class="Symbol">=</a> <a id="7386" href="/lia/part5/Programs/#6616" class="InductiveConstructor">one</a> <a id="7390" href="/lia/part5/Programs/#7373" class="Bound">x↝y</a> <a id="7394" href="/lia/part5/Programs/#7379" class="Bound">y↝*z</a>

<a id="_↝*⟨_⟩_"></a><a id="7400" href="/lia/part5/Programs/#7400" class="Function Operator">_↝*⟨_⟩_</a> <a id="7408" class="Symbol">:</a> <a id="7410" class="Symbol">∀</a> <a id="7412" href="/lia/part5/Programs/#7412" class="Bound">x</a> <a id="7414" class="Symbol">{</a><a id="7415" href="/lia/part5/Programs/#7415" class="Bound">y</a> <a id="7417" href="/lia/part5/Programs/#7417" class="Bound">z</a><a id="7418" class="Symbol">}</a> <a id="7420" class="Symbol">→</a> <a id="7422" href="/lia/part5/Programs/#7412" class="Bound">x</a> <a id="7424" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7427" href="/lia/part5/Programs/#7415" class="Bound">y</a> <a id="7429" class="Symbol">→</a> <a id="7431" href="/lia/part5/Programs/#7415" class="Bound">y</a> <a id="7433" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7436" href="/lia/part5/Programs/#7417" class="Bound">z</a> <a id="7438" class="Symbol">→</a> <a id="7440" href="/lia/part5/Programs/#7412" class="Bound">x</a> <a id="7442" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7445" href="/lia/part5/Programs/#7417" class="Bound">z</a>
<a id="7447" href="/lia/part5/Programs/#7447" class="Bound">x</a> <a id="7449" href="/lia/part5/Programs/#7400" class="Function Operator">↝*⟨</a> <a id="7453" href="/lia/part5/Programs/#7453" class="Bound">x↝*y</a> <a id="7458" href="/lia/part5/Programs/#7400" class="Function Operator">⟩</a> <a id="7460" href="/lia/part5/Programs/#7460" class="Bound">y↝*z</a> <a id="7465" class="Symbol">=</a> <a id="7467" href="/lia/part5/Programs/#6800" class="Function">↝*-trans</a> <a id="7476" href="/lia/part5/Programs/#7453" class="Bound">x↝*y</a> <a id="7481" href="/lia/part5/Programs/#7460" class="Bound">y↝*z</a>

<a id="_end"></a><a id="7487" href="/lia/part5/Programs/#7487" class="Function Operator">_end</a> <a id="7492" class="Symbol">:</a> <a id="7494" class="Symbol">∀</a> <a id="7496" href="/lia/part5/Programs/#7496" class="Bound">x</a> <a id="7498" class="Symbol">→</a> <a id="7500" href="/lia/part5/Programs/#7496" class="Bound">x</a> <a id="7502" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7505" href="/lia/part5/Programs/#7496" class="Bound">x</a>
<a id="7507" href="/lia/part5/Programs/#7507" class="Bound">x</a> <a id="7509" href="/lia/part5/Programs/#7487" class="Function Operator">end</a> <a id="7513" class="Symbol">=</a> <a id="7515" href="/lia/part5/Programs/#6592" class="InductiveConstructor">stop</a></pre>

<h3 id="exercise-a-lemma-about">
<strong>Exercise</strong>: A lemma about <code class="language-plaintext highlighter-rouge">⨟</code>
</h3>

<p>Our objective is to show that small steps and big steps semantics agree.</p>

<p>Before showing this, we need to prove a lemma connecting sequencing <code class="language-plaintext highlighter-rouge">⨟</code>
and <code class="language-plaintext highlighter-rouge">↝*</code>.</p>

<pre class="Agda"><a id="⨟-lemma-1"></a><a id="7723" href="/lia/part5/Programs/#7723" class="Function">⨟-lemma-1</a> <a id="7733" class="Symbol">:</a> <a id="7735" class="Symbol">∀</a> <a id="7737" class="Symbol">{</a><a id="7738" href="/lia/part5/Programs/#7738" class="Bound">c</a> <a id="7740" href="/lia/part5/Programs/#7740" class="Bound">d</a> <a id="7742" href="/lia/part5/Programs/#7742" class="Bound">s</a> <a id="7744" href="/lia/part5/Programs/#7744" class="Bound">s′</a> <a id="7747" href="/lia/part5/Programs/#7747" class="Bound">s′′</a><a id="7750" class="Symbol">}</a> <a id="7752" class="Symbol">→</a>
  <a id="7756" href="/lia/part5/Programs/#7738" class="Bound">c</a> <a id="7758" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="7760" href="/lia/part5/Programs/#7742" class="Bound">s</a> <a id="7762" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7765" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="7770" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="7772" href="/lia/part5/Programs/#7747" class="Bound">s′′</a> <a id="7776" class="Symbol">→</a>
  <a id="7780" href="/lia/part5/Programs/#7740" class="Bound">d</a> <a id="7782" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="7784" href="/lia/part5/Programs/#7747" class="Bound">s′′</a> <a id="7788" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7791" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="7796" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="7798" href="/lia/part5/Programs/#7744" class="Bound">s′</a> <a id="7801" class="Symbol">→</a>
  <a id="7805" href="/lia/part5/Programs/#7738" class="Bound">c</a> <a id="7807" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="7809" href="/lia/part5/Programs/#7740" class="Bound">d</a> <a id="7811" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="7813" href="/lia/part5/Programs/#7742" class="Bound">s</a> <a id="7815" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="7818" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="7823" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="7825" href="/lia/part5/Programs/#7744" class="Bound">s′</a>
<a id="7828" href="/lia/part5/Programs/#7723" class="Function">⨟-lemma-1</a> <a id="7838" href="/lia/part5/Programs/#6592" class="InductiveConstructor">stop</a> <a id="7843" href="/lia/part5/Programs/#7843" class="Bound">der2</a> <a id="7848" class="Symbol">=</a> <a id="7850" href="/lia/part5/Programs/#6616" class="InductiveConstructor">one</a> <a id="7854" href="/lia/part5/Programs/#5608" class="InductiveConstructor">↝-seq-right</a> <a id="7866" href="/lia/part5/Programs/#7843" class="Bound">der2</a>
<a id="7871" href="/lia/part5/Programs/#7723" class="Function">⨟-lemma-1</a> <a id="7881" class="Symbol">{</a><a id="7882" href="/lia/part5/Programs/#7882" class="Bound">c</a><a id="7883" class="Symbol">}</a> <a id="7885" class="Symbol">{</a><a id="7886" href="/lia/part5/Programs/#7886" class="Bound">d</a><a id="7887" class="Symbol">}</a> <a id="7889" class="Symbol">{</a><a id="7890" href="/lia/part5/Programs/#7890" class="Bound">s</a><a id="7891" class="Symbol">}</a> <a id="7893" class="Symbol">{</a><a id="7894" href="/lia/part5/Programs/#7894" class="Bound">s′</a><a id="7896" class="Symbol">}</a> <a id="7898" class="Symbol">{</a><a id="7899" href="/lia/part5/Programs/#7899" class="Bound">s′′</a><a id="7902" class="Symbol">}</a> <a id="7904" class="Symbol">(</a><a id="7905" href="/lia/part5/Programs/#6616" class="InductiveConstructor">one</a> <a id="7909" class="Symbol">{</a><a id="7910" class="Argument">y</a> <a id="7912" class="Symbol">=</a> <a id="7914" href="/lia/part5/Programs/#7914" class="Bound">c′</a> <a id="7917" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="7919" href="/lia/part5/Programs/#7919" class="Bound">s′′′</a><a id="7923" class="Symbol">}</a> <a id="7925" href="/lia/part5/Programs/#7925" class="Bound">der0</a> <a id="7930" href="/lia/part5/Programs/#7930" class="Bound">der1</a><a id="7934" class="Symbol">)</a> <a id="7936" href="/lia/part5/Programs/#7936" class="Bound">der2</a>
    <a id="7945" class="Keyword">with</a> <a id="7950" href="/lia/part5/Programs/#7723" class="Function">⨟-lemma-1</a> <a id="7960" href="/lia/part5/Programs/#7930" class="Bound">der1</a> <a id="7965" href="/lia/part5/Programs/#7936" class="Bound">der2</a>
<a id="7970" class="Symbol">...</a> <a id="7974" class="Symbol">|</a> <a id="7976" href="/lia/part5/Programs/#7976" class="Bound">der</a> <a id="7980" class="Symbol">=</a> <a id="7982" href="/lia/part5/Programs/#7214" class="Function Operator">start</a>
              <a id="8002" class="Bound">c</a> <a id="8004" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="8006" class="Bound">d</a> <a id="8008" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="8010" class="Bound">s</a> <a id="8012" href="/lia/part5/Programs/#7323" class="Function Operator">↝⟨</a> <a id="8015" href="/lia/part5/Programs/#5520" class="InductiveConstructor">↝-seq-left</a> <a id="8026" class="Bound">der0</a> <a id="8031" href="/lia/part5/Programs/#7323" class="Function Operator">⟩</a>
              <a id="8047" class="Bound">c′</a> <a id="8050" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="8052" class="Bound">d</a> <a id="8054" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="8056" class="Bound">s′′′</a> <a id="8061" href="/lia/part5/Programs/#7400" class="Function Operator">↝*⟨</a> <a id="8065" href="/lia/part5/Programs/#7976" class="Bound">der</a> <a id="8069" href="/lia/part5/Programs/#7400" class="Function Operator">⟩</a>
              <a id="8085" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="8090" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="8092" class="Bound">s′</a> 
            <a id="8108" href="/lia/part5/Programs/#7487" class="Function Operator">end</a></pre>

<h2 id="exercise-bigsmall">
<a class="anchor" href="#exercise-bigsmall" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Exercise</strong>: <code class="language-plaintext highlighter-rouge">big→small</code>
</h2>

<p>Once we have two alternative semantics for imperative programs, the
question arises as to whether they are equivalent.</p>

<p>We show that the big steps and the small steps operational semantics of
imperative programs yield the same results. There are two directions to
show.</p>

<p>We begin in this section with the easier direction <code class="language-plaintext highlighter-rouge">big→small</code>: the big
step semantics implies the small step one.</p>

<pre class="Agda"><a id="big→small"></a><a id="8538" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="8548" class="Symbol">:</a> <a id="8550" class="Symbol">∀</a> <a id="8552" href="/lia/part5/Programs/#8552" class="Bound">c</a> <a id="8554" href="/lia/part5/Programs/#8554" class="Bound">s</a> <a id="8556" href="/lia/part5/Programs/#8556" class="Bound">s′</a> <a id="8559" class="Symbol">→</a> <a id="8561" href="/lia/part5/Programs/#8552" class="Bound">c</a> <a id="8563" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="8565" href="/lia/part5/Programs/#8554" class="Bound">s</a> <a id="8567" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="8569" href="/lia/part5/Programs/#8556" class="Bound">s′</a> <a id="8572" class="Symbol">→</a> <a id="8574" href="/lia/part5/Programs/#8552" class="Bound">c</a> <a id="8576" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="8578" href="/lia/part5/Programs/#8554" class="Bound">s</a> <a id="8580" href="/lia/part5/Programs/#6559" class="Datatype Operator">↝*</a> <a id="8583" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="8588" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="8590" href="/lia/part5/Programs/#8556" class="Bound">s′</a></pre>

<h3 id="skip-x-e">
<code class="language-plaintext highlighter-rouge">skip</code>, <code class="language-plaintext highlighter-rouge">x ≔ e</code>
</h3>

<p>The proofs for the skip and assignment constructs are immediate.</p>

<pre class="Agda"><a id="8689" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="8699" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="8704" href="/lia/part5/Programs/#8704" class="Bound">s</a> <a id="8706" class="DottedPattern Symbol">.</a><a id="8707" href="/lia/part5/Programs/#8704" class="DottedPattern Bound">s</a> <a id="8709" href="/lia/part5/Programs/#1627" class="InductiveConstructor">⇒-skip</a> <a id="8716" class="Symbol">=</a> <a id="8718" href="/lia/part5/Programs/#6592" class="InductiveConstructor">stop</a>
<a id="8723" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="8733" class="Symbol">(</a><a id="8734" href="/lia/part5/Programs/#8734" class="Bound">x</a> <a id="8736" href="/lia/part5/Programs/#414" class="InductiveConstructor Operator">≔</a> <a id="8738" href="/lia/part5/Programs/#8738" class="Bound">e</a><a id="8739" class="Symbol">)</a> <a id="8741" href="/lia/part5/Programs/#8741" class="Bound">s</a> <a id="8743" class="DottedPattern Symbol">.(</a><a id="8745" href="/lia/part5/Programs/#8741" class="DottedPattern Bound">s</a> <a id="8747" href="/lia/part0/Functions/#568" class="DottedPattern Function Operator">[</a> <a id="8749" href="/lia/part5/Programs/#8734" class="DottedPattern Bound">x</a> <a id="8751" href="/lia/part0/Functions/#568" class="DottedPattern Function Operator">↦</a> <a id="8753" href="/lia/part5/Exp/#2410" class="DottedPattern Function Operator">A⟦</a> <a id="8756" href="/lia/part5/Programs/#8738" class="DottedPattern Bound">e</a> <a id="8758" href="/lia/part5/Exp/#2410" class="DottedPattern Function Operator">⟧</a> <a id="8760" href="/lia/part5/Programs/#8741" class="DottedPattern Bound">s</a> <a id="8762" href="/lia/part0/Functions/#568" class="DottedPattern Function Operator">]</a><a id="8763" class="DottedPattern Symbol">)</a> <a id="8765" href="/lia/part5/Programs/#1808" class="InductiveConstructor">⇒-assign</a> <a id="8774" class="Symbol">=</a> <a id="8776" href="/lia/part5/Programs/#6616" class="InductiveConstructor">one</a> <a id="8780" href="/lia/part5/Programs/#5248" class="InductiveConstructor">↝-assign</a> <a id="8789" href="/lia/part5/Programs/#6592" class="InductiveConstructor">stop</a></pre>

<h3 id="c-d-2"><code class="language-plaintext highlighter-rouge">c ⨟ d</code></h3>

<p>In the case of sequencing <code class="language-plaintext highlighter-rouge">c ⨟ d</code> we call the inductive assumption twice
and we collect the results.</p>

<pre class="Agda"><a id="8918" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="8928" class="Symbol">(</a><a id="8929" href="/lia/part5/Programs/#8929" class="Bound">c</a> <a id="8931" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="8933" href="/lia/part5/Programs/#8933" class="Bound">d</a><a id="8934" class="Symbol">)</a> <a id="8936" href="/lia/part5/Programs/#8936" class="Bound">s</a> <a id="8938" href="/lia/part5/Programs/#8938" class="Bound">s′</a> <a id="8941" class="Symbol">(</a><a id="8942" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="8948" class="Symbol">{</a><a id="8949" class="Argument">s′</a> <a id="8952" class="Symbol">=</a> <a id="8954" href="/lia/part5/Programs/#8954" class="Bound">s′′</a><a id="8957" class="Symbol">}</a> <a id="8959" href="/lia/part5/Programs/#8959" class="Bound">⇒-der1</a> <a id="8966" href="/lia/part5/Programs/#8966" class="Bound">⇒-der2</a><a id="8972" class="Symbol">)</a>
    <a id="8978" class="Keyword">with</a> <a id="8983" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="8993" href="/lia/part5/Programs/#8929" class="Bound">c</a> <a id="8995" href="/lia/part5/Programs/#8936" class="Bound">s</a> <a id="8997" href="/lia/part5/Programs/#8954" class="Bound">s′′</a> <a id="9001" href="/lia/part5/Programs/#8959" class="Bound">⇒-der1</a> <a id="9008" class="Symbol">|</a> <a id="9010" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="9020" href="/lia/part5/Programs/#8933" class="Bound">d</a> <a id="9022" href="/lia/part5/Programs/#8954" class="Bound">s′′</a> <a id="9026" href="/lia/part5/Programs/#8938" class="Bound">s′</a> <a id="9029" href="/lia/part5/Programs/#8966" class="Bound">⇒-der2</a>
<a id="9036" class="Symbol">...</a> <a id="9040" class="Symbol">|</a> <a id="9042" href="/lia/part5/Programs/#9042" class="Bound">↝*-der1</a> <a id="9050" class="Symbol">|</a> <a id="9052" href="/lia/part5/Programs/#9052" class="Bound">↝*-der2</a> <a id="9060" class="Symbol">=</a>
  <a id="9064" href="/lia/part5/Programs/#7214" class="Function Operator">start</a>
    <a id="9074" class="Bound">c</a> <a id="9076" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="9078" class="Bound">d</a> <a id="9080" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="9082" class="Bound">s</a> <a id="9084" href="/lia/part5/Programs/#7400" class="Function Operator">↝*⟨</a> <a id="9088" href="/lia/part5/Programs/#7723" class="Function">⨟-lemma-1</a> <a id="9098" href="/lia/part5/Programs/#9042" class="Bound">↝*-der1</a> <a id="9106" href="/lia/part5/Programs/#9052" class="Bound">↝*-der2</a> <a id="9114" href="/lia/part5/Programs/#7400" class="Function Operator">⟩</a>
    <a id="9120" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="9125" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="9127" class="Bound">s′</a>
  <a id="9132" href="/lia/part5/Programs/#7487" class="Function Operator">end</a></pre>

<h3 id="if-b-then-c-else-d-2"><code class="language-plaintext highlighter-rouge">if b then c else d</code></h3>

<p>The conditional construct has two cases, depending on whether the
condition holds or not.</p>

<pre class="Agda"><a id="9262" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="9272" class="Symbol">(</a><a id="9273" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="9276" href="/lia/part5/Programs/#9276" class="Bound">b</a> <a id="9278" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="9283" href="/lia/part5/Programs/#9283" class="Bound">c</a> <a id="9285" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="9290" href="/lia/part5/Programs/#9290" class="Bound">d</a><a id="9291" class="Symbol">)</a> <a id="9293" href="/lia/part5/Programs/#9293" class="Bound">s</a> <a id="9295" href="/lia/part5/Programs/#9295" class="Bound">s′</a> <a id="9298" class="Symbol">(</a><a id="9299" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="9307" href="/lia/part5/Programs/#9307" class="Bound">b≡true</a> <a id="9314" href="/lia/part5/Programs/#9314" class="Bound">⇒-der</a><a id="9319" class="Symbol">)</a>
    <a id="9325" class="Keyword">with</a> <a id="9330" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="9340" href="/lia/part5/Programs/#9283" class="Bound">c</a> <a id="9342" href="/lia/part5/Programs/#9293" class="Bound">s</a> <a id="9344" href="/lia/part5/Programs/#9295" class="Bound">s′</a> <a id="9347" href="/lia/part5/Programs/#9314" class="Bound">⇒-der</a>
<a id="9353" class="Symbol">...</a> <a id="9357" class="Symbol">|</a> <a id="9359" href="/lia/part5/Programs/#9359" class="Bound">↝*-der</a> <a id="9366" class="Symbol">=</a>
  <a id="9370" href="/lia/part5/Programs/#7214" class="Function Operator">start</a>
    <a id="9380" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="9383" class="Bound">b</a> <a id="9385" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="9390" class="Bound">c</a> <a id="9392" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="9397" class="Bound">d</a> <a id="9399" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="9401" class="Bound">s</a> <a id="9403" href="/lia/part5/Programs/#7323" class="Function Operator">↝⟨</a> <a id="9406" href="/lia/part5/Programs/#5803" class="InductiveConstructor">↝-if-tt</a> <a id="9414" class="Bound">b≡true</a> <a id="9421" href="/lia/part5/Programs/#7323" class="Function Operator">⟩</a>
    <a id="9427" class="Bound">c</a> <a id="9429" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="9431" class="Bound">s</a> <a id="9433" href="/lia/part5/Programs/#7400" class="Function Operator">↝*⟨</a> <a id="9437" href="/lia/part5/Programs/#9359" class="Bound">↝*-der</a> <a id="9444" href="/lia/part5/Programs/#7400" class="Function Operator">⟩</a>
    <a id="9450" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="9455" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="9457" class="Bound">s′</a>
  <a id="9462" href="/lia/part5/Programs/#7487" class="Function Operator">end</a>

<a id="9467" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="9477" class="Symbol">(</a><a id="9478" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="9481" href="/lia/part5/Programs/#9481" class="Bound">b</a> <a id="9483" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="9488" href="/lia/part5/Programs/#9488" class="Bound">c</a> <a id="9490" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="9495" href="/lia/part5/Programs/#9495" class="Bound">d</a><a id="9496" class="Symbol">)</a> <a id="9498" href="/lia/part5/Programs/#9498" class="Bound">s</a> <a id="9500" href="/lia/part5/Programs/#9500" class="Bound">s′</a> <a id="9503" class="Symbol">(</a><a id="9504" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="9512" href="/lia/part5/Programs/#9512" class="Bound">b≡false</a> <a id="9520" href="/lia/part5/Programs/#9520" class="Bound">⇒-der</a><a id="9525" class="Symbol">)</a>
    <a id="9531" class="Keyword">with</a> <a id="9536" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="9546" href="/lia/part5/Programs/#9495" class="Bound">d</a> <a id="9548" href="/lia/part5/Programs/#9498" class="Bound">s</a> <a id="9550" href="/lia/part5/Programs/#9500" class="Bound">s′</a> <a id="9553" href="/lia/part5/Programs/#9520" class="Bound">⇒-der</a>
<a id="9559" class="Symbol">...</a> <a id="9563" class="Symbol">|</a> <a id="9565" href="/lia/part5/Programs/#9565" class="Bound">↝*-der</a> <a id="9572" class="Symbol">=</a>
  <a id="9576" href="/lia/part5/Programs/#7214" class="Function Operator">start</a>
    <a id="9586" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="9589" class="Bound">b</a> <a id="9591" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="9596" class="Bound">c</a> <a id="9598" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="9603" class="Bound">d</a> <a id="9605" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="9607" class="Bound">s</a> <a id="9609" href="/lia/part5/Programs/#7323" class="Function Operator">↝⟨</a> <a id="9612" href="/lia/part5/Programs/#5889" class="InductiveConstructor">↝-if-ff</a> <a id="9620" class="Bound">b≡false</a> <a id="9628" href="/lia/part5/Programs/#7323" class="Function Operator">⟩</a>
    <a id="9634" class="Bound">d</a> <a id="9636" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="9638" class="Bound">s</a> <a id="9640" href="/lia/part5/Programs/#7400" class="Function Operator">↝*⟨</a> <a id="9644" href="/lia/part5/Programs/#9565" class="Bound">↝*-der</a> <a id="9651" href="/lia/part5/Programs/#7400" class="Function Operator">⟩</a>
    <a id="9657" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="9662" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="9664" class="Bound">s′</a>
  <a id="9669" href="/lia/part5/Programs/#7487" class="Function Operator">end</a></pre>

<h3 id="while-b-do-c-2"><code class="language-plaintext highlighter-rouge">while b do: c</code></h3>

<p>Finally, also for while loops there are two cases, depending on whether
the guard <code class="language-plaintext highlighter-rouge">b</code> holds or not. In the <code class="language-plaintext highlighter-rouge">true</code> case we apply the inductive
assumption twice.</p>

<pre class="Agda"><a id="9864" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="9874" class="Symbol">(</a><a id="9875" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="9881" href="/lia/part5/Programs/#9881" class="Bound">b</a> <a id="9883" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="9887" href="/lia/part5/Programs/#9887" class="Bound">c</a><a id="9888" class="Symbol">)</a> <a id="9890" href="/lia/part5/Programs/#9890" class="Bound">s</a> <a id="9892" href="/lia/part5/Programs/#9892" class="Bound">s′</a> <a id="9895" class="Symbol">(</a><a id="9896" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="9907" class="Symbol">{</a><a id="9908" class="Argument">s′</a> <a id="9911" class="Symbol">=</a> <a id="9913" href="/lia/part5/Programs/#9913" class="Bound">s′′</a><a id="9916" class="Symbol">}</a> <a id="9918" href="/lia/part5/Programs/#9918" class="Bound">b≡true</a> <a id="9925" href="/lia/part5/Programs/#9925" class="Bound">⇒-der1</a> <a id="9932" href="/lia/part5/Programs/#9932" class="Bound">⇒-der2</a><a id="9938" class="Symbol">)</a>
    <a id="9944" class="Keyword">with</a> <a id="9949" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="9959" href="/lia/part5/Programs/#9887" class="Bound">c</a> <a id="9961" href="/lia/part5/Programs/#9890" class="Bound">s</a> <a id="9963" href="/lia/part5/Programs/#9913" class="Bound">s′′</a> <a id="9967" href="/lia/part5/Programs/#9925" class="Bound">⇒-der1</a> <a id="9974" class="Symbol">|</a> <a id="9976" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="9986" class="Symbol">(</a><a id="9987" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="9993" href="/lia/part5/Programs/#9881" class="Bound">b</a> <a id="9995" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="9999" href="/lia/part5/Programs/#9887" class="Bound">c</a><a id="10000" class="Symbol">)</a> <a id="10002" href="/lia/part5/Programs/#9913" class="Bound">s′′</a> <a id="10006" href="/lia/part5/Programs/#9892" class="Bound">s′</a> <a id="10009" href="/lia/part5/Programs/#9932" class="Bound">⇒-der2</a>
<a id="10016" class="Symbol">...</a> <a id="10020" class="Symbol">|</a> <a id="10022" href="/lia/part5/Programs/#10022" class="Bound">↝*-der1</a> <a id="10030" class="Symbol">|</a> <a id="10032" href="/lia/part5/Programs/#10032" class="Bound">↝*-der2</a> <a id="10040" class="Symbol">=</a>
  <a id="10044" href="/lia/part5/Programs/#7214" class="Function Operator">start</a>
    <a id="10054" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="10060" class="Bound">b</a> <a id="10062" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="10066" class="Bound">c</a> <a id="10068" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="10070" class="Bound">s</a> <a id="10072" href="/lia/part5/Programs/#7323" class="Function Operator">↝⟨</a> <a id="10075" href="/lia/part5/Programs/#6185" class="InductiveConstructor">↝-while-tt</a> <a id="10086" class="Bound">b≡true</a> <a id="10093" href="/lia/part5/Programs/#7323" class="Function Operator">⟩</a>
    <a id="10099" class="Bound">c</a> <a id="10101" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="10103" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="10109" class="Bound">b</a> <a id="10111" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="10115" class="Bound">c</a> <a id="10117" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="10119" class="Bound">s</a>  <a id="10122" href="/lia/part5/Programs/#7400" class="Function Operator">↝*⟨</a> <a id="10126" href="/lia/part5/Programs/#7723" class="Function">⨟-lemma-1</a> <a id="10136" href="/lia/part5/Programs/#10022" class="Bound">↝*-der1</a> <a id="10144" href="/lia/part5/Programs/#10032" class="Bound">↝*-der2</a> <a id="10152" href="/lia/part5/Programs/#7400" class="Function Operator">⟩</a>
    <a id="10158" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="10163" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="10165" class="Bound">s′</a>
  <a id="10170" href="/lia/part5/Programs/#7487" class="Function Operator">end</a>  

<a id="10177" href="/lia/part5/Programs/#8538" class="Function">big→small</a> <a id="10187" class="Symbol">(</a><a id="10188" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="10194" href="/lia/part5/Programs/#10194" class="Bound">b</a> <a id="10196" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="10200" href="/lia/part5/Programs/#10200" class="Bound">c</a><a id="10201" class="Symbol">)</a> <a id="10203" href="/lia/part5/Programs/#10203" class="Bound">s</a> <a id="10205" class="DottedPattern Symbol">.</a><a id="10206" href="/lia/part5/Programs/#10203" class="DottedPattern Bound">s</a> <a id="10208" class="Symbol">(</a><a id="10209" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="10220" href="/lia/part5/Programs/#10220" class="Bound">b≡false</a><a id="10227" class="Symbol">)</a> <a id="10229" class="Symbol">=</a>
  <a id="10233" href="/lia/part5/Programs/#7214" class="Function Operator">start</a>
    <a id="10243" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="10249" href="/lia/part5/Programs/#10194" class="Bound">b</a> <a id="10251" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="10255" href="/lia/part5/Programs/#10200" class="Bound">c</a> <a id="10257" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="10259" href="/lia/part5/Programs/#10203" class="Bound">s</a> <a id="10261" href="/lia/part5/Programs/#7323" class="Function Operator">↝⟨</a> <a id="10264" href="/lia/part5/Programs/#6283" class="InductiveConstructor">↝-while-ff</a> <a id="10275" href="/lia/part5/Programs/#10220" class="Bound">b≡false</a> <a id="10283" href="/lia/part5/Programs/#7323" class="Function Operator">⟩</a>
    <a id="10289" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="10294" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="10296" href="/lia/part5/Programs/#10203" class="Bound">s</a>
  <a id="10300" href="/lia/part5/Programs/#7487" class="Function Operator">end</a></pre>

<h2 id="from-small-to-big-steps-first-attempt">
<a class="anchor" href="#from-small-to-big-steps-first-attempt" aria-hidden="true"><span class="octicon octicon-link"></span></a>From small to big steps: first attempt</h2>

<p>We turn now our attention to the other direction of the equivalence
between small and big steps operational semantics, namely</p>

<pre class="Agda"><a id="10483" class="Comment">-- small→big : ∀ c s s′ → c , s ↝* skip , s′ → c , s ⇒ s′</a></pre>

<p>A natural starting point is the converse of <code class="language-plaintext highlighter-rouge">⨟-lemma-1</code> above.</p>

<pre class="Agda"><a id="10614" class="Comment">-- ⨟-lemma-2 : ∀ {c d s s′} → c ⨟ d , s ↝* skip , s′ → ∃[ s′′ ] c , s ↝* skip , s′′ × d , s′′ ↝* skip , s′</a></pre>

<p>However, it turns out that the statement <code class="language-plaintext highlighter-rouge">small→big</code> above creates
problems for the termination checker in first <code class="language-plaintext highlighter-rouge">while</code> case (all the
other cases go through):</p>

<pre class="Agda"><a id="10891" class="Comment">-- small→big (while b do: c) s s′ (one (↝-while-tt b≡true) ↝*-der)</a>
<a id="10958" class="Comment">--     with ⨟-lemma-2 ↝*-der</a>
<a id="10987" class="Comment">-- ... | s′′ , ↝*-der1 , ↝*-der2</a>
<a id="11020" class="Comment">--     with small→big c s s′′ ↝*-der1 |</a>
<a id="11060" class="Comment">--          ? {- small→big (while b do: c) s′′ s′ ↝*-der2 -}</a>
<a id="11121" class="Comment">-- ... | ⇒-der1 | ⇒-der2 = ⇒-while-tt b≡true ⇒-der1 ⇒-der2</a>
<a id="11180" class="Comment">-- small→big _ _ _ _ = ?</a></pre>

<p>The issue with the commented code above is that no argument of the call</p>

<pre class="Agda"><a id="11287" class="Comment">-- small→big (while b do: c) s′′ s′ ↝*-der2</a></pre>

<p>is structurally smaller than the original call.</p>

<p>What is missing here is an argument to convince the termination checker
that <code class="language-plaintext highlighter-rouge">↝*-der2</code> is “smaller” than <code class="language-plaintext highlighter-rouge">↝*-der</code>. In order to formalise this,
we need to refine the <code class="language-plaintext highlighter-rouge">↝*</code> relation in order to take into account the
<em>number</em> of derivation steps.</p>

<h2 id="transitive-closure-with-gas">
<a class="anchor" href="#transitive-closure-with-gas" aria-hidden="true"><span class="octicon octicon-link"></span></a>Transitive closure with gas</h2>

<p>The idea is to enrich the transitive closure relation with the
information about how many derivation steps have been made so far.</p>

<pre class="Agda"><a id="11797" class="Keyword">infix</a> <a id="11803" class="Number">3</a> <a id="11805" href="/lia/part5/Programs/#11817" class="Datatype Operator">_↝*_#_</a>
<a id="11812" class="Keyword">data</a> <a id="_↝*_#_"></a><a id="11817" href="/lia/part5/Programs/#11817" class="Datatype Operator">_↝*_#_</a> <a id="11824" class="Symbol">:</a> <a id="11826" href="/lia/part5/Programs/#4746" class="Function">Conf</a> <a id="11831" class="Symbol">→</a> <a id="11833" href="/lia/part5/Programs/#4746" class="Function">Conf</a> <a id="11838" class="Symbol">→</a> <a id="11840" href="/lia/part0/Naturals/#301" class="Function">ℕ</a> <a id="11842" class="Symbol">→</a> <a id="11844" class="PrimitiveType">Set</a> <a id="11848" class="Keyword">where</a>
  <a id="_↝*_#_.stop"></a><a id="11856" href="/lia/part5/Programs/#11856" class="InductiveConstructor">stop</a> <a id="11861" class="Symbol">:</a> <a id="11863" class="Symbol">∀</a> <a id="11865" class="Symbol">{</a><a id="11866" href="/lia/part5/Programs/#11866" class="Bound">x</a><a id="11867" class="Symbol">}</a> <a id="11869" class="Symbol">→</a> <a id="11871" href="/lia/part5/Programs/#11866" class="Bound">x</a> <a id="11873" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="11876" href="/lia/part5/Programs/#11866" class="Bound">x</a> <a id="11878" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="11880" class="Number">0</a>
  <a id="_↝*_#_.one"></a><a id="11884" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="11888" class="Symbol">:</a> <a id="11890" class="Symbol">∀</a> <a id="11892" class="Symbol">{</a><a id="11893" href="/lia/part5/Programs/#11893" class="Bound">x</a> <a id="11895" href="/lia/part5/Programs/#11895" class="Bound">y</a> <a id="11897" href="/lia/part5/Programs/#11897" class="Bound">z</a> <a id="11899" href="/lia/part5/Programs/#11899" class="Bound">n</a><a id="11900" class="Symbol">}</a> <a id="11902" class="Symbol">→</a> <a id="11904" href="/lia/part5/Programs/#11893" class="Bound">x</a> <a id="11906" href="/lia/part5/Programs/#4917" class="Datatype Operator">↝</a> <a id="11908" href="/lia/part5/Programs/#11895" class="Bound">y</a> <a id="11910" class="Symbol">→</a> <a id="11912" href="/lia/part5/Programs/#11895" class="Bound">y</a> <a id="11914" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="11917" href="/lia/part5/Programs/#11897" class="Bound">z</a> <a id="11919" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="11921" href="/lia/part5/Programs/#11899" class="Bound">n</a> <a id="11923" class="Symbol">→</a> <a id="11925" href="/lia/part5/Programs/#11893" class="Bound">x</a> <a id="11927" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="11930" href="/lia/part5/Programs/#11897" class="Bound">z</a> <a id="11932" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="11934" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="11938" href="/lia/part5/Programs/#11899" class="Bound">n</a></pre>

<p>In the base case <code class="language-plaintext highlighter-rouge">stop</code> we terminate the computation immediately with
<code class="language-plaintext highlighter-rouge">0</code> number of steps, and in the inductive case <code class="language-plaintext highlighter-rouge">one</code> we add an extra
step to the number of steps <code class="language-plaintext highlighter-rouge">n</code> performed inductively.</p>

<h3 id="exercise-a-second-lemma-about">
<strong>Exercise</strong>: A second lemma about <code class="language-plaintext highlighter-rouge">⨟</code>
</h3>

<p>We can now prove the converse of <code class="language-plaintext highlighter-rouge">⨟-lemma-1</code> above in the richer setting
offered by <code class="language-plaintext highlighter-rouge">_↝*_#_</code>.</p>

<p>(Also <code class="language-plaintext highlighter-rouge">⨟-lemma-1</code> can be generalised to <code class="language-plaintext highlighter-rouge">_↝*_#_</code>, but we won′t need it
here.)</p>

<pre class="Agda"><a id="⨟-lemma-2"></a><a id="12363" href="/lia/part5/Programs/#12363" class="Function">⨟-lemma-2</a> <a id="12373" class="Symbol">:</a> <a id="12375" class="Symbol">∀</a> <a id="12377" class="Symbol">{</a><a id="12378" href="/lia/part5/Programs/#12378" class="Bound">c</a> <a id="12380" href="/lia/part5/Programs/#12380" class="Bound">d</a> <a id="12382" href="/lia/part5/Programs/#12382" class="Bound">s</a> <a id="12384" href="/lia/part5/Programs/#12384" class="Bound">s′</a> <a id="12387" href="/lia/part5/Programs/#12387" class="Bound">m</a><a id="12388" class="Symbol">}</a> <a id="12390" class="Symbol">→</a>
  <a id="12394" href="/lia/part5/Programs/#12378" class="Bound">c</a> <a id="12396" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="12398" href="/lia/part5/Programs/#12380" class="Bound">d</a> <a id="12400" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12402" href="/lia/part5/Programs/#12382" class="Bound">s</a> <a id="12404" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="12407" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="12412" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12414" href="/lia/part5/Programs/#12384" class="Bound">s′</a> <a id="12417" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="12419" href="/lia/part5/Programs/#12387" class="Bound">m</a> <a id="12421" class="Symbol">→</a>
  <a id="12425" href="/lia/part0/Logic/#461" class="Function">∃[</a> <a id="12428" href="/lia/part5/Programs/#12428" class="Bound">s′′</a> <a id="12432" href="/lia/part0/Logic/#461" class="Function">]</a> <a id="12434" href="/lia/part0/Logic/#461" class="Function">∃[</a> <a id="12437" href="/lia/part5/Programs/#12437" class="Bound">m1</a> <a id="12440" href="/lia/part0/Logic/#461" class="Function">]</a> <a id="12442" href="/lia/part0/Logic/#461" class="Function">∃[</a> <a id="12445" href="/lia/part5/Programs/#12445" class="Bound">m2</a> <a id="12448" href="/lia/part0/Logic/#461" class="Function">]</a>
      <a id="12456" href="/lia/part5/Programs/#12378" class="Bound">c</a> <a id="12458" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12460" href="/lia/part5/Programs/#12382" class="Bound">s</a> <a id="12462" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="12465" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="12470" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12472" href="/lia/part5/Programs/#12428" class="Bound">s′′</a> <a id="12476" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="12478" href="/lia/part5/Programs/#12437" class="Bound">m1</a> <a id="12481" href="/lia/part0/Logic/#1770" class="Record Operator">×</a>
      <a id="12489" href="/lia/part5/Programs/#12380" class="Bound">d</a> <a id="12491" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12493" href="/lia/part5/Programs/#12428" class="Bound">s′′</a> <a id="12497" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="12500" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="12505" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12507" href="/lia/part5/Programs/#12384" class="Bound">s′</a> <a id="12510" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="12512" href="/lia/part5/Programs/#12445" class="Bound">m2</a> <a id="12515" href="/lia/part0/Logic/#1770" class="Record Operator">×</a>
      <a id="12523" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="12527" class="Symbol">(</a><a id="12528" href="/lia/part5/Programs/#12437" class="Bound">m1</a> <a id="12531" href="/lia/part0/Naturals/#266" class="Primitive Operator">+ℕ</a> <a id="12534" href="/lia/part5/Programs/#12445" class="Bound">m2</a><a id="12536" class="Symbol">)</a> <a id="12538" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="12540" href="/lia/part5/Programs/#12387" class="Bound">m</a>
<a id="12542" href="/lia/part5/Programs/#12363" class="Function">⨟-lemma-2</a> <a id="12552" class="Symbol">(</a><a id="12553" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="12557" class="Symbol">(</a><a id="12558" href="/lia/part5/Programs/#5520" class="InductiveConstructor">↝-seq-left</a> <a id="12569" href="/lia/part5/Programs/#12569" class="Bound">step</a><a id="12573" class="Symbol">)</a> <a id="12575" href="/lia/part5/Programs/#12575" class="Bound">↝-der</a><a id="12580" class="Symbol">)</a>
    <a id="12586" class="Keyword">with</a> <a id="12591" href="/lia/part5/Programs/#12363" class="Function">⨟-lemma-2</a> <a id="12601" href="/lia/part5/Programs/#12575" class="Bound">↝-der</a>
<a id="12607" class="Symbol">...</a> <a id="12611" class="Symbol">|</a> <a id="12613" href="/lia/part5/Programs/#12613" class="Bound">s′′</a> <a id="12617" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12619" href="/lia/part5/Programs/#12619" class="Bound">m1</a> <a id="12622" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12624" href="/lia/part5/Programs/#12624" class="Bound">m2</a> <a id="12627" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12629" href="/lia/part5/Programs/#12629" class="Bound">der1</a> <a id="12634" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12636" href="/lia/part5/Programs/#12636" class="Bound">der2</a> <a id="12641" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12643" href="/lia/part5/Programs/#12643" class="Bound">m1+m2≡n</a> <a id="12651" class="Symbol">=</a>
    <a id="12657" href="/lia/part5/Programs/#12613" class="Bound">s′′</a> <a id="12661" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12663" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="12667" href="/lia/part5/Programs/#12619" class="Bound">m1</a> <a id="12670" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12672" href="/lia/part5/Programs/#12624" class="Bound">m2</a> <a id="12675" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12677" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="12681" class="Bound">step</a> <a id="12686" href="/lia/part5/Programs/#12629" class="Bound">der1</a> <a id="12691" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12693" href="/lia/part5/Programs/#12636" class="Bound">der2</a> <a id="12698" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12700" href="/lia/part0/Equality/#883" class="Function">cong</a> <a id="12705" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="12709" href="/lia/part5/Programs/#12643" class="Bound">m1+m2≡n</a>
<a id="12717" href="/lia/part5/Programs/#12363" class="Function">⨟-lemma-2</a> <a id="12727" class="Symbol">{</a><a id="12728" class="Argument">s</a> <a id="12730" class="Symbol">=</a> <a id="12732" href="/lia/part5/Programs/#12732" class="Bound">s</a><a id="12733" class="Symbol">}</a> <a id="12735" class="Symbol">(</a><a id="12736" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="12740" class="Symbol">{</a><a id="12741" class="Argument">n</a> <a id="12743" class="Symbol">=</a> <a id="12745" href="/lia/part5/Programs/#12745" class="Bound">n</a><a id="12746" class="Symbol">}</a> <a id="12748" href="/lia/part5/Programs/#5608" class="InductiveConstructor">↝-seq-right</a> <a id="12760" href="/lia/part5/Programs/#12760" class="Bound">↝-der</a><a id="12765" class="Symbol">)</a> <a id="12767" class="Symbol">=</a>
    <a id="12773" href="/lia/part5/Programs/#12732" class="Bound">s</a> <a id="12775" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12777" class="Number">0</a> <a id="12779" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12781" href="/lia/part5/Programs/#12745" class="Bound">n</a> <a id="12783" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="12785" href="/lia/part5/Programs/#11856" class="InductiveConstructor">stop</a> <a id="12790" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12792" href="/lia/part5/Programs/#12760" class="Bound">↝-der</a> <a id="12798" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="12800" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a></pre>

<h3 id="exercise-skip-and">
<strong>Exercise</strong>: <code class="language-plaintext highlighter-rouge">skip</code> and <code class="language-plaintext highlighter-rouge">↝*</code>
</h3>

<p>Show that executing the <code class="language-plaintext highlighter-rouge">skip</code> command necessarily terminates in <code class="language-plaintext highlighter-rouge">0</code>
steps.</p>

<p><em>Hint</em>: Convince Agda that only the case <code class="language-plaintext highlighter-rouge">stop</code> needs to be considered.</p>

<pre class="Agda"><a id="↝*-skip"></a><a id="12999" href="/lia/part5/Programs/#12999" class="Function">↝*-skip</a> <a id="13007" class="Symbol">:</a> <a id="13009" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="13014" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13016" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="13018" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="13021" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="13023" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13025" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="13028" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="13030" href="/lia/part5/Programs/#1281" class="Generalizable">m</a> <a id="13032" class="Symbol">→</a>
          <a id="13044" class="Comment">-------------------------</a>
          <a id="13080" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="13082" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13084" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="13089" href="/lia/part0/Logic/#1770" class="Record Operator">×</a> <a id="13091" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="13093" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13095" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="13098" href="/lia/part0/Logic/#1770" class="Record Operator">×</a> <a id="13100" href="/lia/part5/Programs/#1281" class="Generalizable">m</a> <a id="13102" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="13104" class="Number">0</a>
<a id="13106" href="/lia/part5/Programs/#12999" class="Function">↝*-skip</a> <a id="13114" href="/lia/part5/Programs/#11856" class="InductiveConstructor">stop</a> <a id="13119" class="Symbol">=</a> <a id="13121" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="13126" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13128" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="13133" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13135" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a></pre>

<h2 id="exercise-smallbig">
<a class="anchor" href="#exercise-smallbig" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Exercise</strong>: <code class="language-plaintext highlighter-rouge">small→big</code>
</h2>

<p>We are now ready to prove that the small step semantics implies the big
step one.</p>

<pre class="Agda"><a id="small→big"></a><a id="13262" href="/lia/part5/Programs/#13262" class="Function">small→big</a> <a id="13272" class="Symbol">:</a> <a id="13274" class="Symbol">∀</a> <a id="13276" href="/lia/part5/Programs/#13276" class="Bound">c</a> <a id="13278" href="/lia/part5/Programs/#13278" class="Bound">s</a> <a id="13280" href="/lia/part5/Programs/#13280" class="Bound">s′</a> <a id="13283" href="/lia/part5/Programs/#13283" class="Bound">n</a> <a id="13285" class="Symbol">→</a> <a id="13287" href="/lia/part5/Programs/#13276" class="Bound">c</a> <a id="13289" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13291" href="/lia/part5/Programs/#13278" class="Bound">s</a> <a id="13293" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="13296" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="13301" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13303" href="/lia/part5/Programs/#13280" class="Bound">s′</a> <a id="13306" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="13308" href="/lia/part5/Programs/#13283" class="Bound">n</a> <a id="13310" class="Symbol">→</a> <a id="13312" href="/lia/part5/Programs/#13276" class="Bound">c</a> <a id="13314" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="13316" href="/lia/part5/Programs/#13278" class="Bound">s</a> <a id="13318" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="13320" href="/lia/part5/Programs/#13280" class="Bound">s′</a>
<a id="13323" href="/lia/part5/Programs/#13262" class="Function">small→big</a> <a id="13333" href="/lia/part5/Programs/#13333" class="Bound">c</a> <a id="13335" href="/lia/part5/Programs/#13335" class="Bound">s</a> <a id="13337" href="/lia/part5/Programs/#13337" class="Bound">s′</a> <a id="13340" href="/lia/part5/Programs/#13340" class="Bound">n</a> <a id="13342" href="/lia/part5/Programs/#13342" class="Bound">↝*-der</a> <a id="13349" class="Symbol">=</a> <a id="13351" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="13354" href="/lia/part5/Programs/#13333" class="Bound">c</a> <a id="13356" href="/lia/part5/Programs/#13335" class="Bound">s</a> <a id="13358" href="/lia/part5/Programs/#13337" class="Bound">s′</a> <a id="13361" href="/lia/part5/Programs/#13340" class="Bound">n</a> <a id="13363" href="/lia/part5/Programs/#13342" class="Bound">↝*-der</a> <a id="13370" class="Symbol">(</a><a id="13371" href="/lia/part0/WellFounded/#654" class="Function">&lt;-wf</a> <a id="13376" href="/lia/part5/Programs/#13340" class="Bound">n</a><a id="13377" class="Symbol">)</a> <a id="13379" class="Keyword">where</a>

 <a id="13387" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="13390" class="Symbol">:</a> <a id="13392" class="Symbol">∀</a> <a id="13394" href="/lia/part5/Programs/#13394" class="Bound">c</a> <a id="13396" href="/lia/part5/Programs/#13396" class="Bound">s</a> <a id="13398" href="/lia/part5/Programs/#13398" class="Bound">s′</a> <a id="13401" href="/lia/part5/Programs/#13401" class="Bound">n</a> <a id="13403" class="Symbol">→</a> <a id="13405" href="/lia/part5/Programs/#13394" class="Bound">c</a> <a id="13407" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13409" href="/lia/part5/Programs/#13396" class="Bound">s</a> <a id="13411" href="/lia/part5/Programs/#11817" class="Datatype Operator">↝*</a> <a id="13414" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="13419" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13421" href="/lia/part5/Programs/#13398" class="Bound">s′</a> <a id="13424" href="/lia/part5/Programs/#11817" class="Datatype Operator">#</a> <a id="13426" href="/lia/part5/Programs/#13401" class="Bound">n</a> <a id="13428" class="Symbol">→</a> <a id="13430" href="/lia/part0/WellFounded/#434" class="Datatype">Acc</a> <a id="13434" href="/lia/part0/Naturals/#1314" class="Function Operator">_&lt;_</a> <a id="13438" href="/lia/part5/Programs/#13401" class="Bound">n</a> <a id="13440" class="Symbol">→</a> <a id="13442" href="/lia/part5/Programs/#13394" class="Bound">c</a> <a id="13444" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="13446" href="/lia/part5/Programs/#13396" class="Bound">s</a> <a id="13448" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="13450" href="/lia/part5/Programs/#13398" class="Bound">s′</a></pre>

<p>We employ a helper function <code class="language-plaintext highlighter-rouge">go</code> which has an additional parameter
<code class="language-plaintext highlighter-rouge">Acc n</code> allowing us to do well-founded induction in the crucial <code class="language-plaintext highlighter-rouge">while</code>
case below.</p>

<h3 id="skip-1"><code class="language-plaintext highlighter-rouge">skip</code></h3>

<p>The <code class="language-plaintext highlighter-rouge">skip</code> case is immediate.</p>

<pre class="Agda"> <a id="13658" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="13661" href="/lia/part5/Programs/#401" class="InductiveConstructor">skip</a> <a id="13666" href="/lia/part5/Programs/#13666" class="Bound">s</a> <a id="13668" class="DottedPattern Symbol">.</a><a id="13669" href="/lia/part5/Programs/#13666" class="DottedPattern Bound">s</a> <a id="13671" class="Number">0</a> <a id="13673" href="/lia/part5/Programs/#11856" class="InductiveConstructor">stop</a> <a id="13678" class="Symbol">_</a> <a id="13680" class="Symbol">=</a> <a id="13682" href="/lia/part5/Programs/#1627" class="InductiveConstructor">⇒-skip</a></pre>

<h3 id="x-e-2"><code class="language-plaintext highlighter-rouge">x ≔ e</code></h3>

<p>In the assignment case we call <code class="language-plaintext highlighter-rouge">↝*-skip ↝*-der</code> to enure that
<code class="language-plaintext highlighter-rouge">s′ ≡ s [ x ↦ ⟦ e ⟧A s ]</code> as required by <code class="language-plaintext highlighter-rouge">⇒-assign</code>.</p>

<pre class="Agda"> <a id="13828" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="13831" class="Symbol">(</a><a id="13832" href="/lia/part5/Programs/#13832" class="Bound">x</a> <a id="13834" href="/lia/part5/Programs/#414" class="InductiveConstructor Operator">≔</a> <a id="13836" href="/lia/part5/Programs/#13836" class="Bound">e</a><a id="13837" class="Symbol">)</a> <a id="13839" href="/lia/part5/Programs/#13839" class="Bound">s</a> <a id="13841" href="/lia/part5/Programs/#13841" class="Bound">s′</a> <a id="13844" class="Symbol">(</a><a id="13845" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="13849" href="/lia/part5/Programs/#13849" class="Bound">m</a><a id="13850" class="Symbol">)</a> <a id="13852" class="Symbol">(</a><a id="13853" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="13857" href="/lia/part5/Programs/#5248" class="InductiveConstructor">↝-assign</a> <a id="13866" href="/lia/part5/Programs/#13866" class="Bound">↝*-der</a><a id="13872" class="Symbol">)</a> <a id="13874" class="Symbol">_</a>
     <a id="13881" class="Keyword">with</a> <a id="13886" href="/lia/part5/Programs/#12999" class="Function">↝*-skip</a> <a id="13894" href="/lia/part5/Programs/#13866" class="Bound">↝*-der</a>
 <a id="13902" class="Symbol">...</a> <a id="13906" class="Symbol">|</a> <a id="13908" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="13913" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13915" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="13920" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="13922" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="13927" class="Symbol">=</a> <a id="13929" href="/lia/part5/Programs/#1808" class="InductiveConstructor">⇒-assign</a></pre>

<h3 id="c-d-3"><code class="language-plaintext highlighter-rouge">c ⨟ d</code></h3>

<p>In the sequencing case we first call <code class="language-plaintext highlighter-rouge">⨟-lemma-2 ↝*-der</code> to discover that</p>

<ol>
  <li>
<code class="language-plaintext highlighter-rouge">↝*-der1 : c , s ↝* skip , s′′ # _</code>, and</li>
  <li>
<code class="language-plaintext highlighter-rouge">↝*-der2 : d , s′′ ↝* skip , s′ # _</code>.</li>
</ol>

<p>With this information in hand, we recursively call <code class="language-plaintext highlighter-rouge">small→big</code> on the
subcomputations <code class="language-plaintext highlighter-rouge">↝*-der1</code>, <code class="language-plaintext highlighter-rouge">↝*-der2</code> and we assemble the results back
with <code class="language-plaintext highlighter-rouge">⇒-seq</code>.</p>

<pre class="Agda"> <a id="14276" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="14279" class="Symbol">(</a><a id="14280" href="/lia/part5/Programs/#14280" class="Bound">c</a> <a id="14282" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="14284" href="/lia/part5/Programs/#14284" class="Bound">d</a><a id="14285" class="Symbol">)</a> <a id="14287" href="/lia/part5/Programs/#14287" class="Bound">s</a> <a id="14289" href="/lia/part5/Programs/#14289" class="Bound">s′</a> <a id="14292" class="Symbol">(</a><a id="14293" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="14297" href="/lia/part5/Programs/#14297" class="Bound">m</a><a id="14298" class="Symbol">)</a> <a id="14300" href="/lia/part5/Programs/#14300" class="Bound">↝*-der</a> <a id="14307" class="Symbol">(</a><a id="14308" href="/lia/part0/WellFounded/#506" class="InductiveConstructor">acc</a> <a id="14312" href="/lia/part5/Programs/#14312" class="Bound">a</a><a id="14313" class="Symbol">)</a>
     <a id="14320" class="Keyword">with</a> <a id="14325" href="/lia/part5/Programs/#12363" class="Function">⨟-lemma-2</a> <a id="14335" href="/lia/part5/Programs/#14300" class="Bound">↝*-der</a>
 <a id="14343" class="Symbol">...</a> <a id="14347" class="Symbol">|</a> <a id="14349" href="/lia/part5/Programs/#14349" class="Bound">s′′</a> <a id="14353" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="14355" href="/lia/part5/Programs/#14355" class="Bound">m1</a> <a id="14358" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="14360" href="/lia/part5/Programs/#14360" class="Bound">m2</a> <a id="14363" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="14365" href="/lia/part5/Programs/#14365" class="Bound">↝*-der1</a> <a id="14373" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="14375" href="/lia/part5/Programs/#14375" class="Bound">↝*-der2</a> <a id="14383" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="14385" class="Symbol">_</a>
     <a id="14392" class="Keyword">with</a> <a id="14397" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="14400" class="Bound">c</a> <a id="14402" class="Bound">s</a> <a id="14404" href="/lia/part5/Programs/#14349" class="Bound">s′′</a> <a id="14408" href="/lia/part5/Programs/#14355" class="Bound">m1</a> <a id="14411" href="/lia/part5/Programs/#14365" class="Bound">↝*-der1</a> <a id="14419" class="Symbol">(</a><a id="14420" class="Bound">a</a> <a id="14422" href="/lia/part5/Programs/#14355" class="Bound">m1</a> <a id="14425" class="Symbol">{!   !})</a> <a id="14434" class="Symbol">|</a> <a id="14436" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="14439" class="Bound">d</a> <a id="14441" href="/lia/part5/Programs/#14349" class="Bound">s′′</a> <a id="14445" class="Bound">s′</a> <a id="14448" href="/lia/part5/Programs/#14360" class="Bound">m2</a> <a id="14451" href="/lia/part5/Programs/#14375" class="Bound">↝*-der2</a> <a id="14459" class="Symbol">{!   !}</a>
 <a id="14468" class="Symbol">...</a> <a id="14472" class="Symbol">|</a> <a id="14474" href="/lia/part5/Programs/#14474" class="Bound">⇒-der1</a> <a id="14481" class="Symbol">|</a> <a id="14483" href="/lia/part5/Programs/#14483" class="Bound">⇒-der2</a> <a id="14490" class="Symbol">=</a> <a id="14492" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="14498" href="/lia/part5/Programs/#14474" class="Bound">⇒-der1</a> <a id="14505" href="/lia/part5/Programs/#14483" class="Bound">⇒-der2</a></pre>

<p>Note how we do not need to reason about the lengths <code class="language-plaintext highlighter-rouge">m1</code>, <code class="language-plaintext highlighter-rouge">m2</code> of the
two subcomputations <code class="language-plaintext highlighter-rouge">↝*-der1</code>, <code class="language-plaintext highlighter-rouge">↝*-der2</code> because the recursive calls
<code class="language-plaintext highlighter-rouge">small→big c ...</code> and <code class="language-plaintext highlighter-rouge">small→big d</code> are done on structurally smaller
programs <code class="language-plaintext highlighter-rouge">c</code>, resp., <code class="language-plaintext highlighter-rouge">d</code>.</p>

<h3 id="if-b-then-c-else-d-3"><code class="language-plaintext highlighter-rouge">if b then c else d</code></h3>

<p>The case for conditional is straightforward.</p>

<pre class="Agda"> <a id="14829" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="14832" class="Symbol">(</a><a id="14833" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="14836" href="/lia/part5/Programs/#14836" class="Bound">b</a> <a id="14838" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="14843" href="/lia/part5/Programs/#14843" class="Bound">c</a> <a id="14845" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="14850" href="/lia/part5/Programs/#14850" class="Bound">d</a><a id="14851" class="Symbol">)</a> <a id="14853" href="/lia/part5/Programs/#14853" class="Bound">s</a> <a id="14855" href="/lia/part5/Programs/#14855" class="Bound">s′</a> <a id="14858" class="Symbol">(</a><a id="14859" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="14863" href="/lia/part5/Programs/#14863" class="Bound">m</a><a id="14864" class="Symbol">)</a> <a id="14866" class="Symbol">(</a><a id="14867" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="14871" class="Symbol">(</a><a id="14872" href="/lia/part5/Programs/#5803" class="InductiveConstructor">↝-if-tt</a> <a id="14880" href="/lia/part5/Programs/#14880" class="Bound">b≡true</a><a id="14886" class="Symbol">)</a> <a id="14888" href="/lia/part5/Programs/#14888" class="Bound">↝*-der</a><a id="14894" class="Symbol">)</a> <a id="14896" class="Symbol">_</a>
     <a id="14903" class="Keyword">with</a> <a id="14908" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="14911" href="/lia/part5/Programs/#14843" class="Bound">c</a> <a id="14913" href="/lia/part5/Programs/#14853" class="Bound">s</a> <a id="14915" href="/lia/part5/Programs/#14855" class="Bound">s′</a> <a id="14918" href="/lia/part5/Programs/#14863" class="Bound">m</a> <a id="14920" href="/lia/part5/Programs/#14888" class="Bound">↝*-der</a> <a id="14927" class="Symbol">{!   !}</a>
 <a id="14936" class="Symbol">...</a> <a id="14940" class="Symbol">|</a> <a id="14942" href="/lia/part5/Programs/#14942" class="Bound">⇒-der</a> <a id="14948" class="Symbol">=</a> <a id="14950" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="14958" class="Bound">b≡true</a> <a id="14965" href="/lia/part5/Programs/#14942" class="Bound">⇒-der</a>

 <a id="14973" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="14976" class="Symbol">(</a><a id="14977" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="14980" href="/lia/part5/Programs/#14980" class="Bound">b</a> <a id="14982" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="14987" href="/lia/part5/Programs/#14987" class="Bound">c</a> <a id="14989" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="14994" href="/lia/part5/Programs/#14994" class="Bound">d</a><a id="14995" class="Symbol">)</a> <a id="14997" href="/lia/part5/Programs/#14997" class="Bound">s</a> <a id="14999" href="/lia/part5/Programs/#14999" class="Bound">s′</a> <a id="15002" class="Symbol">(</a><a id="15003" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="15007" href="/lia/part5/Programs/#15007" class="Bound">m</a><a id="15008" class="Symbol">)</a> <a id="15010" class="Symbol">(</a><a id="15011" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="15015" class="Symbol">(</a><a id="15016" href="/lia/part5/Programs/#5889" class="InductiveConstructor">↝-if-ff</a> <a id="15024" href="/lia/part5/Programs/#15024" class="Bound">b≡false</a><a id="15031" class="Symbol">)</a> <a id="15033" href="/lia/part5/Programs/#15033" class="Bound">↝*-der</a><a id="15039" class="Symbol">)</a> <a id="15041" class="Symbol">_</a>
     <a id="15048" class="Keyword">with</a> <a id="15053" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="15056" href="/lia/part5/Programs/#14994" class="Bound">d</a> <a id="15058" href="/lia/part5/Programs/#14997" class="Bound">s</a> <a id="15060" href="/lia/part5/Programs/#14999" class="Bound">s′</a> <a id="15063" href="/lia/part5/Programs/#15007" class="Bound">m</a> <a id="15065" href="/lia/part5/Programs/#15033" class="Bound">↝*-der</a> <a id="15072" class="Symbol">{!   !}</a>
 <a id="15081" class="Symbol">...</a> <a id="15085" class="Symbol">|</a> <a id="15087" href="/lia/part5/Programs/#15087" class="Bound">⇒-der</a> <a id="15093" class="Symbol">=</a> <a id="15095" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="15103" class="Bound">b≡false</a> <a id="15111" href="/lia/part5/Programs/#15087" class="Bound">⇒-der</a></pre>

<h3 id="while-b-do-c-case-one">
<code class="language-plaintext highlighter-rouge">while b do: c</code>, case one</h3>

<p>We now tackle the hardest case, the while loop when the guard evaluates
to true.</p>

<p>By calling <code class="language-plaintext highlighter-rouge">⨟-lemma-2 ↝*-der</code> we obtain <code class="language-plaintext highlighter-rouge">m1</code> as the length of the
derivation <code class="language-plaintext highlighter-rouge">↝*-der1</code> showing <code class="language-plaintext highlighter-rouge">c , s ↝* skip , s′′ # m1</code> and <code class="language-plaintext highlighter-rouge">m2</code> as the
length of <code class="language-plaintext highlighter-rouge">↝*-der2</code> showing <code class="language-plaintext highlighter-rouge">while b do: c , s′′ ↝* skip , s′ # m2</code> and
a proof <code class="language-plaintext highlighter-rouge">sm1+m2≡m</code> that <code class="language-plaintext highlighter-rouge">suc (m1 + m2) ≡ m</code>.</p>

<p>We can then show that <code class="language-plaintext highlighter-rouge">m1 &lt; m</code> and <code class="language-plaintext highlighter-rouge">m2 &lt; m</code>, which allows us to use
well-founded induction when calling <code class="language-plaintext highlighter-rouge">go</code> again on <code class="language-plaintext highlighter-rouge">↝*-der1</code>, resp.,
<code class="language-plaintext highlighter-rouge">↝*-der2</code>.</p>

<p>The latter inductive calls to <code class="language-plaintext highlighter-rouge">go</code> provide us with
<code class="language-plaintext highlighter-rouge">⇒-der1 : c , s ⇒ s′′</code> and <code class="language-plaintext highlighter-rouge">⇒-der2 : while b do: c , s′′ ⇒ s′</code>, from
which we can immediately conclude by applying the constructor
<code class="language-plaintext highlighter-rouge">⇒-while-tt</code></p>

<pre class="Agda"> <a id="15840" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="15843" class="Symbol">(</a><a id="15844" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="15850" href="/lia/part5/Programs/#15850" class="Bound">b</a> <a id="15852" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="15856" href="/lia/part5/Programs/#15856" class="Bound">c</a><a id="15857" class="Symbol">)</a> <a id="15859" href="/lia/part5/Programs/#15859" class="Bound">s</a> <a id="15861" href="/lia/part5/Programs/#15861" class="Bound">s′</a> <a id="15864" href="/lia/part5/Programs/#15864" class="Bound">m</a> <a id="15866" class="Symbol">(</a><a id="15867" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="15871" class="Symbol">(</a><a id="15872" href="/lia/part5/Programs/#6185" class="InductiveConstructor">↝-while-tt</a> <a id="15883" href="/lia/part5/Programs/#15883" class="Bound">b≡true</a><a id="15889" class="Symbol">)</a> <a id="15891" href="/lia/part5/Programs/#15891" class="Bound">↝*-der</a><a id="15897" class="Symbol">)</a> <a id="15899" class="Symbol">(</a><a id="15900" href="/lia/part0/WellFounded/#506" class="InductiveConstructor">acc</a> <a id="15904" href="/lia/part5/Programs/#15904" class="Bound">a</a><a id="15905" class="Symbol">)</a>
     <a id="15912" class="Keyword">with</a> <a id="15917" href="/lia/part5/Programs/#12363" class="Function">⨟-lemma-2</a> <a id="15927" href="/lia/part5/Programs/#15891" class="Bound">↝*-der</a>
 <a id="15935" class="Symbol">...</a> <a id="15939" class="Symbol">|</a> <a id="15941" href="/lia/part5/Programs/#15941" class="Bound">s′′</a> <a id="15945" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="15947" href="/lia/part5/Programs/#15947" class="Bound">m1</a> <a id="15950" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="15952" href="/lia/part5/Programs/#15952" class="Bound">m2</a> <a id="15955" href="/lia/part0/Logic/#396" class="InductiveConstructor Operator">,</a> <a id="15957" href="/lia/part5/Programs/#15957" class="Bound">↝*-der1</a> <a id="15965" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="15967" href="/lia/part5/Programs/#15967" class="Bound">↝*-der2</a> <a id="15975" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="15977" href="/lia/part5/Programs/#15977" class="Bound">sm1+m2≡m</a>
     <a id="15991" class="Keyword">with</a> <a id="15996" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="15999" class="Bound">c</a> <a id="16001" class="Bound">s</a> <a id="16003" href="/lia/part5/Programs/#15941" class="Bound">s′′</a> <a id="16007" href="/lia/part5/Programs/#15947" class="Bound">m1</a> <a id="16010" href="/lia/part5/Programs/#15957" class="Bound">↝*-der1</a> <a id="16018" class="Symbol">(</a><a id="16019" class="Bound">a</a> <a id="16021" href="/lia/part5/Programs/#15947" class="Bound">m1</a> <a id="16024" href="/lia/part5/Programs/#16118" class="Function">m1&lt;m</a><a id="16028" class="Symbol">)</a> <a id="16030" class="Symbol">|</a>
          <a id="16042" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="16045" class="Symbol">(</a><a id="16046" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="16052" class="Bound">b</a> <a id="16054" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="16058" class="Bound">c</a><a id="16059" class="Symbol">)</a> <a id="16061" href="/lia/part5/Programs/#15941" class="Bound">s′′</a> <a id="16065" class="Bound">s′</a> <a id="16068" href="/lia/part5/Programs/#15952" class="Bound">m2</a> <a id="16071" href="/lia/part5/Programs/#15967" class="Bound">↝*-der2</a> <a id="16079" class="Symbol">(</a><a id="16080" class="Bound">a</a> <a id="16082" href="/lia/part5/Programs/#15952" class="Bound">m2</a> <a id="16085" href="/lia/part5/Programs/#16246" class="Function">m2&lt;m</a><a id="16089" class="Symbol">)</a>
          <a id="16101" class="Keyword">where</a>
           <a id="16118" href="/lia/part5/Programs/#16118" class="Function">m1&lt;m</a> <a id="16123" class="Symbol">:</a> <a id="16125" href="/lia/part5/Programs/#15947" class="Bound">m1</a> <a id="16128" href="/lia/part0/Naturals/#1314" class="Function Operator">&lt;</a> <a id="16130" class="Bound">m</a>
           <a id="16143" href="/lia/part5/Programs/#16118" class="Function">m1&lt;m</a> <a id="16148" class="Symbol">=</a> <a id="16150" class="Symbol">{!   !}</a> <a id="16158" class="Comment">-- s≤s (≤-suc2 (subst (λ x → suc m1 ≤ x) sm1+m2≡m (≤-+-left {suc m1} {m2})))</a>
           <a id="16246" href="/lia/part5/Programs/#16246" class="Function">m2&lt;m</a> <a id="16251" class="Symbol">:</a> <a id="16253" href="/lia/part5/Programs/#15952" class="Bound">m2</a> <a id="16256" href="/lia/part0/Naturals/#1314" class="Function Operator">&lt;</a> <a id="16258" class="Bound">m</a>
           <a id="16271" href="/lia/part5/Programs/#16246" class="Function">m2&lt;m</a> <a id="16276" class="Symbol">=</a> <a id="16278" class="Symbol">{!   !}</a> <a id="16286" class="Comment">-- s≤s (subst (m2 ≤_) sm1+m2≡m (≤-+-right {suc m1} {m2}))</a>
 <a id="16345" class="Symbol">...</a> <a id="16349" class="Symbol">|</a> <a id="16351" href="/lia/part5/Programs/#16351" class="Bound">⇒-der1</a> <a id="16358" class="Symbol">|</a> <a id="16360" href="/lia/part5/Programs/#16360" class="Bound">⇒-der2</a> <a id="16367" class="Symbol">=</a> <a id="16369" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="16380" class="Bound">b≡true</a> <a id="16387" href="/lia/part5/Programs/#16351" class="Bound">⇒-der1</a> <a id="16394" href="/lia/part5/Programs/#16360" class="Bound">⇒-der2</a></pre>

<p>This is the only place where we use well-founded induction.</p>

<h3 id="while-b-do-c-case-two">
<code class="language-plaintext highlighter-rouge">while b do: c</code>, case two</h3>

<p>This case is straightforward.</p>

<pre class="Agda"> <a id="16534" href="/lia/part5/Programs/#13387" class="Function">go</a> <a id="16537" class="Symbol">(</a><a id="16538" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="16544" href="/lia/part5/Programs/#16544" class="Bound">b</a> <a id="16546" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="16550" href="/lia/part5/Programs/#16550" class="Bound">c</a><a id="16551" class="Symbol">)</a> <a id="16553" href="/lia/part5/Programs/#16553" class="Bound">s</a> <a id="16555" href="/lia/part5/Programs/#16555" class="Bound">s′</a> <a id="16558" href="/lia/part5/Programs/#16558" class="Bound">m</a> <a id="16560" class="Symbol">(</a><a id="16561" href="/lia/part5/Programs/#11884" class="InductiveConstructor">one</a> <a id="16565" class="Symbol">(</a><a id="16566" href="/lia/part5/Programs/#6283" class="InductiveConstructor">↝-while-ff</a> <a id="16577" href="/lia/part5/Programs/#16577" class="Bound">b≡false</a><a id="16584" class="Symbol">)</a> <a id="16586" href="/lia/part5/Programs/#16586" class="Bound">↝*-der</a><a id="16592" class="Symbol">)</a> <a id="16594" class="Symbol">_</a>
     <a id="16601" class="Keyword">with</a> <a id="16606" href="/lia/part5/Programs/#12999" class="Function">↝*-skip</a> <a id="16614" href="/lia/part5/Programs/#16586" class="Bound">↝*-der</a>
 <a id="16622" class="Symbol">...</a> <a id="16626" class="Symbol">|</a> <a id="16628" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="16633" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="16635" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="16640" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="16642" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="16647" class="Symbol">=</a> <a id="16649" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="16660" class="Bound">b≡false</a></pre>

<h1 id="contexual-equivalence">
<a class="anchor" href="#contexual-equivalence" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contexual equivalence</h1>

<p>We first need to introduce the notion of <em>program contexts</em>, which are
programs with a single distinguished hole.</p>

<pre class="Agda"><a id="16818" class="Keyword">data</a> <a id="Context"></a><a id="16823" href="/lia/part5/Programs/#16823" class="Datatype">Context</a> <a id="16831" class="Symbol">:</a> <a id="16833" class="PrimitiveType">Set</a> <a id="16837" class="Keyword">where</a>
  <a id="Context.□"></a><a id="16845" href="/lia/part5/Programs/#16845" class="InductiveConstructor">□</a> <a id="16847" class="Symbol">:</a> <a id="16849" href="/lia/part5/Programs/#16823" class="Datatype">Context</a>
  <a id="Context._⨟-left_"></a><a id="16859" href="/lia/part5/Programs/#16859" class="InductiveConstructor Operator">_⨟-left_</a> <a id="16868" class="Symbol">:</a> <a id="16870" class="Symbol">(</a><a id="16871" href="/lia/part5/Programs/#16871" class="Bound">C</a> <a id="16873" class="Symbol">:</a> <a id="16875" href="/lia/part5/Programs/#16823" class="Datatype">Context</a><a id="16882" class="Symbol">)</a> <a id="16884" class="Symbol">→</a> <a id="16886" class="Symbol">(</a><a id="16887" href="/lia/part5/Programs/#16887" class="Bound">c</a> <a id="16889" class="Symbol">:</a> <a id="16891" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a><a id="16894" class="Symbol">)</a> <a id="16896" class="Symbol">→</a> <a id="16898" href="/lia/part5/Programs/#16823" class="Datatype">Context</a>
  <a id="Context._⨟-right_"></a><a id="16908" href="/lia/part5/Programs/#16908" class="InductiveConstructor Operator">_⨟-right_</a> <a id="16918" class="Symbol">:</a> <a id="16920" class="Symbol">(</a><a id="16921" href="/lia/part5/Programs/#16921" class="Bound">c</a> <a id="16923" class="Symbol">:</a> <a id="16925" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a><a id="16928" class="Symbol">)</a> <a id="16930" class="Symbol">→</a> <a id="16932" class="Symbol">(</a><a id="16933" href="/lia/part5/Programs/#16933" class="Bound">C</a> <a id="16935" class="Symbol">:</a> <a id="16937" href="/lia/part5/Programs/#16823" class="Datatype">Context</a><a id="16944" class="Symbol">)</a> <a id="16946" class="Symbol">→</a> <a id="16948" href="/lia/part5/Programs/#16823" class="Datatype">Context</a>
  <a id="Context.if-left_then_else_"></a><a id="16958" href="/lia/part5/Programs/#16958" class="InductiveConstructor Operator">if-left_then_else_</a> <a id="16977" class="Symbol">:</a> <a id="16979" class="Symbol">(</a><a id="16980" href="/lia/part5/Programs/#16980" class="Bound">b</a> <a id="16982" class="Symbol">:</a> <a id="16984" href="/lia/part5/Exp/#1938" class="Datatype">BExp</a><a id="16988" class="Symbol">)</a> <a id="16990" class="Symbol">→</a> <a id="16992" class="Symbol">(</a><a id="16993" href="/lia/part5/Programs/#16993" class="Bound">C</a> <a id="16995" class="Symbol">:</a> <a id="16997" href="/lia/part5/Programs/#16823" class="Datatype">Context</a><a id="17004" class="Symbol">)</a> <a id="17006" class="Symbol">→</a> <a id="17008" class="Symbol">(</a><a id="17009" href="/lia/part5/Programs/#17009" class="Bound">c</a> <a id="17011" class="Symbol">:</a> <a id="17013" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a><a id="17016" class="Symbol">)</a> <a id="17018" class="Symbol">→</a> <a id="17020" href="/lia/part5/Programs/#16823" class="Datatype">Context</a>
  <a id="Context.if-right_then_else_"></a><a id="17030" href="/lia/part5/Programs/#17030" class="InductiveConstructor Operator">if-right_then_else_</a> <a id="17050" class="Symbol">:</a> <a id="17052" class="Symbol">(</a><a id="17053" href="/lia/part5/Programs/#17053" class="Bound">b</a> <a id="17055" class="Symbol">:</a> <a id="17057" href="/lia/part5/Exp/#1938" class="Datatype">BExp</a><a id="17061" class="Symbol">)</a> <a id="17063" class="Symbol">→</a> <a id="17065" class="Symbol">(</a><a id="17066" href="/lia/part5/Programs/#17066" class="Bound">c</a> <a id="17068" class="Symbol">:</a> <a id="17070" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a><a id="17073" class="Symbol">)</a> <a id="17075" class="Symbol">→</a> <a id="17077" class="Symbol">(</a><a id="17078" href="/lia/part5/Programs/#17078" class="Bound">C</a> <a id="17080" class="Symbol">:</a> <a id="17082" href="/lia/part5/Programs/#16823" class="Datatype">Context</a><a id="17089" class="Symbol">)</a> <a id="17091" class="Symbol">→</a> <a id="17093" href="/lia/part5/Programs/#16823" class="Datatype">Context</a>
  <a id="Context.while_do:_"></a><a id="17103" href="/lia/part5/Programs/#17103" class="InductiveConstructor Operator">while_do:_</a> <a id="17114" class="Symbol">:</a> <a id="17116" class="Symbol">(</a><a id="17117" href="/lia/part5/Programs/#17117" class="Bound">b</a> <a id="17119" class="Symbol">:</a> <a id="17121" href="/lia/part5/Exp/#1938" class="Datatype">BExp</a><a id="17125" class="Symbol">)</a> <a id="17127" class="Symbol">→</a> <a id="17129" class="Symbol">(</a><a id="17130" href="/lia/part5/Programs/#17130" class="Bound">C</a> <a id="17132" class="Symbol">:</a> <a id="17134" href="/lia/part5/Programs/#16823" class="Datatype">Context</a><a id="17141" class="Symbol">)</a> <a id="17143" class="Symbol">→</a> <a id="17145" href="/lia/part5/Programs/#16823" class="Datatype">Context</a>

<a id="17154" class="Keyword">private</a>
  <a id="17164" class="Keyword">variable</a>
    <a id="17177" href="/lia/part5/Programs/#17177" class="Generalizable">C</a> <a id="17179" class="Symbol">:</a> <a id="17181" href="/lia/part5/Programs/#16823" class="Datatype">Context</a></pre>

<p>We can fill the hole in a context with a given program.</p>

<pre class="Agda"><a id="contextApply"></a><a id="17255" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17268" class="Symbol">:</a> <a id="17270" href="/lia/part5/Programs/#16823" class="Datatype">Context</a> <a id="17278" class="Symbol">→</a> <a id="17280" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a> <a id="17284" class="Symbol">→</a> <a id="17286" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a>
<a id="17290" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17303" href="/lia/part5/Programs/#16845" class="InductiveConstructor">□</a> <a id="17305" href="/lia/part5/Programs/#17305" class="Bound">d</a> <a id="17307" class="Symbol">=</a> <a id="17309" href="/lia/part5/Programs/#17305" class="Bound">d</a>
<a id="17311" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17324" class="Symbol">(</a><a id="17325" href="/lia/part5/Programs/#17325" class="Bound">C</a> <a id="17327" href="/lia/part5/Programs/#16859" class="InductiveConstructor Operator">⨟-left</a> <a id="17334" href="/lia/part5/Programs/#17334" class="Bound">c</a><a id="17335" class="Symbol">)</a> <a id="17337" href="/lia/part5/Programs/#17337" class="Bound">d</a> <a id="17339" class="Symbol">=</a> <a id="17341" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17354" href="/lia/part5/Programs/#17325" class="Bound">C</a> <a id="17356" href="/lia/part5/Programs/#17337" class="Bound">d</a> <a id="17358" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="17360" href="/lia/part5/Programs/#17334" class="Bound">c</a>
<a id="17362" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17375" class="Symbol">(</a><a id="17376" href="/lia/part5/Programs/#17376" class="Bound">c</a> <a id="17378" href="/lia/part5/Programs/#16908" class="InductiveConstructor Operator">⨟-right</a> <a id="17386" href="/lia/part5/Programs/#17386" class="Bound">C</a><a id="17387" class="Symbol">)</a> <a id="17389" href="/lia/part5/Programs/#17389" class="Bound">d</a> <a id="17391" class="Symbol">=</a> <a id="17393" href="/lia/part5/Programs/#17376" class="Bound">c</a> <a id="17395" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="17397" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17410" href="/lia/part5/Programs/#17386" class="Bound">C</a> <a id="17412" href="/lia/part5/Programs/#17389" class="Bound">d</a>
<a id="17414" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17427" class="Symbol">(</a><a id="17428" href="/lia/part5/Programs/#16958" class="InductiveConstructor Operator">if-left</a> <a id="17436" href="/lia/part5/Programs/#17436" class="Bound">b</a> <a id="17438" href="/lia/part5/Programs/#16958" class="InductiveConstructor Operator">then</a> <a id="17443" href="/lia/part5/Programs/#17443" class="Bound">C</a> <a id="17445" href="/lia/part5/Programs/#16958" class="InductiveConstructor Operator">else</a> <a id="17450" href="/lia/part5/Programs/#17450" class="Bound">c</a><a id="17451" class="Symbol">)</a> <a id="17453" href="/lia/part5/Programs/#17453" class="Bound">d</a> <a id="17455" class="Symbol">=</a> <a id="17457" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="17460" href="/lia/part5/Programs/#17436" class="Bound">b</a> <a id="17462" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="17467" class="Symbol">(</a><a id="17468" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17481" href="/lia/part5/Programs/#17443" class="Bound">C</a> <a id="17483" href="/lia/part5/Programs/#17453" class="Bound">d</a><a id="17484" class="Symbol">)</a> <a id="17486" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="17491" href="/lia/part5/Programs/#17450" class="Bound">c</a>
<a id="17493" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17506" class="Symbol">(</a><a id="17507" href="/lia/part5/Programs/#17030" class="InductiveConstructor Operator">if-right</a> <a id="17516" href="/lia/part5/Programs/#17516" class="Bound">b</a> <a id="17518" href="/lia/part5/Programs/#17030" class="InductiveConstructor Operator">then</a> <a id="17523" href="/lia/part5/Programs/#17523" class="Bound">c</a> <a id="17525" href="/lia/part5/Programs/#17030" class="InductiveConstructor Operator">else</a> <a id="17530" href="/lia/part5/Programs/#17530" class="Bound">C</a><a id="17531" class="Symbol">)</a> <a id="17533" href="/lia/part5/Programs/#17533" class="Bound">d</a> <a id="17535" class="Symbol">=</a> <a id="17537" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="17540" href="/lia/part5/Programs/#17516" class="Bound">b</a> <a id="17542" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="17547" href="/lia/part5/Programs/#17523" class="Bound">c</a> <a id="17549" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="17554" class="Symbol">(</a><a id="17555" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17568" href="/lia/part5/Programs/#17530" class="Bound">C</a> <a id="17570" href="/lia/part5/Programs/#17533" class="Bound">d</a><a id="17571" class="Symbol">)</a>
<a id="17573" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17586" class="Symbol">(</a><a id="17587" href="/lia/part5/Programs/#17103" class="InductiveConstructor Operator">while</a> <a id="17593" href="/lia/part5/Programs/#17593" class="Bound">b</a> <a id="17595" href="/lia/part5/Programs/#17103" class="InductiveConstructor Operator">do:</a> <a id="17599" href="/lia/part5/Programs/#17599" class="Bound">C</a><a id="17600" class="Symbol">)</a> <a id="17602" href="/lia/part5/Programs/#17602" class="Bound">d</a> <a id="17604" class="Symbol">=</a> <a id="17606" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="17612" href="/lia/part5/Programs/#17593" class="Bound">b</a> <a id="17614" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="17618" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17631" href="/lia/part5/Programs/#17599" class="Bound">C</a> <a id="17633" href="/lia/part5/Programs/#17602" class="Bound">d</a></pre>

<p>Contexual equivalence:</p>

<pre class="Agda"><a id="_∼_"></a><a id="17668" href="/lia/part5/Programs/#17668" class="Function Operator">_∼_</a> <a id="17672" class="Symbol">:</a> <a id="17674" class="Symbol">(</a><a id="17675" href="/lia/part5/Programs/#17675" class="Bound">c</a> <a id="17677" href="/lia/part5/Programs/#17677" class="Bound">d</a> <a id="17679" class="Symbol">:</a> <a id="17681" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a><a id="17684" class="Symbol">)</a> <a id="17686" class="Symbol">→</a> <a id="17688" class="PrimitiveType">Set</a>
<a id="17692" href="/lia/part5/Programs/#17692" class="Bound">c</a> <a id="17694" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="17696" href="/lia/part5/Programs/#17696" class="Bound">d</a> <a id="17698" class="Symbol">=</a> <a id="17700" href="/lia/part0/Logic/#216" class="Function">∀[</a> <a id="17703" href="/lia/part5/Programs/#17703" class="Bound">s</a> <a id="17705" href="/lia/part0/Logic/#216" class="Function">]</a> <a id="17707" href="/lia/part0/Logic/#216" class="Function">∀[</a> <a id="17710" href="/lia/part5/Programs/#17710" class="Bound">s′</a> <a id="17713" href="/lia/part0/Logic/#216" class="Function">]</a> <a id="17715" href="/lia/part5/Programs/#17692" class="Bound">c</a> <a id="17717" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="17719" href="/lia/part5/Programs/#17703" class="Bound">s</a> <a id="17721" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="17723" href="/lia/part5/Programs/#17710" class="Bound">s′</a> <a id="17726" href="/lia/part0/Logic/#3145" class="Function Operator">↔</a> <a id="17728" href="/lia/part5/Programs/#17696" class="Bound">d</a> <a id="17730" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="17732" href="/lia/part5/Programs/#17703" class="Bound">s</a> <a id="17734" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="17736" href="/lia/part5/Programs/#17710" class="Bound">s′</a>

<a id="sym-∼"></a><a id="17740" href="/lia/part5/Programs/#17740" class="Function">sym-∼</a> <a id="17746" class="Symbol">:</a> <a id="17748" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="17750" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="17752" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="17754" class="Symbol">→</a> <a id="17756" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="17758" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="17760" href="/lia/part5/Programs/#1356" class="Generalizable">c</a>
<a id="17762" href="/lia/part5/Programs/#17740" class="Function">sym-∼</a> <a id="17768" href="/lia/part5/Programs/#17768" class="Bound">c∼d</a> <a id="17772" href="/lia/part5/Programs/#17772" class="Bound">s</a> <a id="17774" href="/lia/part5/Programs/#17774" class="Bound">s′</a> <a id="17777" class="Keyword">with</a> <a id="17782" href="/lia/part5/Programs/#17768" class="Bound">c∼d</a> <a id="17786" href="/lia/part5/Programs/#17772" class="Bound">s</a> <a id="17788" href="/lia/part5/Programs/#17774" class="Bound">s′</a>
<a id="17791" class="Symbol">...</a> <a id="17795" class="Symbol">|</a> <a id="17797" href="/lia/part5/Programs/#17797" class="Bound">have0</a> <a id="17803" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="17805" href="/lia/part5/Programs/#17805" class="Bound">have1</a> <a id="17811" class="Symbol">=</a> <a id="17813" href="/lia/part5/Programs/#17805" class="Bound">have1</a> <a id="17819" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="17821" href="/lia/part5/Programs/#17797" class="Bound">have0</a>

<a id="_≈_"></a><a id="17828" href="/lia/part5/Programs/#17828" class="Function Operator">_≈_</a> <a id="17832" class="Symbol">:</a> <a id="17834" class="Symbol">(</a><a id="17835" href="/lia/part5/Programs/#17835" class="Bound">c</a> <a id="17837" href="/lia/part5/Programs/#17837" class="Bound">d</a> <a id="17839" class="Symbol">:</a> <a id="17841" href="/lia/part5/Programs/#383" class="Datatype">Cmd</a><a id="17844" class="Symbol">)</a> <a id="17846" class="Symbol">→</a> <a id="17848" class="PrimitiveType">Set</a>
<a id="17852" href="/lia/part5/Programs/#17852" class="Bound">c</a> <a id="17854" href="/lia/part5/Programs/#17828" class="Function Operator">≈</a> <a id="17856" href="/lia/part5/Programs/#17856" class="Bound">d</a> <a id="17858" class="Symbol">=</a> <a id="17860" class="Symbol">∀</a> <a id="17862" href="/lia/part5/Programs/#17862" class="Bound">C</a> <a id="17864" class="Symbol">→</a> <a id="17866" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17879" href="/lia/part5/Programs/#17862" class="Bound">C</a> <a id="17881" href="/lia/part5/Programs/#17852" class="Bound">c</a> <a id="17883" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="17885" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17898" href="/lia/part5/Programs/#17862" class="Bound">C</a> <a id="17900" href="/lia/part5/Programs/#17856" class="Bound">d</a></pre>

<h2 id="full-abstraction">
<a class="anchor" href="#full-abstraction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Full abstraction</h2>

<p>Preliminary facts:</p>

<pre class="Agda"><a id="fa-⨟-left"></a><a id="17952" href="/lia/part5/Programs/#17952" class="Function">fa-⨟-left</a> <a id="17962" class="Symbol">:</a> <a id="17964" class="Symbol">∀</a> <a id="17966" href="/lia/part5/Programs/#17966" class="Bound">C</a> <a id="17968" class="Symbol">→</a>
           <a id="17981" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="17994" href="/lia/part5/Programs/#17966" class="Bound">C</a> <a id="17996" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="17998" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="18000" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18013" href="/lia/part5/Programs/#17966" class="Bound">C</a> <a id="18015" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="18017" class="Symbol">→</a>
           <a id="18030" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18043" href="/lia/part5/Programs/#17966" class="Bound">C</a> <a id="18045" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="18047" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="18049" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="18052" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="18054" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="18056" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="18058" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="18061" class="Symbol">→</a>
           <a id="18074" class="Comment">-------------------------------------</a>
           <a id="18123" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18136" href="/lia/part5/Programs/#17966" class="Bound">C</a> <a id="18138" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="18140" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="18142" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="18145" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="18147" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="18149" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="18151" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a>

<a id="18155" href="/lia/part5/Programs/#17952" class="Function">fa-⨟-left</a> <a id="18165" class="Symbol">{</a><a id="18166" class="Argument">s</a> <a id="18168" class="Symbol">=</a> <a id="18170" href="/lia/part5/Programs/#18170" class="Bound">s</a><a id="18171" class="Symbol">}</a> <a id="18173" class="Symbol">_</a> <a id="18175" href="/lia/part5/Programs/#18175" class="Bound">Cc∼Cd</a> <a id="18181" class="Symbol">(</a><a id="18182" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="18188" class="Symbol">{</a><a id="18189" class="Argument">s′</a> <a id="18192" class="Symbol">=</a> <a id="18194" href="/lia/part5/Programs/#18194" class="Bound">s′′</a><a id="18197" class="Symbol">}</a> <a id="18199" href="/lia/part5/Programs/#18199" class="Bound">δ₀</a> <a id="18202" href="/lia/part5/Programs/#18202" class="Bound">δ₁</a><a id="18204" class="Symbol">)</a>
    <a id="18210" class="Keyword">with</a> <a id="18215" href="/lia/part5/Programs/#18175" class="Bound">Cc∼Cd</a> <a id="18221" href="/lia/part5/Programs/#18170" class="Bound">s</a> <a id="18223" href="/lia/part5/Programs/#18194" class="Bound">s′′</a>
<a id="18227" class="Symbol">...</a> <a id="18231" class="Symbol">|</a> <a id="18233" href="/lia/part5/Programs/#18233" class="Bound">have</a> <a id="18238" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="18240" class="Symbol">_</a> <a id="18242" class="Symbol">=</a> <a id="18244" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="18250" class="Symbol">(</a><a id="18251" href="/lia/part5/Programs/#18233" class="Bound">have</a> <a id="18256" class="Bound">δ₀</a><a id="18258" class="Symbol">)</a> <a id="18260" class="Bound">δ₁</a>

<a id="fa-⨟-right"></a><a id="18264" href="/lia/part5/Programs/#18264" class="Function">fa-⨟-right</a> <a id="18275" class="Symbol">:</a> <a id="18277" class="Symbol">∀</a> <a id="18279" href="/lia/part5/Programs/#18279" class="Bound">C</a> <a id="18281" class="Symbol">→</a>
            <a id="18295" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18308" href="/lia/part5/Programs/#18279" class="Bound">C</a> <a id="18310" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="18312" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="18314" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18327" href="/lia/part5/Programs/#18279" class="Bound">C</a> <a id="18329" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="18331" class="Symbol">→</a>
            <a id="18345" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="18348" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="18350" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18363" href="/lia/part5/Programs/#18279" class="Bound">C</a> <a id="18365" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="18367" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="18369" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="18371" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="18373" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="18376" class="Symbol">→</a>
            <a id="18390" class="Comment">-------------------------------------</a>
            <a id="18440" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="18443" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="18445" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18458" href="/lia/part5/Programs/#18279" class="Bound">C</a> <a id="18460" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="18462" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="18464" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="18466" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="18468" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a>

<a id="18472" href="/lia/part5/Programs/#18264" class="Function">fa-⨟-right</a> <a id="18483" class="Symbol">{</a><a id="18484" class="Argument">s′</a> <a id="18487" class="Symbol">=</a> <a id="18489" href="/lia/part5/Programs/#18489" class="Bound">s′</a><a id="18491" class="Symbol">}</a> <a id="18493" class="Symbol">_</a> <a id="18495" href="/lia/part5/Programs/#18495" class="Bound">Cc∼Cd</a> <a id="18501" class="Symbol">(</a><a id="18502" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="18508" class="Symbol">{</a><a id="18509" class="Argument">s′</a> <a id="18512" class="Symbol">=</a> <a id="18514" href="/lia/part5/Programs/#18514" class="Bound">s′′</a><a id="18517" class="Symbol">}</a> <a id="18519" href="/lia/part5/Programs/#18519" class="Bound">δ₀</a> <a id="18522" href="/lia/part5/Programs/#18522" class="Bound">δ₁</a><a id="18524" class="Symbol">)</a>
    <a id="18530" class="Keyword">with</a> <a id="18535" href="/lia/part5/Programs/#18495" class="Bound">Cc∼Cd</a> <a id="18541" href="/lia/part5/Programs/#18514" class="Bound">s′′</a> <a id="18545" href="/lia/part5/Programs/#18489" class="Bound">s′</a>
<a id="18548" class="Symbol">...</a> <a id="18552" class="Symbol">|</a> <a id="18554" href="/lia/part5/Programs/#18554" class="Bound">have</a> <a id="18559" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="18561" class="Symbol">_</a> <a id="18563" class="Symbol">=</a> <a id="18565" href="/lia/part5/Programs/#1973" class="InductiveConstructor">⇒-seq</a> <a id="18571" class="Bound">δ₀</a> <a id="18574" class="Symbol">(</a><a id="18575" href="/lia/part5/Programs/#18554" class="Bound">have</a> <a id="18580" class="Bound">δ₁</a><a id="18582" class="Symbol">)</a>

<a id="fa-while"></a><a id="18585" href="/lia/part5/Programs/#18585" class="Function">fa-while</a> <a id="18594" class="Symbol">:</a> <a id="18596" class="Symbol">∀</a> <a id="18598" href="/lia/part5/Programs/#18598" class="Bound">C</a> <a id="18600" class="Symbol">→</a>
           <a id="18613" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18626" href="/lia/part5/Programs/#18598" class="Bound">C</a> <a id="18628" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="18630" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="18632" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18645" href="/lia/part5/Programs/#18598" class="Bound">C</a> <a id="18647" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="18649" class="Symbol">→</a>
           <a id="18662" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="18668" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="18670" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="18674" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18687" href="/lia/part5/Programs/#18598" class="Bound">C</a> <a id="18689" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="18691" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="18693" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="18695" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="18697" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="18700" class="Symbol">→</a>
           <a id="18713" class="Comment">---------------------------------------</a>
           <a id="18764" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="18770" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="18772" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="18776" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="18789" href="/lia/part5/Programs/#18598" class="Bound">C</a> <a id="18791" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="18793" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="18795" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="18797" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="18799" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a>
           
<a id="18814" href="/lia/part5/Programs/#18585" class="Function">fa-while</a> <a id="18823" class="Symbol">_</a> <a id="18825" href="/lia/part5/Programs/#18825" class="Bound">Cc∼Cd</a> <a id="18831" class="Symbol">(</a><a id="18832" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="18843" href="/lia/part5/Programs/#18843" class="Bound">⟦b⟧s≡ff</a><a id="18850" class="Symbol">)</a> <a id="18852" class="Symbol">=</a> <a id="18854" href="/lia/part5/Programs/#2679" class="InductiveConstructor">⇒-while-ff</a> <a id="18865" href="/lia/part5/Programs/#18843" class="Bound">⟦b⟧s≡ff</a>

<a id="18874" href="/lia/part5/Programs/#18585" class="Function">fa-while</a> <a id="18883" href="/lia/part5/Programs/#18883" class="Bound">C</a> <a id="18885" href="/lia/part5/Programs/#18885" class="Bound">Cc∼Cd</a> <a id="18891" class="Symbol">(</a><a id="18892" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="18903" class="Symbol">{</a><a id="18904" class="Argument">s′′</a> <a id="18908" class="Symbol">=</a> <a id="18910" href="/lia/part5/Programs/#18910" class="Bound">s′′</a><a id="18913" class="Symbol">}</a> <a id="18915" href="/lia/part5/Programs/#18915" class="Bound">⟦b⟧s≡tt</a> <a id="18923" href="/lia/part5/Programs/#18923" class="Bound">δ₀</a> <a id="18926" href="/lia/part5/Programs/#18926" class="Bound">δ₁</a><a id="18928" class="Symbol">)</a>
  <a id="18932" class="Keyword">with</a> <a id="18937" href="/lia/part0/Logic/#1854" class="Field">fst</a> <a id="18941" class="Symbol">(</a><a id="18942" href="/lia/part5/Programs/#18885" class="Bound">Cc∼Cd</a> <a id="18948" class="Symbol">_</a> <a id="18950" class="Symbol">_)</a> <a id="18953" href="/lia/part5/Programs/#18923" class="Bound">δ₀</a> <a id="18956" class="Symbol">|</a>
       <a id="18965" href="/lia/part5/Programs/#18585" class="Function">fa-while</a> <a id="18974" href="/lia/part5/Programs/#18883" class="Bound">C</a> <a id="18976" href="/lia/part5/Programs/#18885" class="Bound">Cc∼Cd</a> <a id="18982" href="/lia/part5/Programs/#18926" class="Bound">δ₁</a>
<a id="18985" class="Symbol">...</a> <a id="18989" class="Symbol">|</a> <a id="18991" href="/lia/part5/Programs/#18991" class="Bound">δ₀′</a> <a id="18995" class="Symbol">|</a> <a id="18997" href="/lia/part5/Programs/#18997" class="Bound">δ₁′</a> <a id="19001" class="Symbol">=</a> <a id="19003" href="/lia/part5/Programs/#2534" class="InductiveConstructor">⇒-while-tt</a> <a id="19014" class="Bound">⟦b⟧s≡tt</a> <a id="19022" href="/lia/part5/Programs/#18991" class="Bound">δ₀′</a> <a id="19026" href="/lia/part5/Programs/#18997" class="Bound">δ₁′</a>

<a id="fa-ite-right"></a><a id="19031" href="/lia/part5/Programs/#19031" class="Function">fa-ite-right</a> <a id="19044" class="Symbol">:</a> <a id="19046" class="Symbol">∀</a> <a id="19048" href="/lia/part5/Programs/#19048" class="Bound">C</a> <a id="19050" class="Symbol">→</a>
               <a id="19067" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="19080" href="/lia/part5/Programs/#19048" class="Bound">C</a> <a id="19082" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="19084" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="19086" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="19099" href="/lia/part5/Programs/#19048" class="Bound">C</a> <a id="19101" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="19103" class="Symbol">→</a>
               <a id="19120" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="19123" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="19125" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="19130" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="19143" href="/lia/part5/Programs/#19048" class="Bound">C</a> <a id="19145" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="19147" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="19152" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="19155" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="19157" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="19159" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="19161" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="19164" class="Symbol">→</a>
               <a id="19181" class="Comment">--------------------------------------------</a>
               <a id="19241" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="19244" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="19246" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="19251" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="19264" href="/lia/part5/Programs/#19048" class="Bound">C</a> <a id="19266" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="19268" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="19273" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="19276" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="19278" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="19280" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="19282" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a>

<a id="19286" href="/lia/part5/Programs/#19031" class="Function">fa-ite-right</a> <a id="19299" href="/lia/part5/Programs/#19299" class="Bound">C</a> <a id="19301" href="/lia/part5/Programs/#19301" class="Bound">Cc∼Cd</a> <a id="19307" class="Symbol">(</a><a id="19308" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="19316" href="/lia/part5/Programs/#19316" class="Bound">⟦b⟧s≡tt</a> <a id="19324" href="/lia/part5/Programs/#19324" class="Bound">δ</a><a id="19325" class="Symbol">)</a>
  <a id="19329" class="Keyword">with</a> <a id="19334" href="/lia/part0/Logic/#1854" class="Field">fst</a> <a id="19338" class="Symbol">(</a><a id="19339" href="/lia/part5/Programs/#19301" class="Bound">Cc∼Cd</a> <a id="19345" class="Symbol">_</a> <a id="19347" class="Symbol">_)</a> <a id="19350" href="/lia/part5/Programs/#19324" class="Bound">δ</a>
<a id="19352" class="Symbol">...</a> <a id="19356" class="Symbol">|</a> <a id="19358" href="/lia/part5/Programs/#19358" class="Bound">δ′</a> <a id="19361" class="Symbol">=</a> <a id="19363" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="19371" class="Bound">⟦b⟧s≡tt</a> <a id="19379" href="/lia/part5/Programs/#19358" class="Bound">δ′</a>

<a id="19383" href="/lia/part5/Programs/#19031" class="Function">fa-ite-right</a> <a id="19396" href="/lia/part5/Programs/#19396" class="Bound">C</a> <a id="19398" href="/lia/part5/Programs/#19398" class="Bound">Cc∼Cd</a> <a id="19404" class="Symbol">(</a><a id="19405" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="19413" href="/lia/part5/Programs/#19413" class="Bound">⟦b⟧s≡ff</a> <a id="19421" href="/lia/part5/Programs/#19421" class="Bound">δ</a><a id="19422" class="Symbol">)</a> <a id="19424" class="Symbol">=</a> <a id="19426" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="19434" href="/lia/part5/Programs/#19413" class="Bound">⟦b⟧s≡ff</a> <a id="19442" href="/lia/part5/Programs/#19421" class="Bound">δ</a>

<a id="fa-ite-left"></a><a id="19445" href="/lia/part5/Programs/#19445" class="Function">fa-ite-left</a> <a id="19457" class="Symbol">:</a> <a id="19459" class="Symbol">∀</a> <a id="19461" href="/lia/part5/Programs/#19461" class="Bound">C</a> <a id="19463" class="Symbol">→</a>
              <a id="19479" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="19492" href="/lia/part5/Programs/#19461" class="Bound">C</a> <a id="19494" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="19496" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="19498" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="19511" href="/lia/part5/Programs/#19461" class="Bound">C</a> <a id="19513" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="19515" class="Symbol">→</a>
              <a id="19531" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="19534" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="19536" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="19541" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="19544" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="19549" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="19562" href="/lia/part5/Programs/#19461" class="Bound">C</a> <a id="19564" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="19566" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="19568" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="19570" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="19572" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a> <a id="19575" class="Symbol">→</a>
              <a id="19591" class="Comment">--------------------------------------------</a>
              <a id="19650" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">if</a> <a id="19653" href="/lia/part5/Programs/#1343" class="Generalizable">b</a> <a id="19655" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">then</a> <a id="19660" href="/lia/part5/Programs/#1360" class="Generalizable">c′</a> <a id="19663" href="/lia/part5/Programs/#467" class="InductiveConstructor Operator">else</a> <a id="19668" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="19681" href="/lia/part5/Programs/#19461" class="Bound">C</a> <a id="19683" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="19685" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="19687" href="/lia/part5/Programs/#1293" class="Generalizable">s</a> <a id="19689" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="19691" href="/lia/part5/Programs/#1295" class="Generalizable">s′</a>

<a id="19695" href="/lia/part5/Programs/#19445" class="Function">fa-ite-left</a> <a id="19707" href="/lia/part5/Programs/#19707" class="Bound">C</a> <a id="19709" href="/lia/part5/Programs/#19709" class="Bound">Cc∼Cd</a> <a id="19715" class="Symbol">(</a><a id="19716" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="19724" href="/lia/part5/Programs/#19724" class="Bound">⟦b⟧s≡tt</a> <a id="19732" href="/lia/part5/Programs/#19732" class="Bound">δ</a><a id="19733" class="Symbol">)</a> <a id="19735" class="Symbol">=</a> <a id="19737" href="/lia/part5/Programs/#2212" class="InductiveConstructor">⇒-if-tt</a> <a id="19745" href="/lia/part5/Programs/#19724" class="Bound">⟦b⟧s≡tt</a> <a id="19753" href="/lia/part5/Programs/#19732" class="Bound">δ</a>
<a id="19755" href="/lia/part5/Programs/#19445" class="Function">fa-ite-left</a> <a id="19767" href="/lia/part5/Programs/#19767" class="Bound">C</a> <a id="19769" href="/lia/part5/Programs/#19769" class="Bound">Cc∼Cd</a> <a id="19775" class="Symbol">(</a><a id="19776" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="19784" href="/lia/part5/Programs/#19784" class="Bound">⟦b⟧s≡ff</a> <a id="19792" href="/lia/part5/Programs/#19792" class="Bound">δ</a><a id="19793" class="Symbol">)</a>
  <a id="19797" class="Keyword">with</a> <a id="19802" href="/lia/part0/Logic/#1854" class="Field">fst</a> <a id="19806" class="Symbol">(</a><a id="19807" href="/lia/part5/Programs/#19769" class="Bound">Cc∼Cd</a> <a id="19813" class="Symbol">_</a> <a id="19815" class="Symbol">_)</a> <a id="19818" href="/lia/part5/Programs/#19792" class="Bound">δ</a>
<a id="19820" class="Symbol">...</a> <a id="19824" class="Symbol">|</a> <a id="19826" href="/lia/part5/Programs/#19826" class="Bound">δ′</a> <a id="19829" class="Symbol">=</a> <a id="19831" href="/lia/part5/Programs/#2330" class="InductiveConstructor">⇒-if-ff</a> <a id="19839" class="Bound">⟦b⟧s≡ff</a> <a id="19847" href="/lia/part5/Programs/#19826" class="Bound">δ′</a></pre>

<p>The natural semantics is fully abstract:</p>

<pre class="Agda"><a id="fullAbstraction-1"></a><a id="19901" href="/lia/part5/Programs/#19901" class="Function">fullAbstraction-1</a> <a id="19919" class="Symbol">:</a> <a id="19921" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="19923" href="/lia/part5/Programs/#17828" class="Function Operator">≈</a> <a id="19925" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="19927" class="Symbol">→</a> <a id="19929" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="19931" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="19933" href="/lia/part5/Programs/#1358" class="Generalizable">d</a>
<a id="19935" href="/lia/part5/Programs/#19901" class="Function">fullAbstraction-1</a> <a id="19953" href="/lia/part5/Programs/#19953" class="Bound">c≈d</a> <a id="19957" class="Symbol">=</a> <a id="19959" href="/lia/part5/Programs/#19953" class="Bound">c≈d</a> <a id="19963" href="/lia/part5/Programs/#16845" class="InductiveConstructor">□</a>

<a id="fullAbstraction-2"></a><a id="19966" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="19984" class="Symbol">:</a> <a id="19986" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="19988" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="19990" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="19992" class="Symbol">→</a> <a id="19994" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="19996" href="/lia/part5/Programs/#17828" class="Function Operator">≈</a> <a id="19998" href="/lia/part5/Programs/#1358" class="Generalizable">d</a>

<a id="20001" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20019" href="/lia/part5/Programs/#20019" class="Bound">c∼d</a> <a id="20023" href="/lia/part5/Programs/#16845" class="InductiveConstructor">□</a> <a id="20025" href="/lia/part5/Programs/#20025" class="Bound">s</a> <a id="20027" href="/lia/part5/Programs/#20027" class="Bound">s′</a> <a id="20030" class="Symbol">=</a> <a id="20032" href="/lia/part5/Programs/#20019" class="Bound">c∼d</a> <a id="20036" href="/lia/part5/Programs/#20025" class="Bound">s</a> <a id="20038" href="/lia/part5/Programs/#20027" class="Bound">s′</a>

<a id="20042" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20060" class="Symbol">{</a><a id="20061" href="/lia/part5/Programs/#20061" class="Bound">c</a><a id="20062" class="Symbol">}</a> <a id="20064" class="Symbol">{</a><a id="20065" href="/lia/part5/Programs/#20065" class="Bound">d</a><a id="20066" class="Symbol">}</a> <a id="20068" href="/lia/part5/Programs/#20068" class="Bound">c∼d</a> <a id="20072" class="Symbol">(</a><a id="20073" href="/lia/part5/Programs/#20073" class="Bound">C</a> <a id="20075" href="/lia/part5/Programs/#16859" class="InductiveConstructor Operator">⨟-left</a> <a id="20082" href="/lia/part5/Programs/#20082" class="Bound">c′</a><a id="20084" class="Symbol">)</a> <a id="20086" href="/lia/part5/Programs/#20086" class="Bound">s</a> <a id="20088" href="/lia/part5/Programs/#20088" class="Bound">s′</a>
    <a id="20095" class="Keyword">with</a> <a id="20100" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20118" href="/lia/part5/Programs/#20068" class="Bound">c∼d</a> <a id="20122" href="/lia/part5/Programs/#20073" class="Bound">C</a>
<a id="20124" class="Symbol">...</a> <a id="20128" class="Symbol">|</a> <a id="20130" href="/lia/part5/Programs/#20130" class="Bound">ind</a> <a id="20134" class="Symbol">=</a> <a id="20136" href="/lia/part5/Programs/#20159" class="Function">goal0</a> <a id="20142" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="20144" href="/lia/part5/Programs/#20260" class="Function">goal1</a> <a id="20150" class="Keyword">where</a>

  <a id="20159" href="/lia/part5/Programs/#20159" class="Function">goal0</a> <a id="20165" class="Symbol">:</a> <a id="20167" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="20180" class="Bound">C</a> <a id="20182" class="Bound">c</a> <a id="20184" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="20186" class="Bound">c′</a> <a id="20189" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="20191" class="Bound">s</a> <a id="20193" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="20195" class="Bound">s′</a> <a id="20198" class="Symbol">→</a> <a id="20200" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="20213" class="Bound">C</a> <a id="20215" class="Bound">d</a> <a id="20217" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="20219" class="Bound">c′</a> <a id="20222" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="20224" class="Bound">s</a> <a id="20226" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="20228" class="Bound">s′</a>
  <a id="20233" href="/lia/part5/Programs/#20159" class="Function">goal0</a> <a id="20239" class="Symbol">=</a> <a id="20241" href="/lia/part5/Programs/#17952" class="Function">fa-⨟-left</a> <a id="20251" class="Bound">C</a> <a id="20253" href="/lia/part5/Programs/#20130" class="Bound">ind</a>

  <a id="20260" href="/lia/part5/Programs/#20260" class="Function">goal1</a> <a id="20266" class="Symbol">:</a> <a id="20268" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="20281" class="Bound">C</a> <a id="20283" class="Bound">d</a> <a id="20285" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="20287" class="Bound">c′</a> <a id="20290" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="20292" class="Bound">s</a> <a id="20294" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="20296" class="Bound">s′</a> <a id="20299" class="Symbol">→</a> <a id="20301" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="20314" class="Bound">C</a> <a id="20316" class="Bound">c</a> <a id="20318" href="/lia/part5/Programs/#443" class="InductiveConstructor Operator">⨟</a> <a id="20320" class="Bound">c′</a> <a id="20323" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="20325" class="Bound">s</a> <a id="20327" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="20329" class="Bound">s′</a>
  <a id="20334" href="/lia/part5/Programs/#20260" class="Function">goal1</a> <a id="20340" class="Symbol">=</a> <a id="20342" href="/lia/part5/Programs/#17952" class="Function">fa-⨟-left</a> <a id="20352" class="Bound">C</a> <a id="20354" class="Symbol">(</a><a id="20355" href="/lia/part5/Programs/#17740" class="Function">sym-∼</a> <a id="20361" href="/lia/part5/Programs/#20130" class="Bound">ind</a><a id="20364" class="Symbol">)</a>

<a id="20367" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20385" href="/lia/part5/Programs/#20385" class="Bound">c∼d</a> <a id="20389" class="Symbol">(</a><a id="20390" href="/lia/part5/Programs/#20390" class="Bound">c</a> <a id="20392" href="/lia/part5/Programs/#16908" class="InductiveConstructor Operator">⨟-right</a> <a id="20400" href="/lia/part5/Programs/#20400" class="Bound">C</a><a id="20401" class="Symbol">)</a> <a id="20403" href="/lia/part5/Programs/#20403" class="Bound">s</a> <a id="20405" href="/lia/part5/Programs/#20405" class="Bound">s′</a>
  <a id="20410" class="Keyword">with</a> <a id="20415" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20433" href="/lia/part5/Programs/#20385" class="Bound">c∼d</a> <a id="20437" href="/lia/part5/Programs/#20400" class="Bound">C</a>
<a id="20439" class="Symbol">...</a> <a id="20443" class="Symbol">|</a> <a id="20445" href="/lia/part5/Programs/#20445" class="Bound">ind</a> <a id="20449" class="Symbol">=</a> <a id="20451" href="/lia/part5/Programs/#18264" class="Function">fa-⨟-right</a> <a id="20462" class="Bound">C</a> <a id="20464" href="/lia/part5/Programs/#20445" class="Bound">ind</a> <a id="20468" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="20470" href="/lia/part5/Programs/#18264" class="Function">fa-⨟-right</a> <a id="20481" class="Bound">C</a> <a id="20483" class="Symbol">(</a><a id="20484" href="/lia/part5/Programs/#17740" class="Function">sym-∼</a> <a id="20490" href="/lia/part5/Programs/#20445" class="Bound">ind</a><a id="20493" class="Symbol">)</a>

<a id="20496" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20514" class="Symbol">{</a><a id="20515" href="/lia/part5/Programs/#20515" class="Bound">c</a><a id="20516" class="Symbol">}</a> <a id="20518" class="Symbol">{</a><a id="20519" href="/lia/part5/Programs/#20519" class="Bound">d</a><a id="20520" class="Symbol">}</a> <a id="20522" href="/lia/part5/Programs/#20522" class="Bound">c∼d</a> <a id="20526" class="Symbol">(</a><a id="20527" href="/lia/part5/Programs/#16958" class="InductiveConstructor Operator">if-left</a> <a id="20535" href="/lia/part5/Programs/#20535" class="Bound">b</a> <a id="20537" href="/lia/part5/Programs/#16958" class="InductiveConstructor Operator">then</a> <a id="20542" href="/lia/part5/Programs/#20542" class="Bound">C</a> <a id="20544" href="/lia/part5/Programs/#16958" class="InductiveConstructor Operator">else</a> <a id="20549" href="/lia/part5/Programs/#20549" class="Bound">c′</a><a id="20551" class="Symbol">)</a> <a id="20553" href="/lia/part5/Programs/#20553" class="Bound">s</a> <a id="20555" href="/lia/part5/Programs/#20555" class="Bound">s′</a>
    <a id="20562" class="Keyword">with</a> <a id="20567" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20585" href="/lia/part5/Programs/#20522" class="Bound">c∼d</a> <a id="20589" href="/lia/part5/Programs/#20542" class="Bound">C</a>
<a id="20591" class="Symbol">...</a> <a id="20595" class="Symbol">|</a> <a id="20597" href="/lia/part5/Programs/#20597" class="Bound">ind</a> <a id="20601" class="Symbol">=</a> <a id="20603" href="/lia/part5/Programs/#19031" class="Function">fa-ite-right</a> <a id="20616" class="Bound">C</a> <a id="20618" href="/lia/part5/Programs/#20597" class="Bound">ind</a> <a id="20622" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="20624" href="/lia/part5/Programs/#19031" class="Function">fa-ite-right</a> <a id="20637" class="Bound">C</a> <a id="20639" class="Symbol">(</a><a id="20640" href="/lia/part5/Programs/#17740" class="Function">sym-∼</a> <a id="20646" href="/lia/part5/Programs/#20597" class="Bound">ind</a><a id="20649" class="Symbol">)</a>

<a id="20652" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20670" class="Symbol">{</a><a id="20671" href="/lia/part5/Programs/#20671" class="Bound">c</a><a id="20672" class="Symbol">}</a> <a id="20674" class="Symbol">{</a><a id="20675" href="/lia/part5/Programs/#20675" class="Bound">d</a><a id="20676" class="Symbol">}</a> <a id="20678" href="/lia/part5/Programs/#20678" class="Bound">c∼d</a> <a id="20682" class="Symbol">(</a><a id="20683" href="/lia/part5/Programs/#17030" class="InductiveConstructor Operator">if-right</a> <a id="20692" href="/lia/part5/Programs/#20692" class="Bound">b</a> <a id="20694" href="/lia/part5/Programs/#17030" class="InductiveConstructor Operator">then</a> <a id="20699" href="/lia/part5/Programs/#20699" class="Bound">c′</a> <a id="20702" href="/lia/part5/Programs/#17030" class="InductiveConstructor Operator">else</a> <a id="20707" href="/lia/part5/Programs/#20707" class="Bound">C</a><a id="20708" class="Symbol">)</a> <a id="20710" href="/lia/part5/Programs/#20710" class="Bound">s</a> <a id="20712" href="/lia/part5/Programs/#20712" class="Bound">s′</a>
    <a id="20719" class="Keyword">with</a> <a id="20724" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20742" href="/lia/part5/Programs/#20678" class="Bound">c∼d</a> <a id="20746" href="/lia/part5/Programs/#20707" class="Bound">C</a>
<a id="20748" class="Symbol">...</a> <a id="20752" class="Symbol">|</a> <a id="20754" href="/lia/part5/Programs/#20754" class="Bound">ind</a> <a id="20758" class="Symbol">=</a> <a id="20760" href="/lia/part5/Programs/#19445" class="Function">fa-ite-left</a> <a id="20772" class="Bound">C</a> <a id="20774" href="/lia/part5/Programs/#20754" class="Bound">ind</a> <a id="20778" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="20780" href="/lia/part5/Programs/#19445" class="Function">fa-ite-left</a> <a id="20792" class="Bound">C</a> <a id="20794" class="Symbol">(</a><a id="20795" href="/lia/part5/Programs/#17740" class="Function">sym-∼</a> <a id="20801" href="/lia/part5/Programs/#20754" class="Bound">ind</a><a id="20804" class="Symbol">)</a>

<a id="20807" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20825" class="Symbol">{</a><a id="20826" href="/lia/part5/Programs/#20826" class="Bound">c</a><a id="20827" class="Symbol">}</a> <a id="20829" class="Symbol">{</a><a id="20830" href="/lia/part5/Programs/#20830" class="Bound">d</a><a id="20831" class="Symbol">}</a> <a id="20833" href="/lia/part5/Programs/#20833" class="Bound">c∼d</a> <a id="20837" class="Symbol">(</a><a id="20838" href="/lia/part5/Programs/#17103" class="InductiveConstructor Operator">while</a> <a id="20844" href="/lia/part5/Programs/#20844" class="Bound">b</a> <a id="20846" href="/lia/part5/Programs/#17103" class="InductiveConstructor Operator">do:</a> <a id="20850" href="/lia/part5/Programs/#20850" class="Bound">C</a><a id="20851" class="Symbol">)</a> <a id="20853" href="/lia/part5/Programs/#20853" class="Bound">s</a> <a id="20855" href="/lia/part5/Programs/#20855" class="Bound">s′</a>
  <a id="20860" class="Keyword">with</a> <a id="20865" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a> <a id="20883" href="/lia/part5/Programs/#20833" class="Bound">c∼d</a> <a id="20887" href="/lia/part5/Programs/#20850" class="Bound">C</a>
<a id="20889" class="Symbol">...</a> <a id="20893" class="Symbol">|</a> <a id="20895" href="/lia/part5/Programs/#20895" class="Bound">ind</a> <a id="20899" class="Symbol">=</a> <a id="20901" href="/lia/part5/Programs/#20924" class="Function">goal0</a> <a id="20907" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="20909" href="/lia/part5/Programs/#21052" class="Function">goal1</a> <a id="20915" class="Keyword">where</a>

  <a id="20924" href="/lia/part5/Programs/#20924" class="Function">goal0</a> <a id="20930" class="Symbol">:</a> <a id="20932" class="Symbol">(</a><a id="20933" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="20939" class="Bound">b</a> <a id="20941" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="20945" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="20958" class="Bound">C</a> <a id="20960" class="Bound">c</a><a id="20961" class="Symbol">)</a> <a id="20963" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="20965" class="Bound">s</a> <a id="20967" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="20969" class="Bound">s′</a> <a id="20972" class="Symbol">→</a>
          <a id="20984" class="Symbol">(</a><a id="20985" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="20991" class="Bound">b</a> <a id="20993" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="20997" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="21010" class="Bound">C</a> <a id="21012" class="Bound">d</a><a id="21013" class="Symbol">)</a> <a id="21015" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="21017" class="Bound">s</a> <a id="21019" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="21021" class="Bound">s′</a>
  <a id="21026" href="/lia/part5/Programs/#20924" class="Function">goal0</a> <a id="21032" class="Symbol">=</a> <a id="21034" href="/lia/part5/Programs/#18585" class="Function">fa-while</a> <a id="21043" class="Bound">C</a> <a id="21045" href="/lia/part5/Programs/#20895" class="Bound">ind</a>

  <a id="21052" href="/lia/part5/Programs/#21052" class="Function">goal1</a> <a id="21058" class="Symbol">:</a> <a id="21060" class="Symbol">(</a><a id="21061" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="21067" class="Bound">b</a> <a id="21069" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="21073" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="21086" class="Bound">C</a> <a id="21088" class="Bound">d</a><a id="21089" class="Symbol">)</a> <a id="21091" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="21093" class="Bound">s</a> <a id="21095" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="21097" class="Bound">s′</a> <a id="21100" class="Symbol">→</a>
          <a id="21112" class="Symbol">(</a><a id="21113" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">while</a> <a id="21119" class="Bound">b</a> <a id="21121" href="/lia/part5/Programs/#508" class="InductiveConstructor Operator">do:</a> <a id="21125" href="/lia/part5/Programs/#17255" class="Function">contextApply</a> <a id="21138" class="Bound">C</a> <a id="21140" class="Bound">c</a><a id="21141" class="Symbol">)</a> <a id="21143" href="/lia/part5/Programs/#1493" class="Datatype Operator">,</a> <a id="21145" class="Bound">s</a> <a id="21147" href="/lia/part5/Programs/#1493" class="Datatype Operator">⇒</a> <a id="21149" class="Bound">s′</a>
  <a id="21154" href="/lia/part5/Programs/#21052" class="Function">goal1</a> <a id="21160" class="Symbol">=</a> <a id="21162" href="/lia/part5/Programs/#18585" class="Function">fa-while</a> <a id="21171" class="Bound">C</a> <a id="21173" class="Symbol">(</a><a id="21174" href="/lia/part5/Programs/#17740" class="Function">sym-∼</a> <a id="21180" href="/lia/part5/Programs/#20895" class="Bound">ind</a><a id="21183" class="Symbol">)</a>
  
<a id="fullAbstraction"></a><a id="21188" href="/lia/part5/Programs/#21188" class="Function">fullAbstraction</a> <a id="21204" class="Symbol">:</a> <a id="21206" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="21208" href="/lia/part5/Programs/#17828" class="Function Operator">≈</a> <a id="21210" href="/lia/part5/Programs/#1358" class="Generalizable">d</a> <a id="21212" href="/lia/part0/Logic/#3145" class="Function Operator">↔</a> <a id="21214" href="/lia/part5/Programs/#1356" class="Generalizable">c</a> <a id="21216" href="/lia/part5/Programs/#17668" class="Function Operator">∼</a> <a id="21218" href="/lia/part5/Programs/#1358" class="Generalizable">d</a>
<a id="21220" href="/lia/part5/Programs/#21188" class="Function">fullAbstraction</a> <a id="21236" class="Symbol">=</a> <a id="21238" href="/lia/part5/Programs/#19901" class="Function">fullAbstraction-1</a> <a id="21256" href="/lia/part0/Logic/#1838" class="InductiveConstructor Operator">,</a> <a id="21258" href="/lia/part5/Programs/#19966" class="Function">fullAbstraction-2</a></pre>

<h1 id="axiomatic-semantics">
<a class="anchor" href="#axiomatic-semantics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Axiomatic semantics</h1>

<p>TODO. ::: {#refs} # References :::</p>

    </div>
  
    <header class="nav-header">
    <p style="text-align:center;">
        
        
        
        <a alt="Part" href="/lia/part5/index/">Part</a>
        &bullet;
        
        
        <a alt="Source code" href="https://github.com/lclem/lia/blob/main/src/part5/Programs.lagda.md">Source</a>
        
        
        
    </p>
</header>

    <p class="p-name"> Last-modified: Jan  7 14:42:55 2021 </p>
  </article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/lia/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Logic in Agda</h2><div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Lorenzo Clemente</li>
          <li><a class="u-email" href="mailto:clementelorenzo@gmail.com">clementelorenzo@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/lclem"><svg class="svg-icon"><use xlink:href="/lia/assets/minima-social-icons.svg#github"></use></svg> <span class="username">lclem</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3"></div>
    </div>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
  </div>
</footer>

<!-- Parse the Latex divs with Katex
<script type="text/javascript">
  $("script[type='math/tex']").replaceWith(
    function(){
      var tex = $(this).text();
      return katex.renderToString(tex, {displayMode: false});
  });
  
  $("script[type='math/tex; mode=display']").replaceWith(
    function(){
      var tex = $(this).text();
      return katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: true});
  });
</script>
-->

<script type="text/javascript" src="/lia/assets/hidebox.js"></script>
</body>

</html>
